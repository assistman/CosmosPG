(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{2177:function(t,e,i){"use strict";i.r(e);var n=i(0),o=i.n(n),s=i(8),r=i.n(s),a=i(2916),l=i.n(a),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var c=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.componentRef=o.a.createRef(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),h(e,[{key:"componentDidMount",value:function(){this.$chart=new l.a({parent:this.componentRef.current}),this.$chart.setSymbol(this.props.symbol)}},{key:"componentWillUnmount",value:function(){this.$chart&&this.$chart.destroy()}},{key:"componentWillUpdate",value:function(t){this.$chart&&this.$chart.setSymbol(t.symbol)}},{key:"render",value:function(){var t,e,i,n=this.props,s=n.height,a=n.className,l=r()((i=!!a,(e=a)in(t={"chart-box":!0})?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t)),h={};return s&&(h={height:s+"px",minHeight:s+"px",maxHeight:s+"px"}),o.a.createElement("div",{className:l,style:h,ref:this.componentRef})}}]),e}(o.a.Component);c.defaultProps={height:0,symbol:null},e.default=c},2208:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(1),r=i(688),a=i(252),l=i(1200),h=i(2285),c=["M",0,0],u=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._parent=i,this._xAxis=e.get(l.options.names.axis.mainX),this._yAxis=e.get(l.options.names.axis.mainY),this._chartDrawing=e.chartDrawing,this._renderer=e.renderer,this._pointer=e.pointer,this._options=o.extend({},a(this.fxclientOptions),n)}return s(t,[{key:"defaults",get:function(){return{}}}],[{key:"EMPTY_PATH",get:function(){return c}}]),s(t,[{key:"_init",value:function(){throw Error("unimplemented abstract method")}},{key:"_update",value:function(t,e){throw Error("unimplemented abstract method")}},{key:"_move",value:function(t,e,i,n){throw Error("unimplemented abstract method")}},{key:"_render",value:function(){throw Error("unimplemented abstract method")}},{key:"_destroy",value:function(){throw Error("unimplemented abstract method")}},{key:"_setColor",value:function(t){throw Error("unimplemented abstract method")}},{key:"redraw",value:function(){this.initialized||this.init(),this.update()}},{key:"init",value:function(t){this._init(),t||this.addEvents(),this.initialized=!0}},{key:"update",value:function(t,e,i){var n=new h(e,i);this._update(t,n),this.updatePoints(t,n),this.render(this.options.keyPoints.length)}},{key:"render",value:function(t){this._render(t)}},{key:"setColor",value:function(t){try{this._setColor(t),this.options.properties.line.lineColor=t,this.save()}catch(t){}}},{key:"getColor",value:function(){return this.options.properties.line.lineColor}},{key:"isFinished",value:function(){return!o.isFunction(this._isFinished)||this._isFinished.apply(this,arguments)}},{key:"finalize",value:function(t){this.chartDrawing.finalizeDrawing(t)}},{key:"save",value:function(){this.chartDrawing.saveDrawing()}},{key:"remove",value:function(){this.chartDrawing.removeActiveDrawing()}},{key:"destroy",value:function(){for(var t in o.each(this.$points,(function(t){return t.destroy()})),this.mouseHandlers)this.mouseHandlers[t]();this._destroy()}},{key:"createG",value:function(){return this.renderer.g("drawing "+this.options.type.replace(/_/g,"-")).attr({zIndex:7}).add(this.parent)}},{key:"createLine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container;return this.renderer.path(t).attr({"stroke-width":this.options.properties.line.lineWidth,stroke:this.getColor(),"pointer-events":"none"}).add(e)}},{key:"createLineHover",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container;return this.renderer.path(t).attr({class:"hover","stroke-width":1,stroke:"transparent","stroke-linecap":"round"}).add(e)}},{key:"createFilledArea",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container;return this.renderer.path(t).attr({class:"filled",fill:this.getColor(),"fill-opacity":"0.4"}).add(e)}},{key:"createLabel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:null,x:0,y:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container,i=t.text,n=t.x,o=t.y,s=t.shape,r=t.anchorX,a=t.anchorY,l=t.useHTML,h=t.baseline,c=t.className;return this.renderer.label(i,n,o,s,r,a,l,h,c).css({color:"#000000",fontSize:"10px"}).attr({fill:"rgba(255, 255, 255, 0.5)",padding:2,r:3}).add(e)}},{key:"createText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:null,x:0,y:0,fontSize:"11px"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container,i=t.text,n=t.x,o=t.y,s=t.fontSize;return this.renderer.label(i,n,o).css({color:"#000000",fontSize:s}).attr({stroke:this.getColor(),"stroke-width":1,fill:this.getFillColor(),"fill-opacity":"0.8",padding:7,r:0}).add(e)}},{key:"createPoints",value:function(){return o.map(this.options.keyPoints,this.keyPointToSvgPoint,this)}},{key:"keyPointToSvgPoint",value:function(t,e){return new h(t).initSVG(e,this)}},{key:"updatePoints",value:function(t,e){var i=this;o.isUndefined(t)||o.isUndefined(e)?o.each(this.$points,(function(t){return t.updateSVG(!i.editing&&!t.editing)})):(this.$points[t]?(this.$points[t].fromPoint(e),this.$points[t].updateSVG()):this.$points[t]=e.initSVG(t,this),this.options.keyPoints[t]=this.$points[t].convert(!0).getValues())}},{key:"addEvents",value:function(){var t=this;this.mouseHandlers={},this.mouseHandlers.mousedown=r.addEvent(this.$hoverElement.element,"mousedown",(function(e){if(e=t.normalize(e),t.chartDrawing.isInsideAxis(e)){e.stopImmediatePropagation(),t.startEditing();var i=!1,n=t.normalize(e);t.mouseHandlers.mousemove=r.addEvent(t.ownerSVG,"mousemove",(function(e){e=t.normalize(e),t.chartDrawing.isInsideAxis(e)&&(i=!0,n=t.onMove(!1,e,n))})),t.mouseHandlers.mouseup=r.addEvent(t.ownerSVG,"mouseup",(function(e){e=t.normalize(e),t.chartDrawing.isInsideAxis(e)&&(n=t.onMove(!0,e,n),t.mouseHandlers.mousemove(),t.mouseHandlers.mouseup(),t.stopEditing(i))}))}})),o.each(this.$points,(function(e){return e.addEvents(t)}))}},{key:"onMove",value:function(t,e,i){return e=this.normalize(e),this.move(t,e.chartX-i.chartX,e.chartY-i.chartY),e}},{key:"move",value:function(t,e,i,n){var s=this;n?(n.setPixels(n.x+e,n.y+i),this._move(t,e,i,n)):(o.each(this.$points,(function(t){return t.setPixels(t.x+e,t.y+i)})),this._move(t,e,i,n)),t&&o.each(this.$points,(function(t,e){return s.options.keyPoints[e]=t.convert(!0).getValues()})),this.updatePoints(),this.render(this.options.keyPoints.length)}},{key:"deactivate",value:function(e){t.removeSVGClass(this.$container,"active"),e||this.chartDrawing.setActiveDrawing(null)}},{key:"activate",value:function(e){t.addSVGClass(this.$container,"active"),e||this.chartDrawing.setActiveDrawing(this)}},{key:"startEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;e.editing=!0,this.chartDrawing.enableEditing(),t.addSVGClass(this.$container,"in-moving"),this.activate()}},{key:"stopEditing",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;i.editing=!1,(i===this?i.notSaved:i.drawing.notSaved)||this.chartDrawing.disableEditing(),t.removeSVGClass(this.$container,"in-moving"),e&&this.chartDrawing.saveDrawing(!0)}},{key:"normalize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;return t.chartX&&t.chartY?t:this.pointer.normalize(t)}},{key:"parent",get:function(){return this._parent}},{key:"options",get:function(){return this._options}},{key:"xAxis",get:function(){return this._xAxis}},{key:"yAxis",get:function(){return this._yAxis}},{key:"pointer",get:function(){return this._pointer}},{key:"renderer",get:function(){return this._renderer}},{key:"chartDrawing",get:function(){return this._chartDrawing}},{key:"ownerSVG",get:function(){return this.$container.element.ownerSVGElement}},{key:"fxclientOptions",get:function(){throw Error("unimplemented abstract method")}},{key:"initialized",get:function(){return this._initialized},set:function(t){this._initialized=t}}],[{key:"addSVGClass",value:function(t,e){var i=t.element.getAttribute("class").split(" ");i.indexOf(e)<=-1&&i.push(e),t.element.setAttribute("class",i.join(" "))}},{key:"removeSVGClass",value:function(t,e){var i=t.element.getAttribute("class").split(" "),n=i.indexOf(e);n>-1&&i.splice(n,1),t.element.setAttribute("class",i.join(" "))}},{key:"lightenDarkenColor",value:function(t,e){var i=!1;"#"===t[0]&&(t=t.slice(1),i=!0);var n=parseInt(t,16),o=(n>>16)+e;o>255?o=255:o<0&&(o=0);var s=(n>>8&255)+e;s>255?s=255:s<0&&(s=0);var r=(255&n)+e;return r>255?r=255:r<0&&(r=0),(i?"#":"")+("000000"+(r|s<<8|o<<16).toString(16)).slice(-6)}}]),t}();n.exports=u}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2212:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(28).Events,r=i(83),a=i(1),l=i(688),h=i(10),c=i(1200),u=i(2449),d=i(2450),p=i(2451),f=i(2452),g=["M",0,0],v=["$rateLine","$hoverElement","$rateLabel","$infoLabel","$plLabel","$editButton","$closeButton","$tpslButton","$container"],y=i(2287),m={RATE_LABEL:{attr:{"stroke-width":0,padding:c.options.chart.label.padding,r:c.options.chart.label.radius},css:{color:"#FFFFFF",fontSize:"11px",fontWeight:"500",fontFamily:'Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;'}},INFO_LABEL:{attr:{fill:"#FFFFFF","stroke-width":1,paddingLeft:3,padding:3,r:2},css:{fontSize:"11px",fontWeight:"bold",fontFamily:'Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;'}},PL_LABEL:{attr:{fill:"#FFFFFF","stroke-width":1,padding:3,r:2},css:{color:"#FFFFFF",fontSize:"11px",fontWeight:"bold",fontFamily:'Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;'}},BUTTON:{NORMAL_STATE:{style:{color:"#1960d7"},paddingLeft:1,padding:3,r:2,"stroke-width":1,stroke:"#7c7c7c",fill:"#ffffff"},HOVER_STATE:{fill:"#f0f1f2"}},CLOSE_BUTTON:{},TPSL_BUTTON:{}},b=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._chart=e,this._options=a.extend({},this.defaults,i),this.options.handleEvents&&a.extend(this,o),this.$container=this.createContainer(),this.options.draggable&&this.makeDraggable(),this.$rateLine=this.createRateLine(),this.options.showRateLabel&&(this.$rateLabel=this.createLabel(null,a.extend({},m.RATE_LABEL.attr,{fill:this.options.color}),m.RATE_LABEL.css)),this.elementsRow=[],this.options.showInfoLabel&&(this.options.infoLabelValue||this.options.infoLabelKey||this.options.infoLabelShowRate)&&(this.$infoLabel=this.createLabel(this.formatInfo(),a.extend({},m.INFO_LABEL.attr,{fill:this.chart.options.chart.backgroundColor,stroke:this.options.color}),a.extend({},m.INFO_LABEL.css,{color:this.options.color})),"right"===this.options.infoLabelAlign?this.$infoLabel.attr({align:this.options.infoLabelAlign}):this.elementsRow.push({offsetX:14,element:this.$infoLabel})),this.options.showProfitLossLabel&&(this.$plLabel=this.createLabel(null,a.extend({},m.PL_LABEL.attr,{stroke:this.options.color,fill:this.options.color}),a.extend({},m.PL_LABEL.css)),this.elementsRow.push({offsetX:"right"===this.options.infoLabelAlign?14:-2,element:this.$plLabel}),this.$plLabel.hide()),this.options.showEditButton&&this.onEditButtonCLick&&(this.$editButton=this.createButton(u,this.onEditButtonCLick.bind(this),a.extend({},m.BUTTON.NORMAL_STATE,{title:__("actions.edit"),fill:this.chart.options.chart.backgroundColor}),m.BUTTON.HOVER_STATE,{fill:this.options.color}),this.elementsRow.push({offsetX:10,element:this.$editButton})),this.options.showCloseButton&&this.onCloseButtonClick&&(this.$closeButton=this.createButton(d,this.onCloseButtonClick.bind(this),a.extend({},m.BUTTON.NORMAL_STATE,{title:__("actions.cancel"),fill:this.chart.options.chart.backgroundColor}),m.BUTTON.HOVER_STATE,{fill:this.options.color}),this.elementsRow.push({offsetX:4,element:this.$closeButton})),this.options.showTpslButton&&this.onTpslButtonClick&&(this.$tpslButton=this.createButton(p,this.onTpslButtonClick.bind(this),a.extend({},m.BUTTON.NORMAL_STATE,{fill:this.chart.options.chart.backgroundColor}),m.BUTTON.HOVER_STATE,{fill:this.options.color,icon:f}),this.elementsRow.push({offsetX:4,element:this.$tpslButton})),this.chartRedrawEventHandler=l.addEvent(e,"redraw",this.onChartRedraw.bind(this)),this.chartDestroyEventHandler=l.addEvent(e,"destroy",this.onChartDestroy.bind(this))}return s(t,[{key:"defaults",get:function(){throw Error(this.constructor.name+" : unimplemented abstract method")}},{key:"chart",get:function(){return this._chart}},{key:"options",get:function(){return this._options}}],[{key:"DASH_STYLES",get:function(){return y}}]),s(t,[{key:"formatInfo",value:function(){var t="";return this.options.infoLabelValue?t=this.options.infoLabelValue:this.options.infoLabelKey&&(t=__(this.options.infoLabelKey)),this.options.infoLabelShowRate&&this.rate&&(t.length>0&&(t+=" : "),t+=this.formatRate()),t}},{key:"formatRate",value:function(){return this.rate.toFixed(this.options.precision||this.options.instrument&&this.options.instrument.getPrecision()||5)}},{key:"formatPL",value:function(t){return r(t).formatForeignCurrency(h.getUserCurrencySymbol(),"$0.00")}},{key:"updateRate",value:function(t){if(t!==this.rate){var e=t-this.rate;this.rate=t,this.onRateUpdated(e)}}},{key:"onRateUpdated",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart;return this.onChartRedraw(e),t}},{key:"onChartRedraw",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart;var t=this.chart.get(c.options.names.axis.mainY).getExtremes();if(this.rate<=t.max&&this.rate>=t.min){this.$container.show();var e=this.$rateLine.updateValue(this.rate);this.$hoverElement&&this.$hoverElement.update(this.$rateLine.d),this.$rateLabel&&(this.$rateLabel.attr({text:this.formatRate()}),this.$rateLabel.attr({y:e.y-this.$rateLabel.height/2,x:e.x+e.width})),this.$infoLabel&&(this.$infoLabel.attr({text:this.formatInfo()}),"right"===this.options.infoLabelAlign&&this.$infoLabel.attr({x:e.width-(10+c.options.chart.label.offsetX),y:e.y-this.$infoLabel.height/2}));var i=0;a.each(this.elementsRow,(function(t){t.element.attr({x:i+t.offsetX,y:e.y-t.element.height/2}),i+=t.element.width+t.offsetX})),this.updateDragAndDropRange()}else this.$container.hide()}},{key:"toPixels",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart;return e.get(c.options.names.axis.mainY).toPixels(parseFloat(t))}},{key:"toValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart;return e.get(c.options.names.axis.mainY).toValue(t)}},{key:"getPlotLinePath",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart;return e.get(c.options.names.axis.mainY).getPlotLinePath(t,1)}},{key:"updatePl",value:function(t){if(this.$plLabel){t||(t=0);var e=this.formatPL(t);this.pl!==e&&(this.$plLabel.attr({text:e}),this.pl||this.$plLabel.attr({visibility:"inherit"}),this.pl=e,this.onChartRedraw())}}},{key:"applySettings",value:function(t){this.$infoLabel&&this.$infoLabel.attr({fill:t.colors.common.background}),this.$editButton&&this.$editButton.updateNormalState({fill:t.colors.common.background}),this.$closeButton&&this.$closeButton.updateNormalState({fill:t.colors.common.background}),this.$tpslButton&&this.$tpslButton.updateNormalState({fill:t.colors.common.background})}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.renderer;return t.g("rate-line "+(this.options.className||"")).attr({zIndex:7}).add()}},{key:"createRateLine",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$container,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart,n=e.renderer.path(g).attr({"stroke-width":1,stroke:this.options.color,dashstyle:this.options.dashstyle,"pointer-events":"none"}).add(e);return n.updateY=function(e){return n.attr({d:["M",0,e,"L",i.plotLeft+i.plotWidth+(t.options.showRateLabel?c.options.chart.label.offsetX:0),e]})},n.updateValue=function(e){var o=t.getPlotLinePath(e,i);return o?(t.options.showRateLabel&&(o[4]+=c.options.chart.label.offsetX),n.attr({d:o}),{x:o[1],y:o[2],width:o[4]-o[1],height:o[5]-o[2]}):null},n}},{key:"createLabel",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.$container;return n.renderer.label(t,-1e3,-1e3,null,null,null,!1,!1).attr(e).css(i).add(n)}},{key:"createButton",value:function(t,e,i,n,o,s){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.$container;return r.renderer.buttonIcon(null,-1e3,-1e3,t,15,15,e,i,n,o,s).add(r)}},{key:"destroy",value:function(t){var e=this;this.destroyed||(a.each(v,(function(t){e[t]&&(e[t].destroy(),e[t]=null)})),this.elementsRow=null,this.chartRedrawEventHandler(),t||this.chartDestroyEventHandler(),this.chartRedrawEventHandler=this.chartDestroyEventHandler=null,this.stopListening&&this.stopListening(),this.destroyed=!0)}},{key:"makeDraggable",value:function(){var t=this;this.$hoverElement=this.createLineHover(),this.mouseHandlers={},this.mouseHandlers.mousedown=l.addEvent(this.$hoverElement.element,"mousedown",(function(e){if(t._beforeDragRate=t.rate,e=t.normalize(e),t.yAxis=t.chart.get(c.options.names.axis.mainY),t.isInsideAxis(e)){e.stopImmediatePropagation(),t.startEditing();var i=!1,n=t.normalize(e);t.mouseHandlers.mousemove=l.addEvent(t.$container.element.ownerSVGElement,"mousemove",(function(e){e=t.normalize(e),t.isInsideAxis(e)&&(i=!0,n=t.onMove(!1,e,n))})),t.mouseHandlers.mouseup=l.addEvent(t.$container.element.ownerSVGElement,"mouseup",(function(e){e=t.normalize(e),t.isInsideAxis(e)&&(i&&(n=t.onMove(!0,e,n)),t.mouseHandlers.mousemove(),t.mouseHandlers.mouseup(),t.stopEditing(i),t.yAxis=null)}))}}))}},{key:"normalize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;return t.chartX&&t.chartY?t:this.chart.pointer.normalize(t)}},{key:"createLineHover",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container,i=e.renderer.path(t).attr({class:"hover","stroke-width":1,stroke:"transparent","stroke-linecap":"butt"}).add(e);return i.update=function(t){return i.attr({d:t})},i}},{key:"isInsideAxis",value:function(t){return t.chartX>=this.yAxis.left&&t.chartY>=this.yAxis.top&&t.chartX<=this.yAxis.left+this.yAxis.width&&t.chartY<=this.yAxis.top+this.yAxis.height}},{key:"startEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;t.editing=!0,this.initDragAndDropRange()}},{key:"stopEditing",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;e.editing=!1,this.removeDragAndDropRange()}},{key:"enableDragging",value:function(){this.$hoverElement&&this.$hoverElement.show()}},{key:"disableDragging",value:function(){this.$hoverElement&&this.$hoverElement.hide()}},{key:"initDragAndDropRange",value:function(){this.dragAndDropRange=t.calcDragAndDropRangeCoords(this.getDragAndDropRange(),this.yAxis),this.$dragAndDropRangeRect=this.chart.renderer.rect(this.dragAndDropRange.x,this.dragAndDropRange.y,this.dragAndDropRange.width,this.dragAndDropRange.height).attr({fill:this.options.color,"fill-opacity":.1}).add()}},{key:"updateDragAndDropRange",value:function(){this.$dragAndDropRangeRect&&(this.dragAndDropRange=t.calcDragAndDropRangeCoords(this.getDragAndDropRange(),this.yAxis),this.$dragAndDropRangeRect.attr({x:this.dragAndDropRange.x,y:this.dragAndDropRange.y,width:this.dragAndDropRange.width,height:this.dragAndDropRange.height}))}},{key:"removeDragAndDropRange",value:function(){this.dragAndDropRange=null,this.$dragAndDropRangeRect&&(this.$dragAndDropRangeRect.destroy(),this.$dragAndDropRangeRect=null)}},{key:"onMove",value:function(t,e,i){return e=this.normalize(e),this.move(t,e.chartX-i.chartX,e.chartY-i.chartY)?e:i}},{key:"move",value:function(t,e,i){var n=this;if(t)return this.onDrop(this.rate-this._beforeDragRate).catch((function(){n.updateRate(n._beforeDragRate)})),!0;var o=!0,s=this.toValue(this.toPixels(this.rate)+i);return this.dragAndDropRange.min&&s<this.dragAndDropRange.min?(s=this.dragAndDropRange.min,o=!1):this.dragAndDropRange.max&&s>this.dragAndDropRange.max&&(s=this.dragAndDropRange.max,o=!1),this.updateRate(s),o}},{key:"exportTo",value:function(t){var e=this,i={};i.$container=this.createContainer(t.renderer),i.$rateLine=this.createRateLine(i.$container,t);var n=[];this.$rateLabel&&(i.$rateLabel=this.createLabel(this.$rateLabel.text.textStr,a.extend({},m.RATE_LABEL.attr,{fill:this.options.color}),m.RATE_LABEL.css,i.$container)),this.$infoLabel&&(i.$infoLabel=this.createLabel(this.$infoLabel.text.textStr,a.extend({},m.INFO_LABEL.attr,{fill:this.chart.options.chart.backgroundColor,stroke:this.options.color}),a.extend({},m.INFO_LABEL.css,{color:this.options.color}),i.$container),"right"===this.options.infoLabelAlign?i.$infoLabel.attr({align:this.options.infoLabelAlign}):n.push({offsetX:14,element:i.$infoLabel})),this.$plLabel&&(i.$plLabel=this.createLabel(this.$plLabel.text.textStr,a.extend({},m.PL_LABEL.attr,{stroke:this.options.color,fill:this.options.color}),a.extend({},m.PL_LABEL.css),i.$container),n.push({offsetX:-2,element:i.$plLabel})),this.$tpslButton&&2===this.$tpslButton.state&&(i.$tpslButton=this.createButton(p,null,a.extend({},m.BUTTON.NORMAL_STATE),m.BUTTON.HOVER_STATE,{fill:this.options.color,icon:f},null,i.$container),i.$tpslButton.press(),n.push({offsetX:10,element:i.$tpslButton}));var o=l.addEvent(t,"redraw",(function(){var t=i.$rateLine.updateValue(e.rate);if(t){i.$container.show(),i.$rateLabel&&i.$rateLabel.attr({y:t.y-i.$rateLabel.height/2,x:t.x+t.width}),i.$infoLabel&&"right"===e.options.infoLabelAlign&&i.$infoLabel.attr({x:t.width-(10+c.options.chart.label.offsetX),y:t.y-i.$infoLabel.height/2});var o=0;a.each(n,(function(e){e.element.attr({x:o+e.offsetX,y:t.y-e.element.height/2}),o+=e.element.width+e.offsetX}))}else i.$container.hide()}));l.addEvent(t,"destroy",(function(){a.each(v,(function(t){i[t]&&(i[t].destroy(),i[t]=null)})),o()}))}},{key:"onChartDestroy",value:function(){this.destroy(!0)}}],[{key:"calcDragAndDropRangeCoords",value:function(t,e){return t.x=e.left,t.width=e.width,t.y=e.top+(t.max?Math.max(e.toPixels(t.max,!0),0):0),t.height=e.top-t.y+(t.min?Math.min(e.toPixels(t.min,!0),e.height):e.height),t}}]),t}();n.exports=b}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2284:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(n=function(t,e,n){i(1);var s=i(2438),r=i(2439),a=i(2440),l=i(2441),h=i(2442),c=i(2443),u=i(2445),d={vertical_line:{class:a,label:"chart_drawings.vertical"},horizontal_line:{class:r,label:"chart_drawings.horizontal"},line:{class:s,label:"chart_drawings.trending"},trend_channel:{class:l,label:"chart_drawings.channel"},fibonacci_retracements:{class:h,label:"chart_drawings.fibonacci_retracement"},text:{class:c,label:"chart_drawings.text"},measurer:{class:u,label:"chart_drawings.measurer"}},p=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._parent=i,this._chart=e}return o(t,[{key:"createDrawing",value:function(e){var i=t.types[e.type];if(i)return new i.class(this.chart,this.parent,e)}},{key:"parent",get:function(){return this._parent}},{key:"chart",get:function(){return this._chart}}],[{key:"types",get:function(){return d}},{key:"defaultType",get:function(){return"line"}}]),t}();n.exports=p}.call(e,i,e,t))||(t.exports=n)},2285:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,o){var r=i(688),a=function(){function t(){switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),arguments.length){case 1:this.fromKeyPoint(arguments[0]);break;case 2:this.setPixels(arguments[0],arguments[1])}}return s(t,null,[{key:"defaults",get:function(){return{pointSize:8,pointType:"rect",draggable:!0}}}]),s(t,[{key:"fromKeyPoint",value:function(t){this.setValues(t.timestamp,t.value)}},{key:"fromPoint",value:function(t){this.setPixels(t.x,t.y)}},{key:"setValues",value:function(t,e){this.timestamp=t,this.value=e}},{key:"setPixels",value:function(t,e){this.x=t,this.y=e}},{key:"getValues",value:function(){return{timestamp:this._timestamp,value:this._value}}},{key:"getPixels",value:function(){return{x:this.x,y:this.y}}},{key:"convert",value:function(t){return t?(this.timestamp=this.drawing.xAxis.toValue(this.x),this.value=this.drawing.yAxis.toValue(this.y)):(this.x=this.drawing.xAxis.toPixels(this.timestamp),this.y=this.drawing.yAxis.toPixels(this.value)),this}},{key:"initSVG",value:function(e,i){var o=n.extend({},t.defaults,i.options);return this.index=e,this.drawing=i,this.type=o.pointType,this.size=o.pointSize,this.draggable=o.draggable,void 0!==this.x&&void 0!==this.y||this.convert(),this.$svg="circle"===this.pointType?t.createPointCircle(this.x,this.y,i.$container,i.renderer,o):t.createPointRect(this.x,this.y,i.$container,i.renderer,o),this}},{key:"addEvents",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.drawing;this.$svg&&this.draggable&&(this.mouseHandlers={},this.mouseHandlers.mousedown=r.addEvent(this.$svg.element,"mousedown",(function(i){if(i=t.drawing.normalize(i),t.drawing.chartDrawing.isInsideAxis(i)){i.stopImmediatePropagation(),e.startEditing(t);var n=!1,o=e.normalize(i);t.mouseHandlers.mousemove=r.addEvent(e.ownerSVG,"mousemove",(function(i){i=t.drawing.normalize(i),t.drawing.chartDrawing.isInsideAxis(i)&&(n=!0,o=t.onMove(!1,e,i,o))})),t.mouseHandlers.mouseup=r.addEvent(e.ownerSVG,"mouseup",(function(i){i=t.drawing.normalize(i),t.drawing.chartDrawing.isInsideAxis(i)&&(t.onMove(!0,e,i,o),t.mouseHandlers.mousemove(),t.mouseHandlers.mouseup(),e.stopEditing(n,t))}))}})))}},{key:"updateSVG",value:function(t){t&&this.convert(),this.$svg.attr("circle"===this.type?{cx:this.x,cy:this.y}:{x:this.x-this.size/2,y:this.y-this.size/2})}},{key:"onMove",value:function(t,e,i,n){return i=e.normalize(i),e.move(t,i.chartX-n.chartX,i.chartY-n.chartY,this),i}},{key:"destroy",value:function(){for(var t in this.mouseHandlers)this.mouseHandlers[t]()}},{key:"setColor",value:function(t){this.drawing.options.properties.defaultKeyPoint.lineColor=t,this.drawing.options.properties.defaultKeyPoint.fillStyle=t,this.$svg.attr({stroke:t,fill:t})}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"timestamp",get:function(){return this._timestamp},set:function(t){this._timestamp=t}},{key:"value",get:function(){return this._value},set:function(t){this._value=t}},{key:"index",get:function(){return this._index},set:function(t){this._index=t}}],[{key:"createPointCircle",value:function(t,e,i,n,o){return n.circle(t,e,o.pointSize/2).attr({class:"point","stroke-width":o.properties.defaultKeyPoint.lineWidth,stroke:o.properties.defaultKeyPoint.lineColor,fill:o.properties.defaultKeyPoint.fillStyle}).css({}).add(i)}},{key:"createPointRect",value:function(t,e,i,n,o){return n.rect(t-o.pointSize/2,e-o.pointSize/2,o.pointSize,o.pointSize).attr({class:"point","stroke-width":o.properties.defaultKeyPoint.lineWidth,stroke:o.properties.defaultKeyPoint.lineColor,fill:o.properties.defaultKeyPoint.fillStyle}).css({}).add(i)}}]),t}();o.exports=a}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2286:function(t,e,i){(function(n,o){var s;void 0===(s=function(t,e,n){var o=i(1),s=i(16),r=i(80),a=i(165),l=o.template(i(2444)),h=i(183);n.exports=r.extend({initialize:function(t){this.drawing=t,r.prototype.initialize.apply(this,arguments),this.render()},events:function(){return o.extend({},o.result(r.prototype,"events"),{"click .fn-save":"onSave","click .fn-cancel":"onCancel"})},getOptions:function(t){return o.extend({},o.result(r.prototype,"getOptions"),{parent:document.body,isHeaderShowed:!0,caption:__("chart_drawings.settings.popup.header"),headerStyle:"wizard"},t)},render:function(){var t=this;return r.prototype.render.call(this),this.$el.addClass("drawing-settings-popup"),this.setContent(l()),this.$form=this.$el.find(".drawing-settings-form"),o.each(this.drawing.configurableOptions,(function(e){var i=null;switch(e.type){case"select":i=a.selectBox(o.extend(e,{translationPrefix:"",disable:!1}));break;case"textarea":i=a.textArea(o.extend(e,{disable:!1,settings:{rows:10,cols:20}}))}i&&(s(i).addClass("field"),t.$form.append(i))})),this.$settingsFrom=new h({el:this.$form}),o.each(this.drawing.configurableOptions,(function(e){t.$settingsFrom.getField(e.name).value(e.value),"textarea"===e.type&&t.$settingsFrom.getField(e.name).setRules({max_length:[100,__("chart_drawings.settings.text_note.error",100)]})})),this},onSave:function(){this.$settingsFrom.validate()||(this.drawing.save(this.$settingsFrom.getData()),this.close())},onCancel:function(t){this.close()}})}.call(e,i,e,t))||(t.exports=s)}).call(this,i(1),i(16))},2287:function(t,e){t.exports={DASH:"Dash",DASH_DOT:"DashDot",DOT:"Dot",LONG_DASH:"LongDash",LONG_DASH_DOT:"LongDashDot",LONG_DASH_DOT_DOT:"LongDashDotDot",SHORT_DASH:"ShortDash",SHORT_DASH_DOT:"ShortDashDot",SHORT_DASH_DOT_DOT:"ShortDashDotDot",SHORT_DOT:"ShortDot",SOLID:"Solid"}},2288:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(n=function(t,e,n){var s=i(2212),r={color:"#47a546",dashstyle:s.DASH_STYLES.SHORT_DASH,draggable:!0,handleEvents:!0,infoLabelKey:"chart.line.profit",infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showProfitLossLabel:!0},a=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.onInstrumentStatusChange(),n.listenTo(n.options.instrument,"change:closable change:editable",n.onInstrumentStatusChange.bind(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"defaults",get:function(){return r}}]),o(e,[{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isEditable()?this.$closeButton.enable():this.$closeButton.disable()}}]),e}(s);n.exports=a}.call(e,i,e,t))||(t.exports=n)},2289:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(n=function(t,e,n){var s=i(2212),r={color:"#ff433d",dashstyle:s.DASH_STYLES.SHORT_DASH,draggable:!0,handleEvents:!0,infoLabelKey:"chart.line.loss",infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showProfitLossLabel:!0},a=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.onInstrumentStatusChange(),n.listenTo(n.options.instrument,"change:closable change:editable",n.onInstrumentStatusChange.bind(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"defaults",get:function(){return r}}]),o(e,[{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isEditable()?this.$closeButton.enable():this.$closeButton.disable()}}]),e}(s);n.exports=a}.call(e,i,e,t))||(t.exports=n)},2340:function(t,e,i){(function(e){var n=i(37).default,o=i(10),s=n.desktop()?["cl-1","cl-2","cl-3","cl-1-1","cl-1-2","cl-2-1","cl-2-2","cl-1-3","cl-3-1","cl-1-1-1"]:n.tablet()?["cl-1","cl-2","cl-1-1","cl-1-2","cl-2-1","cl-2-2","cl-1-1-1"]:[];t.exports={DEFAULT:"cl-2-2",ALL:s,getEmptyMultiChartsPlaceIndex:function(){var t=o.getUserCommonData().getMultiChartsSettings();if(!t||!t.charts||!e.isArray(t.charts))return 0;var i=this.isLayoutAvailable(t)?t.layout:this.DEFAULT,n=this.getSizeByName(i),s=e.findIndex(t.charts,(function(t){return null===t}));return s<0&&(s=t.charts.length),s<n?s:-1},getSizeByName:function(t){return e.reduce(t.split("-"),(function(t,e){return/^\d+$/.test(e)?t+ +e:t}),0)},isLayoutAvailable:function(t){return t&&t.layout&&this.ALL.indexOf(t.layout)>=0}}}).call(this,i(1))},2435:function(t,e,i){(function(n,o){var s,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};void 0===(s=function(t,e,n){var o=i(21),s=(i(6),i(16)),a=i(1),l=i(37).default,h=i(76).default,c=i(7),u=i(10),d=i(2436),p=i(97),f=i(117),g=i(12),v=i(33),y=i(1200),m=i(2464),b=i(2465),w=i(2466),x=i(582),_=i(2231).default,k=i(2232).default,L=i(0),S=i(18),C=i(204),P=i(1207).TC_SETTINGS_UPDATE_EVENT,$=i(61).getInstrumentDetailsState,O=i(2).CLOSED,T=void 0,D={buy:"ask",middle:null,sell:"bid",none:"bid"};n.exports=o.extend({className:"chart-panel",size:{},settings:{},instrument:null,chart:null,parent:null,model:null,period:null,periodRanges:null,enableTrading:!l.mobile(),escapeKeyboardListener:null,events:function(){return a.extend({},a.result(o.prototype,"events"),{"click .fn-show-search":"showSearch","click .fn-hide-search":"hideSearch","wheel .chart-container":"onMouseWheel"})},chartNoDataTemplate:a.template(i(2467)),initialize:function(){T=i(691),o.prototype.initialize.apply(this,arguments),this.type=this.options.type||y.defaultType,this.period=this.options.period||y.defaultPeriod,this.range=this.options.range||y.defaultRange,this.cursor=this.options.cursor||y.defaultCursor,this.rateLine=this.options.rateLine||y.defaultRateLine,this.type===y.comparisonType&&(g.isChartInstrumentsComparisonEnabled()?this.comparisonMode=!0:(this.type=y.defaultType,this.saveType(this.type))),this.listenTo(c,"ui:aside-box-opened",this.handleReflow),this.listenTo(c,"ui:chart:reflow",this.handleReflow),this.listenTo(c,P,this.resubscribeChart),this.listenTo(c,"ui:chart:drawing-stop",this.stopDrawing),this.listenTo(c,"ui:change-theme",this.changeTheme)},changeTheme:function(t){this.chart.changeTheme(T.getChartSettings(this.getMultiChartIndex()),t)},onMouseWheel:function(t){t.deltaY<0?this.zoomIn():this.zoomOut(),t.preventDefault()},zoomIn:function(){this.chart.zoomIn()},zoomOut:function(){this.chart.zoomOut()},showLoading:function(){this.$el.addClass("chart-loading"),this.loadingView&&this.loadingView.destroy(),this.loadingView=new p({parent:this.getLoadingContainer(),position:"absolute",translucent:"2"})},hideLoading:function(t){this.chart.reflow(),this.$el.removeClass("chart-loading"),this.loadingView&&this.loadingView.destroy(),t||(this.chart.destroy(),this.$chartContainer.html(this.chartNoDataTemplate()))},onDataLoad:function(t,e){var i=this;this.hideLoading(!0),this.comparisonMode&&(this.comparisonInstrument=new m({symbol:this.instrument.getSymbol(),name:this.instrument.getDisplayName()}),this.$chartInstrumentsComparisonPanel.setMainInstrument(this.comparisonInstrument)),this.chart.handleHistoricalData(t,this.comparisonMode?this.comparisonInstrument:void 0),this.chart.onDataLoad(),this.comparisonMode?this.comparisonInstruments&&!this.comparisonInstruments.isEmpty()&&a.each(this.comparisonInstruments.models,(function(t){e?t.getSubscription().changeRangeStart(i.chartSubscription.getRangeStart()):(t.getSubscription().stop(),setTimeout((function(){T.updateSubscription(t.getSubscription(),i.range),t.getSubscription().start()}),0))})):this.tradingCentral&&this.tradingCentral.subscribe({instrument:this.instrument,period:this.period})},setInstrument:function(t){var e=this;return t===this.instrument?(setTimeout((function(){return e.handleReflow()}),0),!1):(this.instrument&&this.instrument.off("change:precision"),this.instrument=t,this.instrument&&this.instrument.on("change:precision",this.precisionUpdated,this),!0)},render:function(){var t=this;this.parent&&s(this.parent).append(this.el),this.$el.html(this.template()),this.$chartSplitterBox=s(".chart-splitter-box"),this.$title=this.$el.find(".chart-title"),y.defaultRateLines.indexOf(this.rateLine)<0&&(this.rateLine=y.defaultRateLines[0]),this.$subtitle=this.$el.find(".chart-subtitle"),this.$chartBox=this.$el.parent(),this.$chartContainer=this.$el.find(".chart-container"),this.$fullscreenNotification=this.$el.find(".chart-fullscreen-notification"),this._fontSize=parseFloat(this.$el.find(".chart-basket").css("font-size")),this.chart=new d({el:this.$chartContainer}),this.listenTo(this.chart,"cursor:unselect",(function(){return t.chartToolbar&&t.chartToolbar.setActiveCursor()})),this.listenTo(this.chart,"chart:drawings-save",this.saveDrawings),!this.size.minimized||l.mobile()&&$(window.store.getState())!==O?this.size.fullscreen&&!l.mobile()&&this.fullscreenIn():this.minimizeIn()},onInstrumentSelected:function(t,e,i){if(a.isUndefined(e)&&!(e=v.getInstrumentBySymbol(t)))return!1;var n=null!==this.instrument;return this.setInstrument(e)?(this.setTradesVisibility(i),this.resubscribeChart(n),!0):(this.setTradesVisibility(i,!0),!1)},setTradesVisibility:function(t,e){this.tradesVisibility=t,e&&this.chart.updateTradesVisibility(t)},showChartSettings:function(){T.showChartSettings(this.getMultiChartIndex())},showIndicatorsSettings:function(){T.showIndicatorsSettings(this.getMultiChartIndex())},saveDrawings:function(t){T.saveDrawings(this.instrument.getSymbol(),t,this.getMultiChartIndex())},onOrdersUpdate:function(){if(this.instrument){var t=f.getOrderById(this.instrument.get("orderChainId"));t&&t.hasChanged()&&this.instrument.set(a.pick(t.changedAttributes(),"stopLoss","takeProfit","stopLimitPrice"))}},handleReflow:function(t){this.chart.reflow()},makeScreenshot:function(){this.chart.makeScreenshot()},addFullscreenOutKeyboardListener:function(){this.size.escapeKeyboardListener=this.addKeyboardListener(27,this.toggleFullscreen.bind(this))},removeFullscreenOutKeyboardListener:function(){this.size.escapeKeyboardListener&&(this.size.escapeKeyboardListener.remove(),delete this.size.escapeKeyboardListener)},fullscreenOut:function(){var t=this;this.$el.removeClass("fullscreened"),this.$el.appendTo(this.size.parent),this.removeFullscreenOutKeyboardListener(),setTimeout((function(){return t.chart.reflow()}),1),this.chartToolbar&&this.chartToolbar.setActiveSize(!1)},fullscreenIn:function(){var t=this;this.$el.addClass("fullscreened"),this.size.parent=this.$el.parent(),this.$el.appendTo(s("body")),l.desktop()&&(this.$fullscreenNotification.css("display","block"),this.$fullscreenNotification.fadeOut({duration:2e3,complete:function(){return t.$fullscreenNotification.css("display","none")},step:function(e){return t.$fullscreenNotification.css("opacity",.6*e)}}),this.removeFullscreenOutKeyboardListener(),this.addFullscreenOutKeyboardListener()),this.chart.reflow(),this.chartToolbar&&this.chartToolbar.setActiveSize(!0)},minimizeOut:function(){var t=this;this.$chartBox.removeClass("minimized"),this.$chartSplitterBox.css("display","block"),setTimeout((function(){return t.chart.reflow()}),1)},minimizeIn:function(){this.$chartSplitterBox.css("display","none"),this.$chartBox.addClass("minimized"),this.chart.reflow()},toggleFullscreen:function(){this.size.minimized&&this.toggleMinimize(),this.size.fullscreen?(this.fullscreenOut(),c.trigger("ui:chart:fullscreen-out")):(this.fullscreenIn(),c.trigger("ui:chart:fullscreen-in")),this.size.fullscreen=!this.size.fullscreen},addKeyboardListener:function(t,e,i){var n=function(i){(i=i||window.event).keyCode===t&&e()};return document.addEventListener("keydown",n,i||!1),{remove:function(){document.removeEventListener("keydown",n)}}},restoreSize:function(){this.size.fullscreen&&this.toggleFullscreen(),this.size.minimized&&this.toggleMinimize()},toggleMinimize:function(){this.size.fullscreen&&this.toggleFullscreen(),this.size.minimized?(this.minimizeOut(),c.trigger("ui:chart:minimize-out")):(this.minimizeIn(),c.trigger("ui:chart:minimize-in")),this.size.minimized=!this.size.minimized},initBaskets:function(){var t=this.instrument.getBasket();if(t){for(var e=__("baskets.consists",t.instrumentSymbol),i=0,n=t.instruments.length;i<n;i++)e+=" "+t.instruments[i].instrumentWeight+"% "+t.instruments[i].displayName,e+=i<n-1?", ":".";this.$el.find(".chart-basket-title").html(__("baskets.title")+":"),this.$el.find(".chart-basket-info").html(e),this._fitChartBasketHeight()}else this.$el.find(".chart-basket-title").html(""),this.$el.find(".chart-basket-info").html("")},initHeader:function(){this.$title.html(this.instrument.getDisplayName()),this.$subtitle.html(this.instrument.getDescription())},stopTradingCentral:function(){this.tradingCentral&&this.tradingCentral.unsubscribe()},onDataUpdate:function(t,e){return this.chart.handleStreamData(t,e)},getMultiChartIndex:function(){return this.options.multiChartIndex},resubscribeChart:function(t){var e=this;this.instrument&&this.chart&&(this.showLoading(),this.stopTradingCentral(),this.stopDrawing(),this.initHeader(),this.initBaskets(),this.initBuySellButtons(),this.chartSubscription&&this.chartSubscription.stop(),this.chartSubscription=T.createSubscription(r({chartId:this.options.chartId,symbol:this.instrument.getSymbol()},this.comparisonMode?{range:this.range}:{period:this.period},{price:D[this.rateLine],indicators:this.comparisonMode?null:T.getActiveIndicators(this.getMultiChartIndex())})),this.chart.resubscribe({instrument:this.instrument,chartSubscription:this.chartSubscription,type:this.type,period:this.period,rateLine:this.rateLine,cursor:this.cursor,enableTrading:this.enableTrading,tradesVisibility:this.tradesVisibility,comparisonMode:!!this.comparisonMode,settings:T.getChartSettings(this.getMultiChartIndex()),indicators:this.comparisonMode?[]:T.getActiveIndicators(this.getMultiChartIndex()),drawings:h.desktop()?T.getDrawings(this.instrument.getSymbol(),this.getMultiChartIndex()):{}}),this.chartSubscription.on({start:function(){return e.showLoading()},timeout:function(){return e.hideLoading(!1)},load:function(i){return e.onDataLoad(i,t)},update:function(t){return e.onDataUpdate(t,e.chartSubscription.getFirstCandle())}}),this.chartSubscription.start())},getInstrumentSymbol:function(){return this.instrument&&this.instrument.getSymbol()},subscribe:function(t,e){this.onInstrumentSelected(t,void 0,e),this.hideSearch()},_fitChartBasketHeight:function(){var t=parseFloat(this.$el.find(".chart-basket").css("height"));if(t>parseFloat(this.$el.find(".chart-info").css("height"))&&this._fontSize>9)return this.$el.find(".chart-basket-title").html(""),this._fontSize--,this.$el.find(".chart-basket").css("font-size",this._fontSize+"px"),void this._fitChartBasketHeight();t>40&&this.$el.find(".chart-basket").css("display","none")},precisionUpdated:function(t,e){this.chart&&this.chart.updatePrecision(e)},destroyBuySellButtons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$buyButton,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$sellButton;S.unmountComponentAtNode(e),S.unmountComponentAtNode(t)},initBuySellButtons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$buyButton,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$sellButton;if(t&&e)if(this.destroyBuySellButtons(t,e),u.getUserCommonData().isAdvancedTradingView()){if(l.mobile()){var i=this.instrument.getSymbol();S.render(L.createElement(x.Bid,{symbol:i,render:k}),e),S.render(L.createElement(x.Ask,{symbol:i,render:_}),t)}}else S.render(L.createElement(C,{type:"Sell",column:{name:"Sell",key:"bid",direction:"bidDirection"},model:this.instrument,display:"block",isSelected:!0}),e),S.render(L.createElement(C,{type:"Buy",column:{name:"Buy",key:"ask",direction:"askDirection"},model:this.instrument,display:"block",isSelected:!1}),t)},startDrawing:function(t){this.drawingType=a.isString(t)?t:this.getTarget(t).dataset.type,this.chart.startDrawing(this.drawingType)},stopDrawing:function(){this.chart.stopDrawing()},clearDrawings:function(){this.stopDrawing(),this.chart.clearDrawings()},getTarget:function(t){return t.currentTarget},onChangePeriod:function(t){this.period=t,this.resubscribeChart()},onChangeRange:function(t){this.range=t,this.period=T.getPeriodByRange(t),this.resubscribeChart()},onChangeType:function(t){this.type=t,this.chart.changeType(t)},onZoomIn:function(){this.chart.zoomIn()},onZoomOut:function(){this.chart.zoomOut()},onShowChartSettings:function(){T.showChartSettings(this.getMultiChartIndex(),this.chart.applySettings.bind(this.chart))},onShowIndicatorsSettings:function(){T.showIndicatorsSettings(this.getMultiChartIndex(),this.resubscribeChart.bind(this))},onChangeCursor:function(t){this.chart.changeCursor(t)},onChangeRateLine:function(t){this.rateLine=t,this.resubscribeChart()},onSearchResultClick:function(t){c.trigger("ui:instrument",t,!0)},showSearch:function(t){this.chartSearchView||(this.chartSearchView=new w({el:this.$el.find(".chart-search-block-wrapper"),onRowClick:this.onSearchResultClick.bind(this)})),this.chartSearchView.show(a.isBoolean(t)&&t)},hideSearch:function(){this.chartSearchView&&this.chartSearchView.hide()},initComparisonInstruments:function(){var t=this,e=this.instrument;this.comparisonInstruments||(this.comparisonInstruments=new b,this.listenTo(this.comparisonInstruments,"full",this.updateComparisonSearch)),this.comparisonInstrument=new m({symbol:e&&e.getSymbol(),name:e&&e.getDisplayName()});var n=i(2468);S.render(L.createElement(n,{mainInstrument:this.comparisonInstrument,comparisonInstruments:this.comparisonInstruments,ref:function(e){t.$chartInstrumentsComparisonPanel=e}}),this.$el.find(".chart-instruments-comparison-panel")[0])},enableComparisonMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.range;this.comparisonMode=!0,this.type=y.comparisonType,this.range=t,this.period=T.getPeriodByRange(this.range),this.initComparisonInstruments(),this.resubscribeChart()},disableComparisonMode:function(t,e){this.comparisonMode=!1,this.type=t,this.period=e,S.unmountComponentAtNode(this.$el.find(".chart-instruments-comparison-panel")[0]),this.resubscribeChart(),this.chart.changeCursor()},addComparisonInstrument:function(t){var e=this,i=v.getInstrumentBySymbol(t);if(!this.comparisonInstruments.contains(t)&&i){var n=new m({symbol:i.getSymbol(),name:i.getDisplayName()});n.setSubscription(T.createSubscription({chartId:this.options.chartId,symbol:t,range:this.range,price:D[this.rateLine]})),this.comparisonInstruments.add(n),this.chart.addComparisonInstrument(n,this.comparisonInstruments.length),n.on("remove",(function(){e.removeComparisonInstrument(n.getSymbol())})),n.getSubscription().start(this.chartSubscription.getRangeStart())}},removeComparisonInstrument:function(t){},updateComparisonSearch:function(t){this.initToolbar(),this.chartToolbar.updateComparisonSearch(t)},destroy:function(){this.chartSubscription&&this.chartSubscription.stop(),this.destroyBuySellButtons(),o.prototype.destroy.call(this)}})}.call(e,i,e,t))||(t.exports=s)}).call(this,i(1),i(16))},2436:function(t,e,i){(function(n,o){var s;function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}void 0===(s=function(t,e,n){var s=i(1),a=i(37).default,l=i(76).default,h=i(6),c=i(21),u=i(694),d=i(2437),p=i(1200),f=i(1215),g=i(2448),v=i(2453),y=i(2454),m=i(2457),b=/(M\s*\S*\s*\S*\s*L\s*)(\S*)(\s*\S*\s*)/,w=void 0,x=function(t,e,i,n,o,s){var r=this,a=this.chart.get(p.options.names.series.main).xData;void 0!==e&&(arguments[1]=Math.min(e,a[Math.max(0,a.length-p.options.general.candles.overscroll.offset)])),s&&s.DOMEvent&&"mouseup"===s.DOMEvent.type&&setTimeout((function(){var t=r.chart.get(p.options.names.axis.mainX);r.chart.navigator.render(t.min,t.max)}),0),t.apply(this,Array.prototype.slice.call(arguments,1))},_=function(t,e,i){t.call(this,e,i),w.each(this.chart.series,(function(t){t.chart[t.sharedClipKey]&&t.chart[t.sharedClipKey].attr(i||t.chart.clipBox)}))},k=function(t,e,i){if(t.call(this,e,i),w.defined(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){var n=this.crossLabel;if(n)if(e||this.isXAxis||i.series.yAxis.options.id===this.options.id||this.crossLabel.hide(),this.isXAxis){if(p.options.chart.label.offsetY){for(var o=this.cross.d.split(" "),s=0,r=-1,a=5,l=o.length;a<l;)o[a]>s&&(s=o[a],r=a),a+=6;if(r>=0){var h=+o[r]+p.options.chart.label.offsetY;o[r]=h,o=o.join(" "),this.cross.attr({d:o}),n.attr({y:h})}}}else if(p.options.chart.label.offsetX){var c=this.cross.d.match(b),u=+c[2]+p.options.chart.label.offsetX;this.cross.attr({d:""+c[1]+u+c[3]}),n.attr({x:u})}}},L=Promise.resolve().then(i.t.bind(null,688,7));L.then((function(t){var e;(w=t).forEachPolyfill=function(t,e){for(var i=0,n=this.length;i<n;){if(!1===t.call(e,this[i],i,this))return i;i++}},(e=w).Axis.prototype.protoEvents&&e.Axis.prototype.protoEvents.afterDrawCrosshair&&e.each(e.Axis.prototype.protoEvents.afterDrawCrosshair,(function(t,e){t.order=e})),e.addEvent(e.Axis,"afterDrawCrosshair",(function(t){if(e.defined(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){var i=this.chart,n=this.horiz,o=this.opposite,s=this.options.crosshair.label,r=n?"center":o?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center",a=this.crossLabel;a||(a=this.crossLabel=i.renderer.label(null,null,null,s.shape||"callout").addClass("highcharts-crosshair-label"+(this.series[0]&&" highcharts-color-"+this.series[0].colorIndex)).attr({align:s.align||r,padding:e.pick(s.padding,8),r:e.pick(s.borderRadius,3),zIndex:8}).add()).attr({fill:s.backgroundColor||this.series[0]&&this.series[0].color||"#666666",stroke:s.borderColor||"","stroke-width":s.borderWidth||0}).css(e.extend({color:"#ffffff",fontWeight:"normal",fontSize:"11px",textAlign:"center"},s.style))}}),{order:-1}),w.wrap(w.Axis.prototype,"setExtremes",x),w.wrap(w.Axis.prototype,"drawCrosshair",k),w.wrap(w.Pointer.prototype,"scaleGroups",_),i(1238)(w),i(1239)(w),i(2460)(w),i(2461)(w),i(2462)(w),i(2463)(w)})),n.exports=c.extend({chart:null,plotLines:null,comparisonMode:!1,_initOverscroll:function(){var t=1e3*u[this.period].seconds,e=this.chartSubscription.getLastCandle();this.overscrollData=s.map(s.range(p.options.general.candles.overscroll.total),(function(i){return[e.timestamp+(i+1)*t,e.close]})),this.chart.addSeries({type:"line",color:"transparent",shadow:!1,animation:!1,data:this.overscrollData,showInNavigator:!0,tooltip:{enabled:!1,pointFormatter:function(){return null}}})},onDataLoad:function(){var t=this;this.comparisonMode?(this.plotLines&&this.plotLines.currentRate&&(this.plotLines.currentRate.destroy(),delete this.plotLines.currentRate),this._destroyTradingPlotLines()):(l.desktop()&&(this.chartDrawings=new d({chart:this.chart,options:this.drawings,start:this.chartSubscription.getFirstCandle().timestamp,finish:this.chartSubscription.getLastCandle().timestamp,onSave:function(e){return t.trigger("chart:drawings-save",e)},forExport:!1}),this.chartDrawings.externalHandlers.push(w.addEvent(this.chartDrawings,"enableEditing",this.enableDrawingsEditing.bind(this))),this.chartDrawings.externalHandlers.push(w.addEvent(this.chartDrawings,"disableEditing",this.disableDrawingsEditing.bind(this))),delete this.drawings),this._initCurrentRatePlotLine(),this._initTradingPlotLines(),this._initOverscroll(),this._initExtremes()),this._redrawChart()},bindEvents:function(t,e){var i=function(i){var n=t.searchPoint(i,!0);n&&e.setChange(n.y)};if(w.hasTouch){var n=w.addEvent(this.chart.container,"touchmove",i),o=w.addEvent(this.chart.container,"touchstart",i);return function(){n(),o()}}var s=w.addEvent(this.chart.container,"mousemove",i);return function(){s()}},handleHistoricalData:function(t,e){if(this.comparisonMode){var i=this._getMainSeries();if(i){i.setData(f.extendPoints(this.convertCandles(t),this.chartSubscription),!1);var n=this.bindEvents(i,e);e.on("remove",(function(){n()})),e.setColor(i.color),this.changeCursor("comparison_crosshair")}}else this._setHistoricalData(t)},_updateCurrentRateLine:function(){"none"===this.rateLine||this.comparisonMode||this.plotLines&&this.plotLines.currentRate&&this.plotLines.currentRate.updateRate(this.chartSubscription.getLastCandle().close)},handleStreamData:function(t,e){this._updateHistoricalData(t,e),this._updateCurrentRateLine(),this._redrawChart()},changeType:function(t){this._changeType(t)},changeCursor:function(t){this._changeCursor(t)},changeTheme:function(t,e){this.applySettings(t)},applySettings:function(t){this.isExists()&&(this._applyChartSettings(t),this._redrawChart())},reflow:function(){this.isExists()&&this.chart.reflow()},makeScreenshot:function(){this._exportChart()},destroy:function(){this.stopListening(),this.chartDrawings&&this.chartDrawings.destroy(),this.chart&&this.chart.destroy&&(this.chart.destroy(),this.chart=null)},zoomIn:function(){this._zoom(.8)},zoomOut:function(){this._zoom(1.25)},isExists:function(){return s.isObject(this.chart)},isOpenPositionsVisible:function(){return this.tradesVisibility.showTrades&&this.tradesVisibility.showAllOpenPositions},isOrdersVisible:function(){return this.tradesVisibility.showTrades&&this.tradesVisibility.showAllOrders},_initCurrentRatePlotLine:function(){this.plotLines?(this.plotLines.currentRate&&this.plotLines.currentRate.destroy(),delete this.plotLines.currentRate):this.plotLines={},"none"!==this.rateLine&&(this.plotLines.currentRate=new v(this.chart,{showInfoLabel:!0,infoLabelKey:"chart.line."+this.rateLine,instrument:this.instrument}),this._updateCurrentRateLine())},updateTradesVisibilityForType:function(t,e,i,n,o,a){var l=this;this.plotLines[e]||(this.plotLines[e]=[]);var h=this.plotLines[e],c=s.pluck(n.models,"cid"),u=s.map(h,(function(e){return e.options[t].cid})),d=o?c:s.intersection(c,a),p=s.difference(d,u),f=s.difference(u,d);if(f.length)for(var g=0,v=h.length;g<v;)f.indexOf(h[g].options[t].cid)>=0?(h[g].destroy(),h.splice(g,1),v--):g++;s.each(p,(function(e){var o;h.push(new i(l.chart,(r(o={},t,n.get(e)),r(o,"instrument",l.instrument),o)))}))},updateTradesVisibility:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tradesVisibility;this.enableTrading&&this.plotLines&&t.showTrades&&(this.updateTradesVisibilityForType("order","orders",m,this.instrument.getOrders(),t.showAllOrders,t.visibleTradesIds),this.updateTradesVisibilityForType("position","positions",y,this.instrument.getPositions(),t.showAllOpenPositions,t.visibleTradesIds)),this.tradesVisibility=t},updateTradingCentral:function(t){var e=this;if(this.isExists()){this.tcExremes={min:.9999*t.support3,max:1.0001*t.resistance3};var i=0;this.plotLines||(this.plotLines={}),this.plotLines.tc||(this.plotLines.tc={}),s.each(p.tradingCentralSettings,(function(n,o){t[o]?(e.plotLines.tc[o]&&!e.plotLines.tc[o].destroyed||(e.plotLines.tc[o]=new g(e.chart,{className:"tc-"+o,color:t.lines[i++/3>>0].colors[0],showInfoLabel:!0,infoLabelAlign:n.align,infoLabelValue:n.text,precision:e.instrument.getPrecision()})),e.plotLines.tc[o].updateRate(t[o])):i++})),t.pivot===t.resistance1?(this.plotLines.tc.resistance1.destroy(),delete this.plotLines.tc.resistance1):t.pivot===t.support1&&(this.plotLines.tc.support1.destroy(),delete this.plotLines.tc.support1),this._updateValueExtremes(),this._redrawChart()}},updatePrecision:function(t){var e=this;L.then((function(){e.chart.update({tooltip:{valueDecimals:t}})}))},startDrawing:function(t){this.isExists()&&this.chartDrawings&&(this.chartDrawings.startDrawing(t),o(this.chart.container).addClass("drawing-started"))},stopDrawing:function(){this.isExists()&&this.chartDrawings&&(this.chartDrawings.stopDrawing(),this.chartDrawings.setActiveDrawing(),o(this.chart.container).removeClass("drawing-started"))},clearDrawings:function(){this.isExists()&&this.chartDrawings&&(this.chartDrawings.clearDrawings(),o(this.chart.container).removeClass("drawing-started"))},_exportChart:function(){var t=this;this.isExists()&&this.chart.exportChartLocal({filename:this.instrument.getDisplayName()+"_"+h().format("YYYYMMDDHHmmss"),type:/Edge\/|Trident\/|MSIE /.test(window.navigator.userAgent)?"image/svg+xml":"image/png"},this.configurator.createExportingConfig({onLoad:function(e){if(t.chartDrawings)new d({chart:e,options:t.chartDrawings.options,forExport:!0});t.configurator.addChartInfoExporting(e),t.plotLines&&(t.plotLines.currentRate&&t.plotLines.currentRate.exportTo(e),s.each(t.plotLines.positions,(function(t){return t.exportTo(e)})),s.each(t.plotLines.orders,(function(t){return t.exportTo(e)})),s.each(t.plotLines.tc,(function(t){return t.exportTo(e)})))},onRedraw:function(e){t._redrawHandler(e)}}))},resubscribe:function(t){var e=this,i=t.instrument,n=t.period,o=t.type,s=t.rateLine,r=t.indicators,a=t.settings,l=t.drawings,h=t.tradesVisibility,c=t.enableTrading,u=t.cursor,d=t.comparisonMode,f=t.chartSubscription;L.then((function(){e.destroy(),e.instrument=i,e.tradesVisibility=h,e.drawings=l,e.period=n,e.rateLine=s,e.comparisonMode=d,e.enableTrading=c,e.chartSubscription=f,e.extremes=null,e.tcExremes=null,e.chartDrawings&&(e.chartDrawings.destroy(),e.chartDrawings=void 0),e._destroyTradingPlotLines(),u=e.configurator?e.configurator.previousCursor:u,e.configurator=new p({instrumentInfo:e.instrument,type:o,settings:a,indicators:r,comparisonMode:d,onSetExtremes:e._setExtremesHandler.bind(e),onRedraw:e._redrawHandler.bind(e)}),e.chart=new w.StockChart(e.el,e.configurator.createHighchartsConfig()),e._detectIndicatorsSeries(),e._changeCursor(u),e.colors={"#42aa2d":!0,"#de67a7":!0,"#dd7130":!0,"#7a43b0":!0}}))},_redrawHandler:function(t){},_setExtremesHandler:function(t){this.extremes=s.pick(t,"min","max"),this._updateValueExtremes()},_initExtremes:function(){var t=this.getTimestamps(),e=p.options.general.candles,i=e.visible;if(1===t.length||i>=t.length)this._getMainXAxis().setExtremes(s.first(t),s.last(t),!1,null);else{var n=t[t.length-(e.overscroll.total-e.overscroll.visible)-i],o=t[t.length-(e.overscroll.total-e.overscroll.visible)-1];this._getMainXAxis().setExtremes(n,o,!1,null)}},_getMainSeries:function(){return this.chart.get(p.options.names.series.main)},_getVolumeSeries:function(){return this.chart.get(p.options.names.series.volume)},_getMainXAxis:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart;return t?t.get(p.options.names.axis.mainX):null},_getMainYAxis:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart;return t?t.get(p.options.names.axis.mainY):null},convertCandles:function(t){var e=this.configurator.getTypeConverter(),i=void 0,n=s.first(t);return s.map(t,(function(t){if(!t.expansion)return i=e(t,i,n)}))},_changeType:function(t){if(this.configurator.type!==t&&this.isExists()){var e=this._getMainSeries();e&&(e.remove(!1),this.configurator.type=t,this.chart.addSeries(this.configurator.createMainSeriesConfig(this.convertCandles(this.chartSubscription.getCandles())),!1),this._redrawChart())}},_setHistoricalData:function(t){var e=this,i=this._getMainSeries();if(i){var n=[],o=[],r=this.configurator.getTypeConverter(),a=void 0,l=s.first(t),h=[];s.each(t,(function(t){t.studyValues&&s.each(t.studyValues.values,(function(i,o){"NaN"!==i&&(n[o]=n[o]||[],n[o].push(e._toIndicatorPoint(t.timestamp,i)))})),t.expansion||(o.push(e._toIndicatorPoint(t.timestamp,t.volume)),a=r(t,a,l),h.push(a))})),i.setData(h,!1),this.configurator.hasVolume&&this._getVolumeSeries().setData(o,!1),s.each(this.inicatorsSeries,(function(t,e){return t.setData(n[e],!1)}))}},_updateHistoricalData:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getMainSeries(),o=this.configurator.getTypeConverter();n&&s.each(t,(function(t){t.studyValues&&s.each(t.studyValues.values,(function(e,n){"NaN"!==e&&i.addOrUpdatePoint(i.inicatorsSeries[n],i._toIndicatorPoint(t.timestamp,e))})),t.expansion||(i.configurator.hasVolume&&i.addOrUpdatePoint(i._getVolumeSeries(),i._toIndicatorPoint(t.timestamp,t.volume)),i.addOrUpdatePoint(n,o(t,i._getLastPoint(),e)))}))},_toIndicatorPoint:function(t,e){return[t,e]},addOrUpdatePoint:function(t,e){return t.xData[t.xData.length-1]<e[0]?(this._addPoint(t,e),{added:!0}):{added:!1,updatedIndex:this._updatePoint(t,e)}},_addPoint:function(t,e){t.addPoint(e,!1,!this.comparisonMode,!1)},_updatePoint:function(t,e){var i=t.xData.indexOf(e[0]),n=s.findWhere(t.points,{index:i});return n&&n.x===e[0]?n.update(e,!1,!1):(t.removePoint(i,!1,!1),t.addPoint(e,!1,!1,!1)),i},_getLastPoint:function(){var t=this._getMainSeries().yData;return t=t[t.length-2],s.isArray(t)?[0,t[0],t[1],t[2],t[3]]:[0,0,0,0,t]},_updateValueExtremes:function(){if(this.tcExremes){var t=this._getMainYAxis().getExtremes();this._getMainYAxis().setExtremes(Math.min(t.dataMin,this.tcExremes.min),Math.max(t.dataMax,this.tcExremes.max),!1)}},_redrawChart:function(){this.chart.redraw()},getTimestamps:function(){return s.union(s.pluck(this.chartSubscription.getCandles(),"timestamp"),s.pluck(this.overscrollData,"0"))},_zoom:function(t){if(this.isExists()&&(s.isUndefined(this.chartDrawings)||!this.chartDrawings.isDrawingEditingEnabled())&&!this.comparisonMode){var e=this.getTimestamps();this.extremes||(this.extremes=s.pick(this._getMainXAxis().getExtremes(),"min","max"));var i=Math.max(this.extremes.min,s.first(e)),n=Math.min(this.extremes.max,s.last(e));i=s.sortedIndex(e,i);var o=((n=s.sortedIndex(e,n))-i)*t,r=(n+i)/2;i=Math.max(Math.round(r-o/2),0),n=Math.min(Math.round(r+o/2),e.length-1),e[i]&&e[n]&&this._getMainXAxis().setExtremes(e[i],e[n])}},_initTradingPlotLines:function(){var t=this;this._destroyTradingPlotLines(),this.enableTrading&&(this.listenTo(this.instrument.getPositions(),"add",(function(e){t.isOpenPositionsVisible()&&t.plotLines.positions.push(new y(t.chart,{position:e,instrument:t.instrument}))})),this.listenTo(this.instrument.getOrders(),"add",(function(e){t.isOrdersVisible()&&t.plotLines.orders.push(new m(t.chart,{order:e,instrument:t.instrument}))})),this.plotLines.positions=[],this.plotLines.orders=[],this.updateTradesVisibility())},_destroyTradingPlotLines:function(){this.plotLines&&(this.plotLines.positions&&(s.each(this.plotLines.positions,(function(t){return t.destroy()})),delete this.plotLines.positions),this.plotLines.orders&&(s.each(this.plotLines.orders,(function(t){return t.destroy()})),delete this.plotLines.orders))},_applyChartSettings:function(t){var e=t.switchers.showVolume!==this.configurator.settings.switchers.showVolume,i=t.switchers.showTrades!==this.configurator.settings.switchers.showTrades;this.configurator.settings=t;var n=this.configurator.createHighchartsConfig();this._updateChart(this.chart,n),this._updateAxes(this.chart.xAxis),this._updateAxes(this.chart.yAxis),this._updateNavigator(this.chart.navigator,n),this._updateMainSeries(this._getMainSeries(),n),this._updateVolumeSeries(e,n),i?(this.tradesVisibility.showTrades=t.switchers.showTrades,this.tradesVisibility.showTrades?this._initTradingPlotLines():this._destroyTradingPlotLines()):this._updatePlotLines(t),this._updateChartDrawings(t)},_updateChart:function(t,e){t.update({chart:e.chart},!1)},_updateAxes:function(t){var e=this;s.each(t,(function(t){(void 0===t.options.id||t.options.id.indexOf("navigator")<0)&&t.update(e.configurator.getAxisSettings(t.isXAxis,t.options.id===p.options.names.axis.volume),!1)}))},_updateNavigator:function(t,e){t.update(e.navigator,!1)},_updateMainSeries:function(t,e){t.update(e.plotOptions[this.configurator.type],!1)},_updatePlotLines:function(t){this.plotLines&&(this.plotLines.currentRate&&this.plotLines.currentRate.applySettings(t),s.each(this.plotLines.positions,(function(e){return e.applySettings(t)})),s.each(this.plotLines.orders,(function(e){return e.applySettings(t)})),s.each(this.plotLines.tc,(function(e){return e.applySettings(t)})))},_updateChartDrawings:function(t){this.chartDrawings&&this.chartDrawings.applySettings(t)},_updateVolumeSeries:function(t,e){var i=this;t&&(this.configurator.hasVolume?(this.chart.addAxis(s.last(e.yAxis),!1,!1),this.chart.addSeries(s.last(e.series),!1).setData(s.map(this.historicalData,(function(t){return i._toIndicatorPoint(t.timestamp,t.volume)}),!1))):(this.chart.get(p.options.names.series.volume).remove(!1),this.chart.get(p.options.names.axis.volume).remove(!1))),this.configurator.hasVolume&&this.chart.get(p.options.names.series.volume).update(e.plotOptions.column,!1)},_detectIndicatorsSeries:function(){this.inicatorsSeries=s.filter(this.chart.series,(function(t){return t.options.id!==this.main&&t.options.id!==this.volume&&t.options.id!==this.navigator}),p.options.names.series)},_changeCursor:function(t){if(a.desktop()||"comparison_crosshair"===t){var e=this._getMainXAxis(),i=this._getMainYAxis();if(e&&i&&(!t||t!==this.configurator.currentCursor)){t=t||this.configurator.previousCursor||p.options.general.cursor,this._setCursorTypeClassName(this.$el,t);var n=this.configurator.createCursorConfig(t,this.period);e.update(n.xAxis,!1),s.each(this.chart.yAxis,(function(t){t.options.id!==p.options.names.axis.navigatorY&&t.options.id!==p.options.names.axis.volume&&t.update(n.yAxis,!1)})),"drawing"===t||"comparison_crosshair"===t?this.trigger("cursor:unselect"):this.configurator.previousCursor=t,this.configurator.currentCursor=t,n.tooltip.enabled?this.configurator.enableTooltip():(this.configurator.disableTooltip(),this.chart.tooltip.hide(0)),this.chart.pointer.followTouchMove=!!n.tooltip.followTouchMove,this.chart.update({tooltip:n.tooltip},!1),this._redrawChart()}}},enableDrawingsEditing:function(){this.changeCursor("drawing")},disableDrawingsEditing:function(){this.changeCursor()},_setCursorTypeClassName:function(t,e){s.each(s.filter(t[0].classList,(function(t){return 0===t.indexOf("cursor-")})),(function(e){t.removeClass(e)})),t.addClass("cursor-"+e)},initialize:function(){c.prototype.initialize.apply(this,arguments)},addComparisonInstrument:function(t,e){var i=this,n=t.getSubscription(),o=void 0,r=void 0,a=void 0;for(var l in this.colors)if(this.colors[l]){o=l,this.colors[l]=!1;break}function h(){a(),r=null,this.colors[o]=!0}n.on({start:function(){},timeout:function(){},stop:function(){r&&(r.remove(),r=null)},load:function(e){var l=f.extendPoints(i.convertCandles(e),n);r=i.chart.addSeries(s.extend(i.configurator._createSeriesConfig(l,"ic-"+n.getInstrument().getSymbol(),n.getInstrument().getDisplayName()),{color:o})),a=i.bindEvents(r,t);var c=w.addEvent(r,"remove",(function(){h.call(i),c()})),u=w.addEvent(r,"destroy",(function(){h.call(i),u()}));t.on("remove",(function(){n.stop()})),t.setColor(r.color),i.colors[o]=!1},update:function(e){r&&s.each(e,(function(e){e.expansion||i.addOrUpdatePoint(r,i.configurator.getTypeConverter()(e,i._getLastPoint(),t.getSubscription().getFirstCandle()))}))}})}})}.call(e,i,e,t))||(t.exports=s)}).call(this,i(1),i(16))},2437:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(1),r=i(688),a=i(1200),l=i(2284),h=i(2446),c={enabled:!1,handlers:[]},u={DOWN:"mousedown",MOVE:"mousemove",UP:"mouseup"},d=46,p=function(t,e){return function(i){return"horizontal_line"===i.type&&i.keyPoints[0].timestamp<=t&&(i.keyPoints[0].timestamp=e),i}},f=function(){function t(e){var i=e.chart,n=e.options,s=e.start,r=e.finish,a=e.onSave,h=e.forExport;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._chart=i,this._options=o.map(o.compact(n),p(s,r)),this._onSave=a,this._start=s,this._type=l.defaultType,this.chart.chartDrawing=this,this.initSVG(),this.externalHandlers=[],h||this.initDrawingSettings()}return s(t,[{key:"chart",get:function(){return this._chart}},{key:"drawings",get:function(){return this._drawings},set:function(t){this._drawings=t}},{key:"options",get:function(){return this._options},set:function(t){this._options=t}},{key:"mainGroup",get:function(){return this._mainGroup}},{key:"backgroundRect",get:function(){return this._backgroundRect}},{key:"drawingFactory",get:function(){return this._drawingFactory}},{key:"onSave",get:function(){return this._onSave},set:function(t){this._onSave=t}},{key:"start",get:function(){return this._start}},{key:"yAxis",get:function(){return this.chart.get(a.options.names.axis.mainY)}},{key:"xAxis",get:function(){return this.chart.get(a.options.names.axis.mainX)}}]),s(t,[{key:"enableEditing",value:function(){c.enabled=!0,c.moved=!1,r.fireEvent(this,"enableEditing")}},{key:"disableEditing",value:function(){c.enabled=!1,c.moved=!1,r.fireEvent(this,"disableEditing")}},{key:"destroy",value:function(){this.removeActiveDrawingHandler.remove(),this.setActiveDrawing(null),o.each(this.externalHandlers,(function(t){return t()})),o.each(this.drawings,(function(t){return t.destroy()})),this.drawings=[]}},{key:"startDrawing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.defaultType;this.enableEditing(),this._type=t,this.bindEvents()}},{key:"stopDrawing",value:function(){this.disableEditing(),this._type=null,this.unbindEvents()}},{key:"initSVG",value:function(){this.initBackgroundRect(),this.initClipRect(),this.initMainGroup(),this.initLoadedDrawings(),this.initGlobalEvents()}},{key:"redraw",value:function(){this.updateClipRect(),this.updateDrawings()}},{key:"updateDrawings",value:function(){o.each(this.drawings,(function(t){return t.redraw()}))}},{key:"initBackgroundRect",value:function(){this._backgroundRect=this.chart.renderer.rect(0,0,0,0).attr({class:"drawings-background",height:"100%","pointer-events":"visible",width:"100%",zIndex:6}).add()}},{key:"initClipRect",value:function(){var t={x:this.yAxis.left,y:this.yAxis.top,width:this.yAxis.width,height:this.yAxis.height};this._clipRect=this.chart.renderer.clipRect(t)}},{key:"updateClipRect",value:function(){this._clipRect.attr({x:this.yAxis.left,y:this.yAxis.top,width:this.yAxis.width,height:this.yAxis.height})}},{key:"initMainGroup",value:function(){this._mainGroup=this.chart.renderer.g("drawings-container").attr({zIndex:7}).add().clip(this._clipRect)}},{key:"filterDrawings",value:function(t,e,i){return e?o.filter(t,(function(t){var n=o.filter(t.keyPoints,(function(t){return t.timestamp>e})).length;return i?0===n:0!==n})):t}},{key:"initLoadedDrawings",value:function(){var t=this;this._drawingFactory=new l(this.chart,this.mainGroup),this.drawings=o.compact(o.map(this.filterDrawings(this.options,this.start),(function(e){return t.drawingFactory.createDrawing(e)})))}},{key:"initGlobalEvents",value:function(){r.wrap(r.Pointer.prototype,"drag",(function(t,e){c.enabled||t.call(this,e)})),r.addEvent(this.chart,"redraw",this.redraw.bind(this)),r.addEvent(this.backgroundRect.element,u.DOWN,(function(t){t.currentTarget===t.target&&!c.enabled&&c.drawing&&c.drawing.deactivate()}))}},{key:"setActiveDrawing",value:function(t){c.drawing!==t&&(c.drawing&&(c.drawing.deactivate(!0),c.drawing=null,this.drawingSettingsBar.hide()),t&&(c.drawing=t,c.drawing.activate(!0),this.drawingSettingsBar.resetPosition(),this.drawingSettingsBar.show()))}},{key:"bindEvents",value:function(){this.addEvent(u.DOWN,this.mouseDownHandler.bind(this))}},{key:"unbindEvents",value:function(){for(var e in u)t.removeEvent(u[e])}},{key:"rebindEvents",value:function(){this.unbindEvents(),this.bindEvents()}},{key:"mouseDownHandler",value:function(t){this.enableEditing(),this.createDrawing(),this.updateDrawing(t),c.drawing.defaults.points>1&&(c.currentPointIndex=1),this.addEvent(u.MOVE,this.mouseMoveHandler.bind(this)),this.addEvent(u.UP,this.mouseUpHandler.bind(this))}},{key:"mouseMoveHandler",value:function(t){c.moved=!0,this.updateDrawing(t)}},{key:"mouseUpHandler",value:function(e){c.moved||(c.currentPointIndex=0),this.updateDrawing(e),c.currentPointIndex++,c.drawing.defaults.points===c.currentPointIndex?(c.drawing.addEvents(),this.rebindEvents(),c.drawing.isFinished(e)?this.finalizeDrawing(!0):this.unbindEvents()):t.removeEvent(u.DOWN)}},{key:"finalizeDrawing",value:function(t){this.disableEditing(),this.rebindEvents(),t&&this.saveDrawing()}},{key:"createDrawing",value:function(){var t={type:this._type,id:this._type+"_"+o.now()},e=this.drawingFactory.createDrawing(t);e.notSaved=!0,e.init(!0),e.activate(),c.currentPointIndex=0}},{key:"updateDrawing",value:function(t){c.drawing.update(c.currentPointIndex,t.chartX,t.chartY)}},{key:"saveDrawing",value:function(t){t&&c.drawing.notSaved||(c.drawing&&c.drawing.notSaved&&(this.drawings.push(c.drawing),delete c.drawing.notSaved,this.drawingSettingsBar.render()),this.options=o.uniq(o.pluck(this.drawings,"options").concat(this.filterDrawings(this.options,this.start,!0)),"id"),o.isFunction(this.onSave)&&this.onSave(this.options))}},{key:"clearDrawings",value:function(){this.setActiveDrawing(null),o.each(this.drawings,(function(t){return t.destroy()})),this.drawings=[],this.options=[],o.isFunction(this.onSave)&&this.onSave(this.options)}},{key:"addEvent",value:function(e,i){var n=this;t.removeEvent(e),c.handlers[e]={remove:r.addEvent(this.chart.container,e,(function(t){t=n.normalize(t),n.isInsideAxis(t)&&i(t)}))}}},{key:"normalize",value:function(t){return(t=t||window.event).chartX&&t.chartY?t:this.chart.pointer.normalize(t)}},{key:"isInsideAxis",value:function(t){return t.chartX>=this.yAxis.left&&t.chartY>=this.yAxis.top&&t.chartX<=this.yAxis.left+this.yAxis.width&&t.chartY<=this.yAxis.top+this.yAxis.height}},{key:"removeActiveDrawing",value:function(){if(c.drawing){var t=c.drawing;t.deactivate(),t.destroy();var e=this.drawings.indexOf(t);e>=0&&(this.drawings.splice(e,1),this.saveDrawing())}}},{key:"getActiveDrawing",value:function(){return c.drawing}},{key:"addKeyboardListener",value:function(t,e,i){var n=function(i){(i=i||window.event).keyCode===t&&e()};return document.addEventListener("keydown",n,i||!1),{remove:function(){return document.removeEventListener("keydown",n)}}}},{key:"initDrawingSettings",value:function(){this.removeActiveDrawingHandler=this.addKeyboardListener(d,this.removeActiveDrawing.bind(this)),this.drawingSettingsBar=new h({chartDrawing:this,parent:this.chart.container}),this.drawingSettingsBar.hide()}},{key:"isDrawingEditingEnabled",value:function(){return c.enabled}},{key:"applySettings",value:function(t){o.each(this.drawings,(function(e){return e.applySettings&&e.applySettings(t)}))}}],[{key:"removeEvent",value:function(t){if(c.handlers[t]){if(!o.isFunction(c.handlers[t].remove))throw new Error('Handler for "'+t+'" is not a function');c.handlers[t].remove(),delete c.handlers[t]}}}]),t}();n.exports=f}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2438:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(1),r=i(2208),a={id:null,keyPoints:[],type:"line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},l=function(t){function e(t,i,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){var e=void 0;switch(t){case 1:break;case 2:e=this.initPath(),this.$element.attr({d:e}),this.$hoverElement.attr({d:e})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),o.each(this.$points,(function(e){return e.setColor(t)}))}},{key:"defaults",get:function(){return o.extend(function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:2})}},{key:"fxclientOptions",get:function(){return a}}]),e}(r);n.exports=l}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2439:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(1),r=i(2208),a={id:null,keyPoints:[],type:"horizontal_line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},defaultKeyPoint:{shape:"none"},activeKeyPoint:{shape:"none"},addingKeyPoint:{shape:"none"},style:{extendLeft:!0,extendRight:!0}},data:{}},l=function(t){function e(t,i,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$points=this.createPoints(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(){switch(this.options.keyPoints.length){case 1:var t=this.initPath();this.$element.attr({d:t}),this.$hoverElement.attr({d:t})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",0,this.$points[0].y,"L",this.yAxis.width,this.$points[0].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),o.each(this.$points,(function(e){return e.setColor(t)}))}},{key:"defaults",get:function(){return o.extend(function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:1})}},{key:"fxclientOptions",get:function(){return a}}]),e}(r);n.exports=l}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2440:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(1),r=i(2208),a={id:null,keyPoints:[],type:"vertical_line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},defaultKeyPoint:{shape:"none"},activeKeyPoint:{shape:"none"},addingKeyPoint:{shape:"none"}},data:{}},l=function(t){function e(t,i,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$points=this.createPoints(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){switch(t){case 1:var e=this.initPath();this.$element.attr({d:e}),this.$hoverElement.attr({d:e})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,0,"L",this.$points[0].x,this.yAxis.height]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),o.each(this.$points,(function(e){return e.setColor(t)}))}},{key:"defaults",get:function(){return o.extend(function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:1})}},{key:"fxclientOptions",get:function(){return a}}]),e}(r);n.exports=l}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2441:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(1),r=i(2208),a=i(2285),l={id:null,keyPoints:[],type:"trend_channel",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},h=function(t){function e(t,i,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$filledArea=this.createFilledArea(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints(),this.hidden={}}},{key:"_update",value:function(t,i){if(2===t){var n=e.parallelogram(this.$points[0],this.$points[1],i);i.setPixels((n[2].x+n[3].x)/2,(n[2].y+n[3].y)/2)}}},{key:"_move",value:function(t,i,n,s){if(!o.isUndefined(s))if(2!==s.index&&null!==this.hidden.height){var r=(this.$points[0].x+this.$points[1].x)/2,a=(this.$points[0].y+this.$points[1].y)/2;a+=this.hidden.height,this.$points[2].setPixels(r,a),this.$points[2].convert(!0)}else{var l=e.parallelogram(this.$points[0],this.$points[1],this.$points[2]);this.hidden.height=l[3].y-l[0].y,this.$points[2].setPixels((l[2].x+l[3].x)/2,(l[2].y+l[3].y)/2)}}},{key:"_render",value:function(t){var i=void 0;switch(t){case 1:break;case 2:i=["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y],this.$element.attr({d:i}),this.$hoverElement.attr({d:i});break;case 3:var n=e.parallelogram(this.$points[0],this.$points[1],this.$points[2]);this.hidden.height=n[3].y-n[0].y,this.$filledArea.attr({d:["M",n[0].x,n[0].y,"L",n[1].x,n[1].y,"L",n[2].x,n[2].y,"L",n[3].x,n[3].y]}),i=["M",n[0].x,n[0].y,"L",n[1].x,n[1].y,"M",n[2].x,n[2].y,"L",n[3].x,n[3].y],this.$element.attr({d:i}),this.$hoverElement.attr({d:i})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),this.$filledArea.attr({fill:t}),o.each(this.$points,(function(e){return e.setColor(t)}))}},{key:"defaults",get:function(){return o.extend(function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:3})}},{key:"fxclientOptions",get:function(){return l}}],[{key:"parallelogram",value:function(t,e,i){var n=new a(e.x-t.x,e.y-t.y),o=new a(i.x-t.x,i.y-t.y),s=o.x*n.y-o.y*n.x;if(Math.abs(n.x)<.1)return[t,e,t,e];var r=s/n.x;return[t,e,new a(e.x,e.y-r),new a(t.x,t.y-r)]}}]),e}(r);n.exports=h}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2442:function(t,e,i){(function(n){var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(o=function(t,e,n){var o=i(1),r=i(2208),a=[0,.236,.382,.5,.618,.764,1,1.618,2.618,3.618,4.236],l={id:null,keyPoints:[],type:"line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},h=function(t){function e(t,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n));return o.precision=t.options.tooltip.valueDecimals,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$levels=[];for(var t=0;t<a.length;t++)this.$levels.push({$levelLine:this.createLine(),$priceLabel:this.createLabel(),$coefLabel:this.createLabel()});this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){var e=void 0;switch(t){case 1:break;case 2:var i=this.$points[0].x<this.$points[1].x?0:1,n=1-i,o=this.$points[i],s=this.$points[n];if(o===s)return;o.convert(!0),s.convert(!0);for(var r=o.y-s.y,l=0;l<this.$levels.length;l++){var h=this.$levels[l],c=s.y+r*a[l],u=s.value+(o.value-s.value)*a[l];h.$levelLine.attr({d:["M",o.x,c,"L",s.x,c]}),h.$priceLabel.attr({text:u.toFixed(this.precision)}),h.$priceLabel.attr({x:s.x-this.$levels[l].$priceLabel.width,y:c+2}),h.$coefLabel.attr({text:a[l].toFixed(3),x:o.x,y:c+2})}e=this.initPath(),this.$element.attr({d:e}),this.$hoverElement.attr({d:e})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),o.each(this.$levels,(function(e){return e.$levelLine.attr({stroke:t})})),o.each(this.$points,(function(e){return e.setColor(t)}))}},{key:"defaults",get:function(){return o.extend(function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:2})}},{key:"fxclientOptions",get:function(){return l}}]),e}(r);n.exports=h}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2443:function(t,e,i){(function(n,o){var s,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0};function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}void 0===(s=function(t,e,n){var o=i(1),s=i(16),h=i(2208),c=i(2286),u={id:null,keyPoints:[],type:"text",properties:{line:{lineColor:"#a3c4e3",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"},text:{textFill:"rgba(255, 255, 255, 1)",textBg:"transparent",textSize:"11px",backgroundOffsetWidth:7,backgroundOffsetHeight:5}},data:{text:""}},d=function(t){function e(t,i,n){return l(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"_init",value:function(){var t=this;this.$container=this.createG(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$text=this.createText({text:this.prepareSvgText(this.options.data.text)}),this.$points=this.createPoints(),this.$text.on("mousedown",(function(e){e.stopImmediatePropagation(),t.activate()})),this.$text.on("dblclick",(function(e){e.stopImmediatePropagation(),t.activate(),new c(t)}))}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){this.$textNoteInput&&this.$textNoteInput.updatePosition(t,e,i,n)}},{key:"_isFinished",value:function(t){return this.waitForText(t),!1}},{key:"prepareSvgText",value:function(t){return o.isString(t)?t.replace(/\n/g,"<br/>"):null}},{key:"waitForText",value:function(t){t?this.$textNoteInput||(this.$textNoteInput=new e.Input(t,this)):new c(this)}},{key:"save",value:function(t){if(o.isObject(t)||o.isString(t)){if(o.isObject(t))this.options.properties.text.textSize=t["font-size"]+"px",this.options.data.text=t["text-note"];else{if(!o.isString(t))return;this.options.data.text=t,this.$textNoteInput&&(this.$textNoteInput.remove(),delete this.$textNoteInput)}o.isString(this.options.data.text)&&this.options.data.text.trim()?(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"finalize",this).call(this,!0),this.$text.attr({text:this.prepareSvgText(this.options.data.text)}).css({fontSize:parseInt(this.options.properties.text.textSize)+"px"}),this._render(this.$points.length)):(this.remove(),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"finalize",this).call(this,!1))}else a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"save",this).call(this)}},{key:"_render",value:function(t){switch(t){case 1:var e=this.$points[0].x;this.$points[0].x+this.$text.getBBox().width>this.yAxis.width&&(e-=this.$text.getBBox().width);var i=this.$points[0].y;this.$text.attr({x:e,y:i});var n=["M",e,i,"h",this.$text.getBBox().width,"v",this.$text.getBBox().height,"h",-this.$text.getBBox().width,"Z"];this.$hoverElement.attr({d:n})}}},{key:"_destroy",value:function(){this.$textNoteInput&&this.$textNoteInput.remove(),this.$container.destroy()}},{key:"_setColor",value:function(t){this.$text.attr({fill:this.getFillColor(t)}),this.$text.attr({stroke:t}),o.each(this.$points,(function(e){return e.setColor(t)}))}},{key:"getFillColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getColor();return"#a3c4e3"===t?"rgba(239, 247, 254)":h.lightenDarkenColor(t,75)}},{key:"defaults",get:function(){return o.extend(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:1})}},{key:"fxclientOptions",get:function(){return u}},{key:"configurableOptions",get:function(){return[{name:"font-size",title:__("chart_drawings.settings.text_size"),type:"select",options:["10","11","12","13","14","15","16"],value:parseInt(this.options.properties.text.textSize)},{name:"text-note",title:__("chart_drawings.settings.text_note"),type:"textarea",value:this.options.data.text}]}}]),e}(h);d.Input=function(){function t(e,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{text:"",fontSize:"11px"};l(this,t),this.xAxis=i.xAxis,this.position=o.pick(e,"clientX","clientY","chartX","chartY"),this.onSaveCallback=i.save.bind(i),this.$container=s("<div>",{class:"text-note-area"}).css({fontSize:r.fontSize,top:this.position.clientY+"px",left:this.position.clientX+"px"}).appendTo(document.body),this.$textarea=s("<textarea>",{maxlength:"100","white-space":"pre"}).val(r.text).appendTo(this.$container),this.$textarea[0].focus(),this.updateSize(),this.$textarea.on("change drop keydown paste cut",this.onChange.bind(this)),setTimeout((function(){var t=[n.$textarea[0],n.$container[0],i.$points[0].$svg.element];n.outsideClickHandler=function(e){t.indexOf(e.target)<0&&n.applyText()},document.body.addEventListener("mousedown",n.outsideClickHandler,!0)}),1)}return r(t,[{key:"updateSize",value:function(){this.$textarea.css("width","0px"),this.$textarea.css("height","0px");var t=Math.max(50,this.$textarea[0].scrollWidth);this.$textarea.css("width",t+"px");var e=Math.max(10,this.$textarea[0].scrollHeight);return this.$textarea.css("height",e+"px"),{width:t,height:e}}},{key:"updatePosition",value:function(t,e,i){this.$container.css({display:t?"block":"none",top:parseInt(this.$container.css("top"))+i+"px",left:parseInt(this.$container.css("left"))+e+"px"}),this.position.clientX+=e,this.position.clientY+=i,this.position.chartX+=e,this.position.chartY+=i,t&&(this.$textarea[0].focus(),this.render())}},{key:"applyText",value:function(){this.onSaveCallback(this.$textarea.val())}},{key:"remove",value:function(){document.body.removeEventListener("mousedown",this.outsideClickHandler,!0),this.$container.remove(),delete this.$container}},{key:"render",value:function(){if(this.$container){this.updateSize();var t=parseInt(this.$container.css("width"));this.$container.css("left",this.position.clientX-(this.position.chartX+t>this.xAxis.width?t:0)+"px")}}},{key:"onChange",value:function(t){var e=this;t&&(t.ctrlKey&&13===t.keyCode||27===t.keyCode)?this.applyText():setTimeout((function(){return e.render()}),0)}}]),t}(),n.exports=d}.call(e,i,e,t))||(t.exports=s)}).call(this,i(1),i(16))},2444:function(t,e){t.exports="<div class=drawing-settings-panel> <div class=drawing-settings-form> </div> <div class=drawing-settings-footer> <div class=action-buttons> <button class=\"btn btn-primary fn-save\"><%=__('actions.save')%></button> <button class=\"btn fn-cancel\"><%=__('actions.cancel')%></button> </div> </div> </div> "},2445:function(t,e,i){var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=i(16),s=i(2208),r=i(1),a=i(6),l=i(2287),h=r.template('\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.start\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= start%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.end\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= end%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.high\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= high%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.low\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= low%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.difference\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= difference%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.candles\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= candles%></span>\n'),c=0,u=4,d=1,p={id:null,keyPoints:[],type:"measurer",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},f=function(t){function e(t,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n));return o.precision=t.options.tooltip.valueDecimals,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),n(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$filledArea=this.createFilledArea(),this.$filledArea.attr({"fill-opacity":"0.1","stroke-width":1,stroke:this.getColor(),dashstyle:l.DASH}),this.$label=this.createLabel({shape:"callout",className:"measurer-label"}).attr({align:"left",fill:this.chartDrawing.chart.options.chart.backgroundColor,stroke:"#919292","stroke-width":1,padding:4,r:0}).css({color:this.chartDrawing.chart.options.xAxis[0].labels.style.color}),this.$element=this.createLine(),this.$gridElement=this.createLine().attr({dashstyle:l.DOT}),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){switch(t){case 1:break;case 2:var i=this.$points[0].x<this.$points[1].x?0:1,n=1-i,s=this.$points[i],l=this.$points[n];if(s===l)return;s.convert(!0),l.convert(!0);var c=s.value-l.value,u=100*c/s.value,d=this.getCandlesCount(s,l),p=this.getHighAndLow(s,l),f=p.high,g=p.low;this.$label.attr({text:h({start:a(s.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+s.value.toFixed(this.precision),end:a(l.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+l.value.toFixed(this.precision),high:a(f.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+f.value.toFixed(this.precision),low:a(g.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+g.value.toFixed(this.precision),difference:c.toFixed(this.precision)+" ("+u.toFixed(2)+"%)",candles:d})});var v=this.$label.text.element.getBBox().width;r.each(o(this.$label.element).find(".ml-val"),(function(t){t.getAttribute("x")||(t.setAttribute("x",v),t.removeAttribute("dx"))})),this.$label.attr(e.getLabelPosition(this.$label,this.yAxis,s,l)),this.$element.attr({d:this.initPath()}),this.$filledArea.attr({d:["M",s.x,s.y,"L",l.x,s.y,"L",l.x,l.y,"L",s.x,l.y,"Z"]}),this.$gridElement.attr({d:["M",0,s.y,"L",s.x,s.y,"L",s.x,0,"M",l.x,0,"L",l.x,s.y,"L",this.yAxis.width,s.y,"M",this.yAxis.width,l.y,"L",l.x,l.y,"L",l.x,this.yAxis.height,"M",s.x,this.yAxis.height,"L",s.x,l.y,"L",0,l.y,"M",(s.x+l.x)/2,s.y,"L",(s.x+l.x)/2,l.y,"M",s.x,(s.y+l.y)/2,"L",l.x,(s.y+l.y)/2]}),this.$hoverElement.attr({d:["M",s.x,s.y,"L",l.x,s.y,"L",l.x,l.y,"L",s.x,l.y,"L",s.x,s.y,"L",l.x,s.y,"M",s.x,s.y,"L",l.x,l.y]})}}},{key:"getCandlesCount",value:function(t,e){var i=r.union.apply(this,r.map(this.xAxis.series,(function(t){return t.xData})));return r.sortedIndex(i,e.timestamp)-r.sortedIndex(i,t.timestamp)}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),this.$filledArea.attr({fill:t,stroke:t}),this.$gridElement.attr({stroke:t}),r.each(this.$points,(function(e){return e.setColor(t)}))}},{key:"applySettings",value:function(t){this.$label&&this.$label.attr({fill:t.colors.common.background}).css({color:t.colors.common.foreground})}},{key:"getHighAndLow",value:function(t,e){var i={value:0,timestamp:null},n={value:1e10,timestamp:null};return r.each(this.xAxis.chart.series[0].options.data,(function(o){var s=o[c];if(s>=t.timestamp&&s<=e.timestamp){var r=o[u]||o[d];r>i.value&&(i.value=r,i.timestamp=s),r<n.value&&(n.value=r,n.timestamp=s)}})),{high:i,low:n}}},{key:"fxclientOptions",get:function(){return p}},{key:"defaults",get:function(){return r.extend(function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:2})}}],[{key:"getLabelPosition",value:function(t,e,i,n){var o=t.height,s=t.width,r=e.height,a=e.width,l={min:{x:Math.min(i.x,n.x),y:Math.min(i.y,n.y)},max:{x:Math.max(i.x,n.x),y:Math.max(i.y,n.y)},middle:{x:(i.x+n.x)/2,y:(i.y+n.y)/2}},h=l.min.y-7-o,c=l.max.y+7+o,u=l.min.x-7-s,d=l.max.x+7+s;switch(!0){case r>c:return{x:l.middle.x-s/2,y:l.max.y+7,anchorX:l.middle.x,anchorY:l.max.y};case h>0:return{x:l.middle.x-s/2,y:l.min.y-o-7,anchorX:l.middle.x,anchorY:l.min.y};case u>0:return{x:l.min.x-s-7,y:l.middle.y-o/2,anchorX:l.min.x,anchorY:l.middle.y};case a>d:return{x:l.max.x+7,y:l.middle.y-o/2,anchorX:l.max.x,anchorY:l.middle.y};default:return{x:-s,y:-o,anchorX:-7,anchorY:-7}}}}]),e}(s);t.exports=f},2446:function(t,e,i){(function(n,o){var s;void 0===(s=function(t,e,n){var o=i(1),s=i(16),r=(i(7),i(2229)),a=i(696),l=i(2286);n.exports=r.extend({className:"floating-drawing-settings",template:o.template(i(2447)),events:function(){return o.extend({},o.result(r.prototype,"events"),{"click .fn-drawing-remove":"removeDrawing","click .fn-drawing-settings":"showDrawingSettings"})},onMouseDown:function(t){r.prototype.onMouseDown.apply(this,arguments),t.stopPropagation()},onMouseUp:function(t){r.prototype.onMouseUp.apply(this,arguments)},onMouseMove:function(t){r.prototype.onMouseMove.apply(this,arguments),this.isDragReady&&t.stopPropagation()},initialize:function(t){this.chartDrawing=t.chartDrawing,r.prototype.initialize.apply(this,arguments),s(this.parent).append(this.el)},removeDrawing:function(){this.chartDrawing.removeActiveDrawing()},showDrawingSettings:function(){return new l(this.chartDrawing.getActiveDrawing())},hide:function(){this.$el.css({display:"none"})},show:function(){this.render(),this.$el.css({display:"block"})},render:function(){this.options.settingsAvailable=!1,this.options.colorAvailable=!1;var t=this.options.chartDrawing.getActiveDrawing();if(t&&!t.notSaved&&(this.options.settingsAvailable=t.configurableOptions&&t.configurableOptions.length>0,this.options.colorAvailable=t.getColor&&t.getColor()),r.prototype.render.call(this),this.options.colorAvailable){var e=new a({el:this.$el.find(".drawing-color")[0],value:t.getColor(),container:this.$el});this.listenTo(e,"change",(function(e,i){return t.setColor(i)}))}},resetPosition:function(){this.$el.css({top:"",bottom:"",left:"",right:""})}})}.call(e,i,e,t))||(t.exports=s)}).call(this,i(1),i(16))},2447:function(t,e){t.exports='<div class=floating-drawing-settings-container> <div class="separator dots-separator"></div> <% if (settingsAvailable) {%> <div class="icon icon-settings drawing-settings fn-drawing-settings"></div> <%}%> <% if (colorAvailable) {%> <div class=drawing-color></div> <%}%> <div class="icon icon-recycle-blue drawing-remove fn-drawing-remove"></div> </div> '},2448:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(n=function(t,e,n){var s=i(2212),r={color:"#38424b",dashstyle:s.DASH_STYLES.SOLID,showRateLabel:!0},a=function(t){function e(t,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"defaults",get:function(){return r}}]),e}(s);n.exports=a}.call(e,i,e,t))||(t.exports=n)},2449:function(t,e,i){t.exports=i.p+"images/64f113f33482.png"},2450:function(t,e,i){t.exports=i.p+"images/e55d8022bf98.png"},2451:function(t,e,i){t.exports=i.p+"images/673da6b1b7fa.png"},2452:function(t,e,i){t.exports=i.p+"images/abf4f0300532.png"},2453:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(n=function(t,e,n){var s=i(2212),r={color:"#de67a7",dashstyle:s.DASH_STYLES.SOLID,showRateLabel:!0},a=function(t){function e(t,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"defaults",get:function(){return r}}]),e}(s);n.exports=a}.call(e,i,e,t))||(t.exports=n)},2454:function(t,e,i){var n,o=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(n=function(t,e,n){i(1);var r=i(7),a=i(2212),l=i(2455),h=i(2456),c=i(2213),u={color:"#2e86ab",dashstyle:a.DASH_STYLES.SOLID,handleEvents:!0,infoLabelKey:"chart.line.open",infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showProfitLossLabel:!0,showRateLabel:!1,showTpslButton:!0},d=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.updateTplsButtonVisibility(),n.onInstrumentStatusChange(),n.updateRate(n.options.position.getCostBasis()),n.updatePl(n.options.position.getPLOpen()||0),n.listenTo(n.options.instrument,"change:closable change:editable",n.onInstrumentStatusChange.bind(n)),n.listenTo(n.options.position,"change:plOpen",(function(t,e){return n.updatePl(e)})),n.listenTo(n.options.position,"change:takeProfit",n.onTakeProfitChange.bind(n)),n.listenTo(n.options.position,"change:stopLoss",n.onStopLossChange.bind(n)),n.listenTo(n.options.position,"remove",n.destroy.bind(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"defaults",get:function(){return u}}]),s(e,[{key:"exportTo",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"exportTo",this).call(this,t),this.tpRateLine&&this.tpRateLine.exportTo(t),this.slRateLine&&this.slRateLine.exportTo(t)}},{key:"updateTplsButtonVisibility",value:function(){this.options.position.getTakeProfit()||this.options.position.getStopLoss()?this.$tpslButton.show(!0):this.tpRateLine||this.slRateLine||(this.$tpslButton.hide(),this.$tpslButton.enable(),this.tpslEnabled=!1)}},{key:"destroy",value:function(){this.destroyTPRateLine(),this.destroySLRateLine(),this.editPositionModel&&(this.editPositionModel.destroy(),this.editPositionModel=null),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"onEditButtonCLick",value:function(){r.trigger("ui:edit-position",this.options.position,!0)}},{key:"onCloseButtonClick",value:function(){r.trigger("ui:close-position",this.options.position)}},{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isClosable()?this.$closeButton.enable():this.$closeButton.disable()}},{key:"onTpslButtonClick",value:function(){this.tpslEnabled?(this.editPositionModel.destroy(),this.editPositionModel=null,this.destroyTPRateLine(),this.destroySLRateLine(),this.$tpslButton.enable()):(this.editPositionModel=c.createEditPositionModel(this.options.position,this.options.instrument),this.options.position.getTakeProfit()&&this.createTPRateLine(),this.options.position.getStopLoss()&&this.createSLRateLine(),this.$tpslButton.press()),this.tpslEnabled=!this.tpslEnabled}},{key:"onTakeProfitChange",value:function(){this.tpslEnabled&&(this.options.position.getTakeProfit()?this.tpRateLine?this.tpRateLine.updateRate(this.options.position.getTakeProfit().fixedPrice):this.createTPRateLine():this.destroyTPRateLine()),this.updateTplsButtonVisibility()}},{key:"onStopLossChange",value:function(){this.tpslEnabled&&(this.options.position.getStopLoss()?this.slRateLine?this.slRateLine.updateRate(this.options.position.getStopLoss().fixedPrice):this.createSLRateLine():this.destroySLRateLine()),this.updateTplsButtonVisibility()}},{key:"createSLRateLine",value:function(){this.slRateLine=new h(this.chart,{editPositionModel:this.editPositionModel,position:this.options.position,instrument:this.options.instrument})}},{key:"createTPRateLine",value:function(){this.tpRateLine=new l(this.chart,{editPositionModel:this.editPositionModel,position:this.options.position,instrument:this.options.instrument})}},{key:"destroySLRateLine",value:function(){this.slRateLine&&(this.slRateLine.destroy(),this.slRateLine=null)}},{key:"destroyTPRateLine",value:function(){this.tpRateLine&&(this.tpRateLine.destroy(),this.tpRateLine=null)}},{key:"applySettings",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"applySettings",this).call(this,t),this.slRateLine&&this.slRateLine.applySettings(t),this.tpRateLine&&this.tpRateLine.applySettings(t)}}]),e}(a);n.exports=d}.call(e,i,e,t))||(t.exports=n)},2455:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0};void 0===(n=function(t,e,n){i(1);var r=i(7),a=i(2288),l=i(2213),h=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.editPositionModel=n.options.editPositionModel,n.updateRate(n.options.position.getTakeProfit().fixedPrice),n.updatePl(n.editPositionModel.getProfit()),l.initEditing(n,n.editPositionModel,!0,{onChangeProfitForTakeProfit:function(){n.updatePl(n.editPositionModel.getProfit())},onChangeRate:n.updateDragAndDropRange.bind(n)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"onEditButtonCLick",value:function(){r.trigger("ui:edit-position",this.options.position,!0)}},{key:"onCloseButtonClick",value:function(){l.removePositionTakeProfit(this.editPositionModel)}},{key:"onDrop",value:function(){return l.updatePositionTakeProfit(this.editPositionModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editPositionModel;return e.isBuy()?t.min=e.getValidationValueForProfit():t.max=e.getValidationValueForProfit(),t}},{key:"onRateUpdated",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editPositionModel.setTakeProfit(this.rate)}},{key:"destroy",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),l.stopEditing(this,this.editPositionModel,!0)}}]),e}(a);n.exports=h}.call(e,i,e,t))||(t.exports=n)},2456:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0};void 0===(n=function(t,e,n){i(1);var r=i(7),a=i(10),l=i(2289),h=i(2213),c=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.editPositionModel=n.options.editPositionModel,n.updateRate(n.options.position.getStopLoss().fixedPrice),n.updatePl(-n.editPositionModel.getLoss()),h.initEditing(n,n.editPositionModel,!0,{onChangeLossForStopLoss:function(){n.updatePl(-n.editPositionModel.getLoss())},onChangeRate:n.updateDragAndDropRange.bind(n)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"onEditButtonCLick",value:function(){r.trigger("ui:edit-position",this.options.position,!0)}},{key:"onCloseButtonClick",value:function(){h.removePositionStopLoss(this.editPositionModel)}},{key:"onDrop",value:function(){return h.updatePositionStopLoss(this.editPositionModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editPositionModel;return e.isBuy()?(t.max=e.getValidationValueForLoss(),a.isGuaranteedStopLossEnabled()&&(t.min=e.getGSLLimit())):(t.min=e.getValidationValueForLoss(),a.isGuaranteedStopLossEnabled()&&(t.max=e.getGSLLimit())),t}},{key:"onRateUpdated",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editPositionModel.setStopLoss(this.rate)}},{key:"destroy",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),h.stopEditing(this,this.editPositionModel,!0)}}]),e}(l);n.exports=c}.call(e,i,e,t))||(t.exports=n)},2457:function(t,e,i){var n,o=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0===(n=function(t,e,n){i(1);var r=i(7),a=i(2212),l=i(2458),h=i(2459),c=i(2213),u={color:"#7a43b0",dashstyle:a.DASH_STYLES.SOLID,draggable:!0,handleEvents:!0,infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showRateLabel:!1,showTpslButton:!0},d=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i.infoLabelKey="chart.line.order."+i.order.getType().toLowerCase();var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.updateTplsButtonVisibility(),n.onInstrumentStatusChange(),n.editOrderModel=c.createEditOrderModel(n.options.order,n.options.instrument),n.updateRate(n.options.order.getPrice()),c.initEditing(n,n.editOrderModel,!1,{onChangeProfitForTakeProfit:function(){n.updatePl(n.editOrderModel.getProfit())},onChangeRate:n.updateDragAndDropRange.bind(n)}),n.listenTo(n.options.instrument,"change:closable change:editable",n.onInstrumentStatusChange.bind(n)),n.listenTo(n.options.order,"change:stopLimitPrice change:modifiedTime",n.onPriceChange.bind(n)),n.listenTo(n.options.order,"change:takeProfit",n.onTakeProfitChange.bind(n)),n.listenTo(n.options.order,"change:stopLoss",n.onStopLossChange.bind(n)),n.listenTo(n.options.order,"change:quantity",n.onQuantityChange.bind(n)),n.listenTo(n.options.order,"remove",n.destroy.bind(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"defaults",get:function(){return u}}]),s(e,[{key:"destroy",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.destroyTPRateLine(),this.destroySLRateLine(),this.editOrderModel&&(c.stopEditing(this,this.editOrderModel,!0),this.editOrderModel.destroy(),this.editOrderModel=null)}},{key:"onEditButtonCLick",value:function(){r.trigger("ui:edit-order",this.options.order)}},{key:"onCloseButtonClick",value:function(){r.trigger("ui:cancel-order",this.options.order)}},{key:"onTpslButtonClick",value:function(){this.tpslEnabled?(this.destroyTPRateLine(),this.destroySLRateLine(),this.$tpslButton.enable()):(this.options.order.isTakeProfit()&&this.createTPRateLine(),this.options.order.isStopLoss()&&this.createSLRateLine(),this.$tpslButton.press()),this.tpslEnabled=!this.tpslEnabled}},{key:"onRateUpdated",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editOrderModel.setCurrentPrice(this.rate),this.tpRateLine&&this.tpRateLine.updateRate(this.tpRateLine.rate+t),this.slRateLine&&this.slRateLine.updateRate(this.slRateLine.rate+t)}},{key:"onDrop",value:function(t){return this.editOrderModel.getTakeProfit()&&!this.tpRateLine&&this.editOrderModel.setTakeProfit(this.editOrderModel.getTakeProfit()+t),this.editOrderModel.getStopLoss()&&!this.slRateLine&&this.editOrderModel.setStopLoss(this.editOrderModel.getStopLoss()+t),c.updateOrder(this.editOrderModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editOrderModel;return"STOP"===this.options.order.getType()?e.isBuy()?t.min=e.getValidationValueForProfit():(t.max=e.getValidationValueForProfit(),t.min=e.getInstrumentModel().getPrecisionAsFloat()):e.isBuy()?(t.max=e.getValidationValueForLoss(),t.min=e.getInstrumentModel().getPrecisionAsFloat()):t.min=e.getValidationValueForLoss(),t}},{key:"exportTo",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"exportTo",this).call(this,t),this.tpRateLine&&this.tpRateLine.exportTo(t),this.slRateLine&&this.slRateLine.exportTo(t)}},{key:"updateTplsButtonVisibility",value:function(){this.options.order.isTakeProfit()||this.options.order.isStopLoss()?this.$tpslButton.show(!0):this.tpRateLine||this.slRateLine||(this.$tpslButton.hide(),this.$tpslButton.enable(),this.tpslEnabled=!1)}},{key:"onPriceChange",value:function(){this.updateRate(this.options.order.getPrice())}},{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isClosable()?this.$closeButton.enable():this.$closeButton.disable()}},{key:"onQuantityChange",value:function(){this.editOrderModel.setAmount(this.options.order.get("quantity"))}},{key:"onTakeProfitChange",value:function(){this.tpslEnabled&&(this.options.order.isTakeProfit()?this.tpRateLine?this.tpRateLine.updateRate(this.options.order.getTakeProfit()):this.createTPRateLine():this.destroyTPRateLine()),this.updateTplsButtonVisibility()}},{key:"onStopLossChange",value:function(){this.tpslEnabled&&(this.options.order.isStopLoss()?this.slRateLine?this.slRateLine.updateRate(this.options.order.getStopLoss()):this.createSLRateLine():this.destroySLRateLine()),this.updateTplsButtonVisibility()}},{key:"createSLRateLine",value:function(){this.slRateLine=new h(this.chart,{editOrderModel:this.editOrderModel,order:this.options.order,instrument:this.options.instrument})}},{key:"createTPRateLine",value:function(){this.tpRateLine=new l(this.chart,{editOrderModel:this.editOrderModel,order:this.options.order,instrument:this.options.instrument})}},{key:"destroySLRateLine",value:function(){this.slRateLine&&(this.slRateLine.destroy(),this.slRateLine=null)}},{key:"destroyTPRateLine",value:function(){this.tpRateLine&&(this.tpRateLine.destroy(),this.tpRateLine=null)}},{key:"applySettings",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"applySettings",this).call(this,t),this.slRateLine&&this.slRateLine.applySettings(t),this.tpRateLine&&this.tpRateLine.applySettings(t)}}]),e}(a);n.exports=d}.call(e,i,e,t))||(t.exports=n)},2458:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0};void 0===(n=function(t,e,n){i(1);var r=i(7),a=i(2288),l=i(2213),h=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.editOrderModel=i.editOrderModel,n.updateRate(n.options.order.getTakeProfit()),n.updatePl(n.editOrderModel.getProfit()),l.initEditing(n,n.editOrderModel,!0,{onChangeProfitForTakeProfit:function(){n.updatePl(n.editOrderModel.getProfit())}}),n.listenTo(n.options.order,"change:modifiedTime",(function(){n.options.order.isTakeProfit()&&n.updateRate(n.options.order.getTakeProfit())})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"onEditButtonCLick",value:function(){r.trigger("ui:edit-order",this.options.order)}},{key:"onCloseButtonClick",value:function(){l.removeOrderTakeProfit(this.editOrderModel)}},{key:"onDrop",value:function(){return l.updateOrderTakeProfit(this.editOrderModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editOrderModel;return e.isBuy()?t.min=e.getPrice()+e.minOrderDistance(!0):t.max=e.getPrice()-e.minOrderDistance(!0),t}},{key:"onRateUpdated",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editOrderModel.setTakeProfit(this.rate)}},{key:"destroy",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),l.stopEditing(this,this.editOrderModel,!0)}}]),e}(a);n.exports=h}.call(e,i,e,t))||(t.exports=n)},2459:function(t,e,i){var n,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0};void 0===(n=function(t,e,n){i(1);var r=i(7),a=i(2289),l=i(10),h=i(2213),c=function(t){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.editOrderModel=i.editOrderModel,n.updateRate(n.options.order.getStopLoss()),n.updatePl(-n.editOrderModel.getLoss()),h.initEditing(n,n.editOrderModel,!0,{onChangeLossForStopLoss:function(){n.updatePl(-n.editOrderModel.getLoss())}}),n.listenTo(n.options.order,"change:modifiedTime",(function(){n.options.order.isStopLoss()&&n.updateRate(n.options.order.getStopLoss())})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"onEditButtonCLick",value:function(){r.trigger("ui:edit-order",this.options.order)}},{key:"onCloseButtonClick",value:function(){h.removeOrderStopLoss(this.editOrderModel)}},{key:"onDrop",value:function(){return h.updateOrderStopLoss(this.editOrderModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editOrderModel;return e.isBuy()?(t.max=e.getPrice()-e.minOrderDistance(!0),l.isGuaranteedStopLossEnabled()&&(t.min=e.calcClosePrice())):(t.min=e.getPrice()+e.minOrderDistance(!0),l.isGuaranteedStopLossEnabled()&&(t.max=e.calcClosePrice())),t}},{key:"onRateUpdated",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editOrderModel.setStopLoss(this.rate)}},{key:"destroy",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),h.stopEditing(this,this.editOrderModel,!0)}}]),e}(a);n.exports=c}.call(e,i,e,t))||(t.exports=n)},2460:function(t,e,i){var n;void 0===(n=function(t,e,n){n.exports=function(t){t||(t=i(688));var e=t.addEvent,n=t.removeEvent,o=t.createElement,s=t.css,r=t.defined,a=t.doc,l=t.each,h=t.extend,c=t.isMS,u=t.symbolSizes,d=t.merge;t.SVGRenderer.prototype.buttonIcon=function(t,i,n,o,s,r,a,l,u,p,f,g){var v=this.labelIcon(t,i,n,o,s,r,g,null,null,null,null,"button"),y=0;v.attr(d({padding:8,r:2},l));var m,b,w,x,_,k,L,S;return l=d({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},l),m=l.style,delete l.style,_=l.icon,delete l.icon,u=d(l,{fill:"#e6e6e6"},u),b=u.style,delete u.style,k=u.icon,delete u.icon,p=d(l,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},p),w=p.style,delete p.style,L=p.icon,delete p.icon,f=d(l,{fill:"#e0e0e0",style:{color:"#cccccc",cursor:"not-allowed"}},f),x=f.style,delete f.style,S=f.icon,delete f.icon,e(v.element,c?"mouseover":"mouseenter",(function(){3!==y&&v.setState(1)})),e(v.element,c?"mouseout":"mouseleave",(function(){3!==y&&v.setState(y)})),v.setState=function(t){1!==t&&(v.state=y=t),v.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),v.attr([l,u,p,f][t||0]).css([m,b,w,x][t||0]),v.bImage.attr({href:[_,k,L,S][t||0]||o})},v.enable=function(){v.setState(0)},v.press=function(){v.setState(2)},v.disable=function(){v.setState(3)},v.updateNormalState=function(t){l=d(l,t),0===y&&v.attr(t)},v.attr(l).css(h({cursor:"default"},m)),v.on("click",(function(t){3!==y&&a.call(v,t)}))},t.SVGRenderer.prototype.labelIcon=function(e,i,c,p,f,g,v,y,m,b,w,x){var _,k=this,L=k.g("button"!==x&&"label"),S=L.text=k.text("",0,0,b).attr({zIndex:1}),C=void 0,P=L.bImage=k.image(p).attr({zIndex:1}),$=void 0,O=0,T=3,D=0,E=void 0,R=void 0,A=void 0,M=void 0,I=void 0,z={},B=void 0,j=void 0,V=/^url\((.*?)\)$/.test(v),H=V,F=void 0,N=void 0,Y=void 0,U=void 0;x&&L.addClass("highcharts-"+x),H=V,_=function(){return(B||0)%2/2},F=function(){var t=S.element.style,e=void 0,i={},n=(void 0===E||void 0===R||I)&&r(S.textStr)&&S.getBBox(),o=P.getBBox();$={width:(E||n.width||0)+(f||o.width||0)+(n.width&&(f||o.width)?T:0),height:Math.max(R||n.height||0,R||g||o.height||0),x:o.x||n.x,y:o.y||n.y},L.width=$.width+2*T+D,L.height=$.height+2*T,j=(.75*k.fontMetrics(t&&t.fontSize,S).b+L.height)/2,H&&(C||(L.bRect=C=k.symbols[v]||V?k.symbol(v):k.rect(),C.addClass(("button"===x?"":"highcharts-label-box")+(x?" highcharts-"+x+"-box":"")),C.add(L),e=_(),i.x=e,i.y=(w?-j:0)+e),i.width=Math.round(L.width),i.height=Math.round(L.height),C.attr(h(i,z)),z={})},Y=function(){var t,e=P.getBBox(),i=T+D+(e.width?e.width+T:0);t=w?0:j,r(E)&&$&&("center"===I||"right"===I)&&(i+={center:.5,right:1}[I]*(E-$.width)),i===S.x&&t===S.y||(S.attr("x",i),void 0!==t&&S.attr("y",t)),S.x=i,S.y=t},U=function(t,e){C?C.attr(t,e):z[t]=e},N=function(t,e){if(t&&e){var i=$.height-e;F(i/2),Y(),L.attr({visibility:"visible"}),L.attr({y:L.y+i/2})}var n,o=T+D;n=T,r(E)&&$&&("center"===I||"right"===I)&&(o+={center:.5,right:1}[I]*(E-$.width)),o===P.x&&o===P.y||(P.attr("x",o),void 0!==n&&P.attr("y",n)),P.x=o,P.y=n},L.onAdd=function(){S.add(L),P.add(L),f&&g&&P.attr({width:f,height:g}),L.attr({text:e||0===e?e:"",x:i,y:c}),C&&r(y)&&L.attr({anchorX:y,anchorY:m}),f&&g||(L.attr({visibility:"hidden"}),u[p]?N(u[p].width,u[p].height):o("img",{src:p,onload:function(){0===this.width&&(s(this,{position:"absolute",top:"-999em"}),a.body.appendChild(this)),u[p]={width:this.width,height:this.height},this.parentNode&&this.parentNode.removeChild(this),N(this.width,this.height)}}))},L.widthSetter=function(e){E=t.isNumber(e)?e:null},L.heightSetter=function(t){R=t},L["text-alignSetter"]=function(t){I=t},L.paddingSetter=function(t){r(t)&&t!==T&&(T=L.padding=t,Y())},L.paddingLeftSetter=function(t){r(t)&&t!==D&&(D=t,Y())},L.alignSetter=function(t){(t={left:0,center:.5,right:1}[t])!==O&&(O=t,$&&L.attr({x:A}))},L.textSetter=function(t){void 0!==t&&S.textSetter(t),F(),Y(),N()},L["stroke-widthSetter"]=function(t,e){t&&(H=!0),B=this["stroke-width"]=t,U(e,t)},L.strokeSetter=L.fillSetter=L.rSetter=function(t,e){"fill"===e&&t&&(H=!0),U(e,t)},L.anchorXSetter=function(t,e){y=L.anchorX=t,U(e,Math.round(t)-_()-A)},L.anchorYSetter=function(t,e){m=L.anchorY=t,U(e,t-M)},L.xSetter=function(t){L.x=t,O&&(t-=O*((E||$.width)+2*T)),A=Math.round(t),L.attr("translateX",A)},L.ySetter=function(t){M=L.y=Math.round(t),L.attr("translateY",M)};var K=L.css;return h(L,{css:function(t){if(t){var e={};t=d(t),l(L.textProps,(function(i){void 0!==t[i]&&(e[i]=t[i],delete t[i])})),S.css(e)}return K.call(L,t)},getBBox:function(){return{width:$.width+2*T,height:$.height+2*T,x:$.x-T,y:$.y-T}},shadow:function(t){return t&&(F(),C&&C.shadow(t)),L},destroy:function(){n(L.element,"mouseenter"),n(L.element,"mouseleave"),S&&(S=S.destroy()),C&&(C=C.destroy()),P&&(P=P.destroy()),t.SVGElement.prototype.destroy.call(L),L=k=F=Y=U=N=null}})}}}.call(e,i,e,t))||(t.exports=n)},2461:function(t,e,i){var n;function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}void 0===(n=function(t,e,n){var s=["up","none","down"];n.exports=function(t){t||(t=i(688));var e=t.each;t.seriesType("up-down-line","line",{upColor:"#1ecd93",color:"#3d6bb1",downColor:"#ff433d"},{drawGraph:function(){var t,i=this,n=this.options,r=(o(t={},s[0],n.upColor),o(t,s[1],n.color),o(t,s[2],n.downColor),t),a=(this.gappedPath||this.getGraphPath).call(this),l=[["graph","highcharts-graph",n.lineColor||this.color,n.dashStyle,"general"]];e(s,(function(t){return l.push(["updown-graph-"+t,"highcharts-graph highcharts-updown-graph-"+t,r[t]||i.color,n.dashStyle,t])}));var h=function(t){for(var e,i,n={general:t},o={},r=[],a=0,l=s.length;a<l;a++)n[s[a]]=[],o[s[a]]=[];for(var h,c,u,d,p,f,g=1,v=t.xMap.length;g<v;g++)h=t[3*g+1],c=t[3*g+2],u=t[3*g-2],d=t[3*g-1],f!==(p=(e=c)>(i=d)?s[2]:e<i?s[0]:s[1])&&(n[p].push("M",u,d),o[p].push(t.xMap[g-1])),n[p].push("L",h,c),o[p].push(t.xMap[g]),r.push(p),f=p;return n.up.xMap=o.up,n.none.xMap=o.none,n.down.xMap=o.down,{paths:n,directions:r}}(a);e(i.points,(function(t,e){t.color=r[h.directions[e]]||i.color})),e(l,(function(t,e){var o=t[0],s=i[o],r=h.paths[t[4]],a=void 0;s?(s.endX=r.xMap,s.animate({d:r})):r.length&&(i[o]=i.chart.renderer.path(r).addClass(t[1]).attr({zIndex:1}).add(i.group),a={stroke:t[2],"stroke-width":n.lineWidth,fill:i.fillGraph&&i.color||"none"},t[3]?a.dashstyle=t[3]:"square"!==n.linecap&&(a["stroke-linecap"]=a["stroke-linejoin"]="round"),s=i[o].attr(a).shadow(0===e&&n.shadow)),s&&(s.startX=r.xMap,s.isArea=r.isArea)})),this.graph&&this.graph.hide()},setState:function(i){t.Series.prototype.setState.call(this,i);var n=this,o=this.options.states,r=this.options.lineWidth;n.state=i,o[i]&&!1===o[i].enabled||(i&&(r=o[i].lineWidth||r+(o[i].lineWidthPlus||0)),n.graph&&!n.graph.dashstyle&&e(s,(function(t){return n["updown-graph-"+t]&&n["updown-graph-"+t].attr({"stroke-width":r})})))}})}}.call(e,i,e,t))||(t.exports=n)},2462:function(t,e,i){var n;void 0===(n=function(t,e,n){n.exports=function(t){t||(t=i(688)),t.seriesType("heikin-ashi","candlestick",{})}}.call(e,i,e,t))||(t.exports=n)},2463:function(t,e,i){var n;void 0===(n=function(t,e,n){n.exports=function(t){t||(t=i(688)),t.seriesType("comparison","line",{})}}.call(e,i,e,t))||(t.exports=n)},2464:function(t,e,i){var n;void 0===(n=function(t,e,n){var o=i(52);n.exports=o.extend({setChange:function(t){this.set("change",t)},setColor:function(t){this.set("color",t)},setName:function(t){this.set("name",t)},setSubscription:function(t){this.set("subscription",t)},getChange:function(){return this.get("change")},formatChange:function(){return this.get("change")+"%"},getColor:function(){return this.get("color")},getName:function(){return this.get("name")},getSymbol:function(){return this.get("symbol")},getSubscription:function(){return this.get("subscription")}})}.call(e,i,e,t))||(t.exports=n)},2465:function(t,e,i){var n;void 0===(n=function(t,e,n){var o=i(114),s=i(37).default.mobile()?3:4;n.exports=o.extend({full:!1,contains:function(t){return!!this.findWhere({symbol:t})},isFull:function(){return this.full},add:function(t,e){this.isFull()||(o.prototype.add.call(this,t,e),this.length>=s&&(this.trigger("full",!0),this.full=!0))},remove:function(t,e){o.prototype.remove.call(this,t,e),this.isFull()&&(this.trigger("full",!1),this.full=!1)}})}.call(e,i,e,t))||(t.exports=n)},2466:function(t,e,i){var n;void 0===(n=function(t,e,n){var o=i(589),s=i(1216),r=i(348),a=i(901);n.exports=r.extend({show:function(t){var e=this.$el.parent();e.css("display","flex"),t?e.addClass("first-search"):e.hasClass("first-search")&&e.removeClass("first-search"),e.find("input")[0].focus()},hide:function(){this.$el.parent().css("display","none")},initialize:function(){r.prototype.initialize.apply(this,arguments);var t=this.$el.find(".search-block-input input")[0];t.setAttribute("size",t.getAttribute("placeholder").length)},openResults:function(){var t=this;this.grid=o({className:"instruments-table",collection:this.collection,empty:s,shouldHideColumns:!0,source:"search",customRowsComponent:i(1217),customRowComponent:i(1218),columns:[{key:"name",type:a,style:{width:"100%"}}],onRowClick:function(e,i){t.options.onRowClick&&t.options.onRowClick(i.get("symbol")),t.closeResults(),t.hide()}},this.$el.find(".results")[0]),this.$el.find(".results").css("display","block")}})}.call(e,i,e,t))||(t.exports=n)},2467:function(t,e){t.exports="<div class=chart-no-data> <div class=chart-no-data-image></div> <div class=chart-no-data-message><%-__('chart.no_data')%></div> </div>"},2468:function(t,e,i){(function(n){var o;void 0===(o=function(t,e,o){var s=i(0),r=i(20);o.exports=r({displayName:"exports",getDefaultProps:function(){return{mainInstrument:null,comparisonInstruments:null}},getInitialState:function(){return{mainInstrument:this.props.mainInstrument,comparisonInstruments:this.props.comparisonInstruments}},componentDidMount:function(){this.state.mainInstrument.on("change:color change:change",this.update,this),this.state.comparisonInstruments.on("update change:color change:change",this.update,this)},componentWillUnmount:function(){this.state.mainInstrument.off("change:color change:change",this.update,this),this.state.comparisonInstruments.off("update change:color change:change",this.update,this)},update:function(){this.setState({mainInstrument:this.state.mainInstrument,comparisonInstruments:this.state.comparisonInstruments})},removeInstrument:function(t){this.state.comparisonInstruments.remove(t),this.update()},setMainInstrument:function(t){this.state.mainInstrument.off("change:color change:change",this.update,this),t.on("change:color change:change",this.update,this),this.setState({mainInstrument:t})},renderInstrument:function(t,e){var i=this;return s.createElement("div",{className:"ic",key:t.getName()},s.createElement("div",{className:"ic-color",style:{backgroundColor:t.getColor()}}),s.createElement("div",{className:"ic-name"},t.getName()),s.createElement("div",{className:"ic-change"},n.isNumber(t.getChange())?t.formatChange():""),!e&&s.createElement("div",{className:"ic-btn-cancel",title:__("chart.instruments_comparison.remove"),onClick:function(){i.removeInstrument(t)}},s.createElement("i",null)))},render:function(){var t=this;return s.createElement("div",null,this.renderInstrument(this.state.mainInstrument,!0),this.state.comparisonInstruments.map((function(e){return t.renderInstrument(e)})))}})}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2469:function(t,e,i){(function(n,o){var s;void 0===(s=function(t,e,n){var o=i(21),s=i(16),r=i(1),a=i(37).default,l=i(253),h=i(165),c=i(249),u=i(12),d=i(10),p=i(2340),f=i(1210).default,g=i(699),v=i(2284),y=i(1200),m=i(7),b=void 0,w=r.template(i(2470));function x(t,e){var i=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector;if(i)return i.call(t,e)}function _(t,e){for(;t;){if(x(t,e))return t;t=t.parentElement}return null}n.exports=o.extend({className:"chart-toolbar separated",events:function(){return r.extend({},r.result(o.prototype,"events"),{"click .disabled, [disabled]":function(t){return t.stopImmediatePropagation()},"click .fn-change-cursor":"changeCursor","click .fn-change-rate-line":"changeRateLine","click .fn-toolbar-zoom-in":"zoomIn","click .fn-toolbar-zoom-out":"zoomOut","click .fn-toolbar-settings":"showChartSettings","click .fn-toolbar-indicators":"showIndicatorsSettings","click .fn-toolbar-screenshot":"makeScreenshot","click .fn-toolbar-minimize":"minimize","click .fn-toolbar-fullscreen":"fullscreen","click .fn-toolbar-restore-size":"restoreSize","click .fn-toolbar-drawings":"toggleDrawing","click .fn-start-drawing":"startDrawing","click .fn-clear-drawings":"clearDrawings","click .fn-toolbar-add-to-multicharts":"addToMulticharts"})},initialize:function(){b=i(691),o.prototype.initialize.apply(this,arguments),this.hide(),this.render()},enableComparisonMode:function(){this.comparisonMode=!0,this.$el.addClass("comparison"),this.options.chartPanel.enableComparisonMode(this.$rangesSelect.value())},disableComparisonMode:function(){this.comparisonMode=!1,this.$el.removeClass("comparison"),this.options.chartPanel.disableComparisonMode(this.$typesSelect.value(),this.$periodsSelect.value())},show:function(t){var e=this;if(this.isEmbedded())this.$el.css({display:"flex"});else{this.$el.css({display:"flex"});var i=this.options.relatedTo[0].getBoundingClientRect(),n=this.el.getBoundingClientRect(),o="rtl"===s("html").attr("dir");this.$el.css({position:"fixed",visibility:"visible",top:i.top+i.height/2-n.height/2+"px",left:(o?i.left:i.right-n.width)+"px","z-index":6e3}),t||setTimeout((function(){s(window).on("resize.chartToolbar"+e.cid,e.hide.bind(e)),s("body").on("click.chartToolbar"+e.cid,e.onBodyClick.bind(e))}),0)}},onBodyClick:function(t){_(t.target,".chart-toolbar")!==this.el&&this.hide()},isEmbedded:function(){return this.options.embedded},hide:function(){this.isEmbedded()||(s("body").off("click.chartToolbar"+this.cid),s(window).off("resize.chartToolbar"+this.cid),this.$el.css({position:"fixed",top:"-1000px",left:"-1000px",display:"none"}))},renderSearch:function(){var t=this,e=i(348);this.$comparisonSearch=new e({el:this.$el.find(".chart-ic-search"),placeholder:__("chart.instruments_comparison.add"),columns:[{key:"name",type:i(901),style:{width:"100%"}}],onRowClick:function(e,i){t.addComparisonInstrument(i.getSymbol())}})},createSelect:function(t,e,i,n){var o=new c({el:this.$el.find(t),name:e,value:n,options:i,template:h.selectBox,disable:!1,translationKey:"",disableChangeByKeyboard:!0,transformOptionsValue:function(t){return t},transformOptionText:function(t){return t},title:__("wizard.form.label.DEFAULT_EMPTY")});return o.value(n),o},renderRanges:function(){var t=this;this.$rangesSelect=this.createSelect(".ranges","ranges",r.keys(b.getRanges()),this.options.range.toLowerCase()),this.listenTo(this.$rangesSelect,"change",(function(e,i){t.options.chartPanel.onChangeRange(i),t.hide()}))},renderPeriods:function(){var t=this;this.$periodsSelect=this.createSelect(".periods","periods",r.keys(b.getPeriods()),this.options.period.toLowerCase()),this.listenTo(this.$periodsSelect,"change",(function(e,i){t.options.chartPanel.onChangePeriod(i),t.hide()}))},renderTypes:function(){var t=this,e=y.defaultTypes;u.isChartInstrumentsComparisonEnabled()&&(e=e.slice(0)).push(y.comparisonType),this.$typesSelect=new c({el:this.$el.find(".types"),name:"types",options:e,template:h.selectBox,disable:!1,disableChangeByKeyboard:!0,translationKey:"",transformOptionsValue:function(t){return t},transformOptionText:function(t){return'<i title="'+__("chart.toolbar.tooltip.type."+t)+'"></i><span>'+__("chart.toolbar.tooltip.type."+t)+"</span>"},title:__("wizard.form.label.DEFAULT_EMPTY")}),this.$typesSelect.value(this.options.type),this.$typesSelect.$el.find(".dk-selected").data("value",this.options.type),this.$typesSelect.$el.find(".styled-select").data("value",this.options.type),this.listenTo(this.$typesSelect,"change",(function(e,i){t.$typesSelect.$el.find(".dk-selected").data("value",i),t.$typesSelect.$el.find(".styled-select").data("value",i),t.changeType(i)}))},render:function(){this.parent&&s(this.parent).append(this.el),this.isEmbedded()?this.$el.addClass("chart-toolbar-embedded"):this.$el.addClass("chart-toolbar-expanded"),this.$el.html(w({drawings:v.types,cursors:r.pluck(r.filter(y.defaultCursors,"selectable"),"type"),rateLines:y.defaultRateLines,isDesktop:a.desktop(),isNotMobile:!a.mobile(),isEmbedded:this.isEmbedded(),multiChartsEnabled:u.checkMultiChartsEnabled()})),this.renderSearch(),this.renderPeriods(),this.renderRanges(),this.renderTypes(),this.setActiveCursor(this.options.cursor.toLowerCase()),this.setActiveRateLine(this.options.rateLine.toLowerCase()),this.options.comparisonMode&&(this.comparisonMode=!0,this.$el.addClass("comparison")),this.$el.find(".fn-toolbar-add-to-multicharts")&&(this.renderAddToMultichartsButton(),this.listenTo(d.getUserCommonData(),"multicharts:updated",this.renderAddToMultichartsButton.bind(this))),d.getUserCommonData().isAdvancedTradingView()&&this.$el.find(".fn-toolbar-minimize").remove()},addComparisonInstrument:function(t){this.options.chartPanel.addComparisonInstrument(t)},zoomIn:function(){this.options.chartPanel.onZoomIn(),this.hide()},zoomOut:function(){this.options.chartPanel.onZoomOut(),this.hide()},showChartSettings:function(){this.options.chartPanel.onShowChartSettings(),this.hide()},showIndicatorsSettings:function(){this.options.chartPanel.onShowIndicatorsSettings(),this.hide()},startDrawing:function(t){var e=this,i=t.currentTarget.dataset.type;this.setActiveDrawing(i),this.options.chartPanel.startDrawing(i),this.hide(),this.stopDrawingKeyboardEvent||(this.stopDrawingKeyboardEvent=l({escape:function(){return e.stopDrawing()}},this))},stopDrawing:function(){this.stopDrawingKeyboardEvent&&(this.stopDrawingKeyboardEvent.off(),delete this.stopDrawingKeyboardEvent),this.setActiveDrawing(),this.options.chartPanel.stopDrawing(),this.hide()},toggleDrawing:function(t){_(t.target,".fn-start-drawing")||(s(t.currentTarget).hasClass("active")?this.stopDrawing():(t.currentTarget.dataset.type||(t.currentTarget.dataset.type=v.defaultType),this.startDrawing(t)))},clearDrawings:function(){this.stopDrawing(),this.options.chartPanel.clearDrawings()},changeType:function(t){t===y.comparisonType?this.enableComparisonMode():this.comparisonMode?this.disableComparisonMode():this.options.chartPanel.onChangeType(t),this.hide()},changeCursor:function(t){var e=t.currentTarget.dataset.cursor;this.setActiveCursor(e),this.options.chartPanel.onChangeCursor(e),this.hide()},changeRateLine:function(t){var e=t.currentTarget.dataset.rateLine;this.setActiveRateLine(e),this.options.chartPanel.onChangeRateLine(e),this.hide()},makeScreenshot:function(){this.options.chartPanel.makeScreenshot(),this.hide()},minimize:function(){this.options.chartPanel.toggleMinimize(),this.hide(),m.trigger("ui:chart:collapse")},restoreSize:function(){this.setActiveSize(!1),this.options.chartPanel.restoreSize(),this.hide(),m.trigger("ui:chart:expand")},fullscreen:function(){this.setActiveSize(!0),this.options.chartPanel.toggleFullscreen(),this.hide()},setActiveCursor:function(t){this.$el.find(".fn-change-cursor.active").removeClass("active"),t&&this.$el.find('.fn-change-cursor[data-cursor="'+t+'"]').addClass("active")},setActiveRateLine:function(t){this.$el.find(".fn-change-rate-line.active").removeClass("active"),this.$el.find('.fn-change-rate-line[data-rate-line="'+t+'"]').addClass("active")},setActiveType:function(t){this.$el.find(".fn-change-type.active").removeClass("active"),this.$el.find('.fn-change-type[data-type="'+t+'"]').addClass("active")},setActiveDrawing:function(t){this.$el.find(".fn-toolbar-drawings").removeClass("active"),this.$el.find(".fn-start-drawing.active").removeClass("active"),t&&(this.$el.find(".fn-toolbar-drawings").addClass("active"),this.$el.find('.fn-start-drawing[data-type="'+t+'"]').addClass("active"))},setActiveSize:function(t){t?(this.$el.find(".fn-toolbar-fullscreen").css("display","none"),this.$el.find(".fn-toolbar-restore-size").css("display","flex")):(this.$el.find(".fn-toolbar-fullscreen").css("display","flex"),this.$el.find(".fn-toolbar-restore-size").css("display","none"))},destroy:function(){o.prototype.destroy.call(this)},updateComparisonSearch:function(t){t?this.disableComparisonSearch():this.enableComparisonSearch()},disableComparisonSearch:function(){this.$comparisonSearch.disable(),this.$comparisonSearch.setPlaceholder(__("chart.instruments_comparison.max_reached"))},enableComparisonSearch:function(){this.$comparisonSearch.enable(),this.$comparisonSearch.setPlaceholder(__("chart.instruments_comparison.add"))},renderAddToMultichartsButton:function(){f.updateUI();var t=this.$el.find(".fn-toolbar-add-to-multicharts");f.isStatusNew()&&t.find("i").addClass("add-to-multicharts-new"),p.getEmptyMultiChartsPlaceIndex()>=0?(t.removeClass("disabled"),t.attr("title",__("chart.toolbar.tooltip.add_to_multicharts"))):(t.addClass("disabled"),t.attr("title",__("chart.toolbar.tooltip.add_to_multicharts.disabled")))},addToMulticharts:function(){var t=this,e=p.getEmptyMultiChartsPlaceIndex(),i=this.options.chartPanel.getInstrumentSymbol();if(e>=0&&i){var n=d.getUserCommonData().getMultiChartsSettings();p.isLayoutAvailable(n)||d.getUserCommonData().saveMultiChartsSettings({layout:p.DEFAULT}),b.saveMultiChartsSettings(e,"symbol",i).then((function(){t.$el.find(".fn-toolbar-add-to-multicharts").find("i").removeClass("add-to-multicharts-new"),f.add(e),g.show({title:__("tab.multi_charts"),body:__("chart.toolbar.tooltip.add_to_multicharts.message",t.options.chartPanel.instrument.getDisplayName())})}))}}})}.call(e,i,e,t))||(t.exports=s)}).call(this,i(1),i(16))},2470:function(t,e){t.exports='<% if (isEmbedded) {%> <div class=chart-buy-sell> <div class=chart-sell> <table> <tr></tr> </table> </div> <div class=chart-buy> <table> <tr></tr> </table> </div> </div> <% }%> <div class=chart-ic-search></div> <div class=periods></div> <div class=ranges></div> <div class=types></div> <div class=controls> <% if (isNotMobile && isEmbedded && multiChartsEnabled) {%> <div class="btn fn-toolbar-add-to-multicharts chart-toolbar-add-to-multicharts" title="<%=__(\'chart.toolbar.tooltip.add_to_multicharts\')%>"> <i class="add-to-multicharts icon"></i> </div> <% }%> <% if (isDesktop) {%> <div class="btn fn-toolbar-zoom-in chart-toolbar-zoom-in" title="<%=__(\'chart.toolbar.tooltip.zoom_in\')%>"> <i class=icon-chart-zoomin></i> </div> <div class="btn fn-toolbar-zoom-out chart-toolbar-zoom-out" title="<%=__(\'chart.toolbar.tooltip.zoom_out\')%>"> <i class=icon-chart-zoomout></i> </div> <% }%> <div class="btn fn-toolbar-settings chart-toolbar-settings" title="<%=__(\'chart.toolbar.tooltip.chart_settings\')%>"> <i class=icon-chart-settings></i> </div> <div class="btn fn-toolbar-indicators chart-toolbar-indicators" title="<%=__(\'chart.toolbar.tooltip.indicators\')%>"> <i class=icon-indicators></i> </div> <% if (isDesktop && _.size(drawings) > 0) {%> <div class="btn fn-toolbar-drawings chart-toolbar-drawings" title="<%=__(\'chart.toolbar.tooltip.drawing_tools\')%>"> <i class=icon-chart-edit></i> <div class="sub-menu left-side"> <% _.each(drawings, function (drawing,type) {%> <div class="drawing <%-type.replace(/_/g, \'-\')%> fn-start-drawing" data-type="<%-type%>"> <div><%=__(drawing.label)%></div> </div> <% }); %> <div class="drawing clear fn-clear-drawings"> <div><%=__(\'chart_drawings.clear\')%></div> </div> </div> </div> <% }%> <% if (isDesktop && _.size(cursors) > 0) {%> <div class="btn fn-toolbar-cursors chart-toolbar-cursors" title="<%=__(\'chart.toolbar.tooltip.cursors\')%>"> <i class=icon-chart-cursor></i> <div class="sub-menu left-side"> <% _.each(cursors, function (cursor) {%> <div class="cursor <%-cursor%> fn-change-cursor" data-cursor="<%-cursor%>" title="<%=__(\'chart_cursors.\' + cursor)%>"> <div><%=__(\'chart_cursors.\' + cursor)%></div> </div> <% }); %> </div> </div> <% }%> <% if (isDesktop && _.size(rateLines) > 1) {%> <div class="btn fn-toolbar-rate-line chart-toolbar-rate-line" title="<%=__(\'chart.toolbar.tooltip.rate-lines\')%>"> <i class="lines icon"></i> <div class="sub-menu left-side"> <% _.each(rateLines, function (rateLine) {%> <div class="rateLine fn-change-rate-line" data-rate-line="<%-rateLine%>"> <div><%=__(\'chart_rate_lines.\' + rateLine)%></div> </div> <% }); %> </div> </div> <% }%> </div> <div class=sizes> <% if (isDesktop) {%> <div class="btn fn-toolbar-screenshot chart-toolbar-screenshot" title="<%=__(\'chart.toolbar.tooltip.screenshot\')%>"> <i class=icon-chart-screenshot></i></div> <% }%> <% if (isEmbedded) {%> <div class="btn fn-toolbar-minimize chart-toolbar-minimize minimize" title="<%=__(\'chart.toolbar.tooltip.minimize\')%>"><i class=icon-chart-minimize></i></div> <% }%> <div class="btn fn-toolbar-restore-size chart-toolbar-restore-size restore-size" title="<%=__(\'chart.toolbar.tooltip.restore_size\')%>"><i class="restore-size icon"></i> </div> <div class="btn fn-toolbar-fullscreen chart-toolbar-fullscreen fullscreen" title="<%=__(\'chart.toolbar.tooltip.fullscreen\')%>"> <i class=icon-full-chart></i></div> </div> '},2916:function(t,e,i){(function(n,o){var s;void 0===(s=function(t,e,n){var o=i(2435),s=i(16),r=i(1),a=i(7),l=i(76).default,h=i(10),c=i(33),u=i(2917),d=i(1200),p=i(193),f=i(2469),g=i(61).getUiSelectedInstrumentCategorySymbol,v=i(907),y=v.traceBasicChartLoad,m=v.tracePlatformLoad,b=void 0;n.exports=o.extend({className:"chart-panel",events:function(){return r.extend({},r.result(o.prototype,"events"),{"click .fn-chart-minimize":"minimize","click .fn-chart-restore-size":"restore"})},initialize:function(t){var e=this;b=i(691),this.options=r.extend({},t,this.loadLocalChartSettings(),{chartId:"main"});var n=null;!0===h.getApplicationSettings().get("deeplink")&&(h.getApplicationSettings().set("deeplink",!1),n=h.getApplicationSettings().get("chart")),p.isDetected()&&p.get("chart")&&(n=p.get("chart")),n&&r.extend(this.options,{period:n}),o.prototype.initialize.call(this,this.options),this.listenTo(a,"ui:instruments:instrument-selected",this.instrumentRowSelected),this.listenTo(a,"ui:instruments:instrument-subrow-selected",this.instrumentSubrowSelected),this.render(),this.$chartBox=this.$el.parent(),this.$chartSplitterBox=s(".chart-splitter-box"),this.$chartContainer=this.$el.find(".chart-container"),this.$fullscreenNotification=this.$el.find(".chart-fullscreen-notification"),this.tradingCentral=new u({el:this.$el.find(".chart-trading-central")},this.chart),this.initToolbar(),this.chartToolbar.show(),this.$buyButton=this.$el.find(".chart-panel .chart-buy tr")[0],this.$sellButton=this.$el.find(".chart-panel .chart-sell tr")[0],this.options.symbol?(this.onInstrumentSelected(this.options.symbol),delete this.options.symbol):this.instrument&&this.resubscribeChart(),l.mobile()&&l.portrait()&&window.innerHeight<500&&this.minimize(),this.instrumentRowSelected(g(store.getState())),this.comparisonMode&&(this.initComparisonInstruments(),r.each(this.options.comparison,(function(t){var i=c.getInstrumentBySymbol(t);i&&i.isVisible()&&e.addComparisonInstrument(i.getSymbol())})))},minimize:function(){this.toggleMinimize()},restore:function(){this.restoreSize()},getLoadingContainer:function(){return this.$el.parent()},showSearch:function(){this.size.fullscreen&&o.prototype.showSearch.call(this)},initToolbar:function(){this.chartToolbar||(this.chartToolbar=new f({embedded:!0,comparisonMode:this.comparisonMode,parent:this.$el.find(".chart-header"),chartPanel:this,type:this.type,cursor:this.cursor,period:this.period,range:this.range,rateLine:this.rateLine}))},render:function(){this.template=r.template(i(2919)),this.$el.addClass("single"),o.prototype.render.call(this)},instrumentRowSelected:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{openPositionsSelected:!0,ordersSelected:!0,selectedSubRowsIds:[]},n=c.getInstrumentBySymbol(t);n&&this.onInstrumentSelected(t,n,{showTrades:b.getChartSettings().switchers.showTrades,showAllOpenPositions:i.openPositionsSelected,showAllOrders:i.ordersSelected,visibleTradesIds:i.selectedSubRowsIds})},instrumentSubrowSelected:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{openPositionsSelected:!1,ordersSelected:!1,selectedSubRowsIds:[]},n=c.getInstrumentBySymbol(t);n&&this.onInstrumentSelected(t,n,{showTrades:b.getChartSettings().switchers.showTrades,showAllOpenPositions:i.openPositionsSelected,showAllOrders:i.ordersSelected,visibleTradesIds:i.selectedSubRowsIds})},onChangePeriod:function(t){o.prototype.onChangePeriod.apply(this,arguments),this.savePeriod(t)},onChangeRange:function(t){o.prototype.onChangeRange.apply(this,arguments),this.saveRange(t)},enableComparisonMode:function(){var t=this;o.prototype.enableComparisonMode.apply(this,arguments),this.saveType(d.comparisonType),this.saveRange(this.range),this.comparisonMode&&r.each(this.loadLocalChartSettings().comparison,(function(e){var i=c.getInstrumentBySymbol(e);i&&i.isVisible()&&t.addComparisonInstrument(i.getSymbol())}))},disableComparisonMode:function(t,e){o.prototype.disableComparisonMode.apply(this,arguments),this.saveType(t),this.savePeriod(e)},addComparisonInstrument:function(t){o.prototype.addComparisonInstrument.apply(this,arguments),this.comparisonInstruments.contains(t)&&this.saveComparison(t,!0)},removeComparisonInstrument:function(t){o.prototype.removeComparisonInstrument.apply(this,arguments),this.saveComparison(t,!1)},onChangeType:function(t){o.prototype.onChangeType.apply(this,arguments),this.saveType(t)},onChangeRateLine:function(t){o.prototype.onChangeRateLine.apply(this,arguments),this.saveRateLine(t)},onChangeCursor:function(t){o.prototype.onChangeCursor.apply(this,arguments),this.saveCursor(t)},saveLocalChartSettings:function(t,e){var i=this.loadLocalChartSettings();i[t]=e,localStorage.setItem("chart_settings",JSON.stringify(i))},loadLocalChartSettings:function(){var t=localStorage.getItem("chart_settings");return t?JSON.parse(t):{}},saveType:function(t){this.saveLocalChartSettings("type",t)},savePeriod:function(t){this.saveLocalChartSettings("period",t)},saveRange:function(t){this.saveLocalChartSettings("range",t)},saveRateLine:function(t){this.saveLocalChartSettings("rateLine",t)},saveCursor:function(t){this.saveLocalChartSettings("cursor",t)},saveComparison:function(t,e){var i=localStorage.getItem("chart_settings"),n=(i=i?JSON.parse(i):{}).comparison||[],o=n.indexOf(t);e?o<0&&n.push(t):o>=0&&n.splice(o,1),i.comparison=n,localStorage.setItem("chart_settings",JSON.stringify(i))},setSymbol:function(t){this.onInstrumentSelected(t)},resubscribeChart:function(t){this.instrument&&this.chart&&(y.start({onCategoryChange:!t}),o.prototype.resubscribeChart.apply(this,arguments))},onDataLoad:function(t){o.prototype.onDataLoad.apply(this,arguments),y.stop({symbol:this.instrument.getSymbol(),period:this.period}),m.stop()}})}.call(e,i,e,t))||(t.exports=s)}).call(this,i(1),i(16))},2917:function(t,e,i){(function(n){var o;void 0===(o=function(t,e,n){var o=i(21),s=(i(16),i(1)),r=i(7),a=i(11),l=i(37).default,h=(i(6),i(73)),c=i(10),u=i(105),d=i(97),p=i(71).transformSBSymbolToSymbol,f=i(691),g=s.template(i(2918)),v=s.template("<div class='tc-instrument-unavailable'><%=__('trading.central.unavailable.description')%></div>");n.exports=o.extend({events:function(){return s.extend({},s.result(o.prototype,"events"),{"click .fn-resize":"resize"})},minimized:!1,initialize:function(t,e){this.$el.addClass("tc"),this.chart=e,o.prototype.initialize.apply(this,arguments),this.listenTo(r,"stream:type:TRADING_CENTRAL",this._onTCDataReceived)},render:function(){this.$el.html(g(this.data)),this.$el.find(".tc-resistance > span").css("color",this.data.lines[0].colors[0]),this.$el.find(".tc-support > span").css("color",this.data.lines[1].colors[0]),this.$el.find(".tc-pivot > span").css("color",this.data.lines[2].colors[0])},updateChartSize:function(){r.trigger("ui:chart:update-size",-this.height),this.height=this.minimized?0:parseInt(this.$el.css("height")),r.trigger("ui:chart:update-size",this.height)},handleSize:function(){this.minimized?(this.$el.find(".tc-wrapper").css("display","none"),this.$el.find(".tc-button-wrapper").css("display","block")):(this.$el.find(".tc-wrapper").css("display","flex"),this.$el.find(".tc-button-wrapper").css("display","none")),this.updateChartSize()},resize:function(){this.minimized=!this.minimized,this.handleSize(),this.chart.reflow(),this.chart._redrawChart()},_onTCDataReceived:function(t){if(this.symbol===t.symbol&&this.term===t.term){this.loadingTimeout&&clearTimeout(this.loadingTimeout),this.data=s.extend({},c.getUserCommonData().getTradingCentralSettings(),t),this.data.formattedTitle=__("trading.central.preference.title")+" "+__("trading.central.term."+this.data.term.toLowerCase())+" "+(this.data.pivot===this.data.resistance1?__("trading.central.preference.decline"):this.data.pivot===this.data.support1?__("trading.central.preference.rise"):"");var e=u.user;this.data.formattedDate=e.applyOffset(""+t.date+t.hour,"YYYYMMDDHH:mm","DD/MM/YYYY HH:mm")+" ("+e.GMTPostfix()+")",this.render(),this.updateChartSize(),this.handleSize(),this.chart.reflow(),this.chart.updateTradingCentral(this.data)}},_onDataUnavailable:function(){this.loadingView&&this.loadingView.destroy(),this.$el.html(v()),this.chart.reflow()},isTradingCentralEnabled:function(){return l.desktop()&&c.getUserAccountServices().isTradingCentralAvailable()&&c.getUserCommonData().isTradingCentralEnabled()},subscribe:function(t){var e=this,i=t.instrument,n=t.period;this.isTradingCentralEnabled()&&(this.loadingView&&this.loadingView.destroy(),this.loadingView=new d({parent:this.$el,position:"relative",translucent:"2"}),this.chart.reflow(),this.loadingTimeout&&clearTimeout(this.loadingTimeout),this.loadingTimeout=setTimeout(this._onDataUnavailable.bind(this),1e4),a.unsubscribeTradingCentral(h.getAtmosphereId()).then((function(){e.symbol=p(i.getSymbol()),e.term=f.getPeriod(n).seconds<=86400?"INTRADAY":"ST",a.subscribeTradingCentral(h.getAtmosphereId(),e.symbol,e.term)})))},unsubscribe:function(){var t=this;this.clear(),s.isUndefined(this.symbol)||a.unsubscribeTradingCentral(h.getAtmosphereId()).then((function(){return t.symbol=void 0}))},clear:function(){this.$el.empty(),r.trigger("ui:chart:update-size",-this.height),this.height=0,this.chart.reflow()},destroy:function(){o.prototype.destroy.call(this)}})}.call(e,i,e,t))||(t.exports=o)}).call(this,i(1))},2918:function(t,e){t.exports="<div class=tc-wrapper> <div class=tc-info> <div class=tc-header><%=formattedTitle%></div> <div><%=title%></div> <% _.each(paragraphs, function(paragraph){ %> <div><%=paragraph%></div> <% }) %> <div>(<%=formattedDate%>)</div> </div> <div class=tc-legend-full> <div class=tc-header><%=__('trading.central.study.legend')%></div> <div class=tc-resistance><%= __('trading.central.lines.extended.resistance')%></div> <div class=tc-support><%= __('trading.central.lines.extended.support')%></div> <div class=tc-pivot><%= __('trading.central.lines.extended.pivot')%></div> <button class=\"btn btn-default tc-minimize fn-resize\"> <%=__('trading.central.button.minimize')%><i></i> </button> </div> </div> <div class=tc-legend-short> </div> <div class=tc-button-wrapper style=display:none> <button class=\"btn btn-default tc-expand fn-resize\"> <%=__('trading.central.button.expand')%><i></i> </button> </div>"},2919:function(t,e){t.exports='<div class=chart-panel-content> <div class=chart-header> <div class="chart-info-wrapper fn-show-search"> <div class=chart-search-button></div> <div class=chart-info> <div class=chart-title></div> <div class=chart-subtitle></div> </div> <div class=chart-basket> <div class=chart-basket-title></div> <div class=chart-basket-info></div> </div> </div> </div> <div class=chart-instruments-comparison-panel></div> <div class=chart-container></div> <div class="minimize-mobile fn-chart-minimize mobile"><i class=icon-double-arrow-down></i></div> <div class=chart-fullscreen-notification> <%-__(\'chart.fullscreen_notification\')%> </div> <div class=chart-trading-central></div> <div class=chart-search> <div class="chart-search-close fn-hide-search"><i class=icon-close-blue></i></div> <div class=chart-search-block-wrapper></div> </div> </div> <div class=chart-panel-content-minimized> <i class="expand icon fn-chart-restore-size hidden-xs"></i><a class="fn-chart-restore-size hidden-xs"><%=__(\'chart.expand_chart\')%></a> <div class="expand restore-size-mobile fn-chart-restore-size hidden-sm hidden-md hidden-lg"> <div><i class=icon-double-arrow-up></i></div> </div> </div>'}}]);