webpackJsonp([24],{1783:function(t,e,n){var a;void 0!==(a=function(t,e,a){var i=n(2642),r=n(2644);a.exports={MetatraderPopupModel:r,MetatraderPopupView:i}}.call(e,n,e,t))&&(t.exports=a)},2072:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(15),s=n(8);a.exports=r.extend({defaults:function(){return{bonuses:[]}},load:function(){var t=this;return s.queryBonusProgress().then(function(e){return t.set({bonuses:e.data})})},getBonuses:function(){return this.get("bonuses")},hasBonuses:function(){return i.isEmpty(this.getBonuses())},filter:function(t){return function(e){return i.contains(t,e.status)}}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2136:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(13),s=n(25);a.exports=r.extend({enrichBonusInfo:function(t,e){var n=this;return i.isArray(t)?i.each(t,function(t){return n.enrich(t,e)}):this.enrich(t,e),t},enrich:function(t,e){return i.isEmpty(t)||(t.statusClass=this.getStatusClass(t),t.statusLabel=this.formatStatus(t),t.title=this.getTitle(t),t.amountTitle=this.getAmountTitle(t,e),t.note=this.getNote(t,e),t.points=this.getBonusPoints(t),t.pointsEarned=this.getBonusPointsEarned(t),t.progressPercent=this.calculateProgressPercent(t),t.progressClass=this.getProgressClass(t),t.expirationTime=this.formatBonusExpirationTime(t,!1),t.expirationTimeShort=this.formatBonusExpirationTime(t,!0),t.expirationDate=this.formatBonusExpirationDate(t),t.helpMessage=this.getHelpMessage(t,e)),t},getBonusPoints:function(t){return __("bonus.item.points",t.currentPoints,t.targetPoints)},getBonusPointsEarned:function(t){return __("bonus.item.points.earned",t.currentPoints,t.targetPoints)},calculateProgressPercent:function(t){return 100*t.currentPoints/t.targetPoints},getProgressClass:function(t){switch(t.status){case"COMPLETED":case"EXPIRED":case"LOST":case"WAITING":return"inactive";default:return""}},getStatusClass:function(t){return t.status.toLowerCase()},getAmountTitle:function(t,e){return e+t.volume+" "+this.getTitle(t)},getTitle:function(t){switch(t.type){case"COMPLIANCE":return __("bonus.item.compliance.title");case"WELCOME_BONUS":return __("bonus.item.wb.title");case"PENDING_BONUS":return __("bonus.item.pb.title");case"FD_BONUS":return __("bonus.item.fd.title");case"SMS_BONUS":return __("bonus.item.sms.title");case"VERIFY_POI":return __("bonus.item.id.title");case"VERIFY_POR":return __("bonus.item.residence.title");case"UNKNOWN":return __("bonus.item.unknown.reason."+t.reason);default:return""}},formatStatus:function(t){switch(t.status){case"IN_PROGRESS":return __("bonus.item.status.in_progress");case"WAITING":return __("bonus.item.status.waiting");case"COMPLETED":return __("bonus.item.status.completed");case"EXPIRED":return __("bonus.item.status.expired");case"LOST":return __("bonus.item.status.lost");default:return""}},getHelpMessage:function(t,e){switch(t.status){case"IN_PROGRESS":return __("bonus.item.ip.help.message");case"WAITING":return __("bonus.item.waiting.help.message");case"COMPLETED":return __("bonus.item.completed.help.message",e+t.volume);case"EXPIRED":return __("bonus.item.expired.help.message");case"LOST":return __("bonus.item.lost.help.message");default:return""}},getNote:function(t,e){switch(t.status){case"LOST":return"";default:return __("bonus.item.note",e+t.volume)}},formatBonusExpirationTime:function(t,e){var n=t.expiration,a=__("bonus.item.expiration.format",n.days,n.hours,n.minutes);return(e?__("bonus.item.expiration.short"):__("bonus.item.expiration"))+" "+a},formatBonusExpirationDate:function(t){var e=new Date(t.expireAt),n=s.splitByComma(__("calendar.month_names.short"));return e.getDate()+" "+n[e.getMonth()]+", "+e.getFullYear()}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2414:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(2136),s=i.template(n(2415)),o=i.template(n(2416));a.exports=r.extend({className:"bonus-in-progress",render:function(){return r.prototype.render.call(this),this.$el.html(s({bonusTemplate:o,in_progress:this.enrichBonusInfo(this.model.getInProgressBonus(),this.model.getAccountCurrency()),waiting:this.enrichBonusInfo(this.model.getWaitingBonuses(),this.model.getAccountCurrency())})),this}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2415:function(t,e){t.exports='<div class="bonus-progress-body flex flex-column"><div class="forms-container flex flex-column flex-stretch"><div class="flex flex-column flex-stretch min-height-content"> <% if (_.isEmpty(in_progress)) { %> <div class="empty"> <%=__(\'bonus.empty.no.inprogress.message\')%> <a href="mailto:<%=__(\'brand.support.email\')%>"><%=__(\'bonus.nobonus.contact.us\')%></a></div> <% } else { %> <div class="header"><%=__(\'bonus.status.inprogress\')%></div> <%=bonusTemplate({ bonus: in_progress })%> <br><br> <% if (_.isEmpty(waiting)) { %> <div class="empty"> <%=__(\'bonus.empty.no.next.message\')%> <a href="mailto:<%=__(\'brand.support.email\')%>"><%=__(\'bonus.nobonus.contact.us\')%></a></div> <% } else { %> <div class="header"><%=__(\'bonus.status.next\')%></div> <% _.each(waiting, function(waiting_bonus) { %> <%=bonusTemplate({ bonus: waiting_bonus })%> <% }) %> <% } %> <% } %> </div></div></div>'},2416:function(t,e){t.exports='<div class="bonus-line <%= bonus.statusClass %>"><div class="bonus-title"><span class="title"><%= bonus.title %></span><span class="note"><%= bonus.note %></span></div><div class="bonus-progress"><div class="points hidden-xs"><%= bonus.points %></div><div class="bonus-progress-wrapper visible-xs visible-sm visible-md"><span class="earned-points <%= bonus.statusClass %>"><%= bonus.points %></span><span class="expiration-short"><%= bonus.expirationTimeShort %></span></div><div class="progress-bar <%= bonus.progressClass %>"><div style="width: <%= bonus.progressPercent %>%"></div></div><div class="expiration hidden-xs"><%= bonus.expirationTime %></div></div><div class="bonus-help"><%= bonus.helpMessage %></div></div>'},2417:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(2136),s=i.template(n(2418)),o=i.template(n(2419));a.exports=r.extend({className:"bonus-completed",render:function(){return r.prototype.render.call(this),this.$el.html(s({bonusTemplate:o,completed:this.enrichBonusInfo(this.model.getCompletedBonuses(),this.model.getAccountCurrency())})),this}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2418:function(t,e){t.exports='<div class="bonus-progress-body flex flex-column"><div class="forms-container flex flex-column flex-stretch"><div class="flex flex-column flex-stretch min-height-content"> <% if (_.isEmpty(completed)) { %> <div class="empty"> <%=__(\'bonus.empty.no.completed.message\')%> <a href="mailto:<%=__(\'brand.support.email\')%>"><%=__(\'bonus.nobonus.contact.us\')%></a></div> <% } else { %> <div class="grid-12-equalHeight header-grid hidden-xs"><div class="col-5"><%=__(\'bonus.item.completed.name\')%></div><div class="col-2"><%=__(\'bonus.item.completed.expiration.title\')%></div><div class="col-3"><%=__(\'bonus.item.completed.points.earned.title\')%></div><div class="col-2"><%=__(\'bonus.item.status\')%></div></div> <% _.each(completed, function(completed_bonus) { %> <%=bonusTemplate({ bonus: completed_bonus })%> <% }) %> <% } %> </div></div></div>'},2419:function(t,e){t.exports='<div class="grid-12-equalHeight bonus-line-grid hidden-xs"><div class="col-5 title"><%= bonus.amountTitle %></div><div class="col-2 expiration"><%= bonus.expirationDate %></div><div class="col-3 points"><%= bonus.pointsEarned %></div><div class="col-2"><div class="status"><span class="<%= bonus.statusClass %>"><%= bonus.statusLabel %></span><span class="question-tooltip" aria-label="<%= bonus.helpMessage %>" data-tooltip-align="right"></span></div></div></div><div class="grid-12-equalHeight bonus-line-grid visible-xs visible-sm visible-md"><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5 title"><%=__(\'bonus.item.completed.name\')%></div><div class="col-7 title"><%= bonus.amountTitle %></div></div></div><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5"><%=__(\'bonus.item.completed.expiration.title\')%></div><div class="col-7 expiration"><%= bonus.expirationDate %></div></div></div><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5"><%=__(\'bonus.item.completed.points.earned.title\')%></div><div class="col-7 points"><%= bonus.pointsEarned %></div></div></div><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5"><%=__(\'bonus.item.status\')%></div><div class="col-7 status <%= bonus.statusClass %>"><%= bonus.statusLabel %></div></div></div></div>'},2420:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(2072);a.exports=r.extend({defaults:function(){return{in_progress:{},waiting:[]}},initialize:function(){r.prototype.initialize.apply(this,arguments),this.load()},load:function(){this.set({in_progress:this.parseInProgressBonus(),waiting:i.filter(this.getBonuses(),this.filter(["WAITING"]))})},parseInProgressBonus:function(){var t=i.filter(this.getBonuses(),this.filter(["IN_PROGRESS"]));return i.isEmpty(t)?{}:t[0]},getInProgressBonus:function(){return this.get("in_progress")},getWaitingBonuses:function(){return this.get("waiting")},getAccountCurrency:function(){return this.get("accountCurrency")}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2421:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(2072);a.exports=r.extend({defaults:function(){return{completed:[]}},initialize:function(){this.load()},load:function(){this.set({completed:i.filter(this.getBonuses(),this.filter(["COMPLETED","LOST","EXPIRED"]))})},getCompletedBonuses:function(){return this.get("completed")},getAccountCurrency:function(){return this.get("accountCurrency")}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2642:function(t,e,n){(function(a,i){var r;void 0!==(r=function(t,e,a){var i=n(0),r=n(6),s=n(22),o=n(2),d=n(7),l=n(9),c=n(57),u=n(8),m=n(797),f=i.template(n(2643)),h=n(379),p=h.SUCCESS,v=h.ERROR,g=h.ACTIVE,b=s.extend({name:"metatrader-popup",events:function(){return i.extend({},i.result(s.prototype,"events"),{"click .fn-tab":"changeTab","click .fn-reset-password":"resetPassword"})},initialize:function(t){t.tabId&&this.model.set("currentTabId",t.tabId),t.bonusesTab&&this.model.set("bonusesTab",t.bonusesTab),s.prototype.initialize.apply(this,arguments),this._metatraderLeverage=new m,this.listenTo(this.model,"change:statusOfMetaTraderTradingCentral",this.loadCompleted),this.listenTo(this.model,"change:currentTabId",this.updateTab),this.listenTo(o,"showMetatraderTabById",this.setTabById),this.listenTo(this._metatraderLeverage,"change:statusOfMetaTraderAccounts",this.metaTraderAccountsChanged)},loadCompleted:function(){var t=this.model.get("statusOfMetaTraderTradingCentral");if(t===v)return this.loadError();t===p&&(this.render(),this.updateTab())},loadError:function(){new c({parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))}),this.close()},render:function(){return s.prototype.render.call(this),this.setContent(f({tabs:this.model.get("tabs"),currentTabId:this.model.get("currentTabId"),tradingCentral:this.model.get("tradingCentral"),resetPassword:this.model.get("resetPassword"),isMT5PlatformEnabled:l.isMT5PlatformEnabled()})),this},updateTab:function(){var t=this.model.getCurrentTabView(),e=this.model.getCurrentTabId();this.addChildView(".tab-content",t,{model:this.model}),this.$(".header-container-xs .caption").html(__(this.model.getCurrentTabTitle())),this.$(".tab").removeClass("active"),this.$(".tab[data-tab-id="+e+"]").addClass("active")},changeTab:function(t){this.model.setCurrentTabById(r(t.currentTarget).attr("data-tab-id"))},setTabById:function(t){this.model.setCurrentTabById(t),this._metatraderLeverage.reloadMetaTraderAccounts()},resetPassword:function(){var t=d.getCustomerId(),e=d.getEmail();return u.forgotPasswordById(t).then(function(){new c({text:__("mt4.password.need.reset",e),isHeaderShowed:!1,okBtnText:__("ok"),isShowCloseForMobile:!1})})},metaTraderAccountsChanged:function(){this.showLeverageTab(),this.showBonusesTab(),this.showFundsTransferTab()},showLeverageTab:function(){var t=this;if(l.isMetaTraderInternalLeverageEnabled()){var e=i.filter(this.model.get("metaTraderAccounts"),function(e){return t.model.hasPlatformAccountId(e)&&t.model.isTradingAccountStatus(e,g)}),n=this.model.get("availableLeverages"),a=i.isEmpty(n)||1===n.length&&i.every(e,function(t){return t.leverage===n[0]});if(i.isEmpty(e)||a)return;this.$el.find('li[data-tab-id="metatrader-leverage"]').removeClass("hidden")}},showBonusesTab:function(){var t=this;if(l.isBonusesEnabled()){var e=i.filter(this._metatraderLeverage.get("metaTraderAccounts"),function(e){return t.model.hasPlatformAccountId(e)&&t.model.isTradingAccountStatus(e,g)&&e.hasBonuses});if(i.isEmpty(e))return;this.$el.find('li[data-tab-id="metatrader-bonuses"]').removeClass("hidden")}},showFundsTransferTab:function(){var t=this;if(l.isMetaTraderInternalFundsTransferEnabled()){var e=i.filter(this._metatraderLeverage.get("metaTraderAccounts"),function(e){return t.model.hasPlatformAccountId(e)&&t.model.isTradingAccountStatus(e,g)});i.isEmpty(e)||this.$el.find('li[data-tab-id="metatrader-funds-transfer"]').removeClass("hidden")}}});a.exports=function(t){return new b(i.extend({},t,{headerStyle:"default",isHeaderShowed:!0,closeIconStyle:"blue",headerBgStyle:"transparent"}))}}.call(e,n,e,t))&&(t.exports=r)}).call(e,n(0),n(6))},2643:function(t,e){t.exports='<div class="metatrader-popup"><div class="modal-dialog-container"></div><div class="metatrader-body flex-stretch"><div class="tabs hidden-xs"><ul> <% _.each(tabs, function(tab) { %> <li class="tab fn-tab <%- currentTabId == tab.id ? \'active\' : \'\' %> tab-<%= tab.id%> <%- tab.hidden ? \'hidden\' : \'\' %>" data-tab-id="<%- tab.id %>"><a><%- __(tab.title) %></a></li> <% }) %> <% if (tradingCentral) { %> <li class="tab"><a href="<%= tradingCentral %>" target="_blank"><%= __(\'metatrader.technical-analysis.title\') %></a></li> <% } %> <li class="tab"> <%= __(\'metatrader.trading-conditions.title\') %> </li> <% if (isMT5PlatformEnabled) { %> <li class="tab"> <%= __(\'metatrader.mt5-platform.title\') %> </li> <% } %> <% if (resetPassword) { %> <li class="tab fn-reset-password"><a><%= __(\'metatrader.reset-password.title\') %></a></li> <% } %> </ul></div><div class="tab-content"></div></div></div>'},2644:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(384),s=n(2645),o=n(2648),d=n(2651),l=n(2653),c=n(2656),u=n(2660),m=n(8),f=n(118),h=n(379),p=h.SUCCESS,v=h.ERROR,g=h.LOADING;a.exports=r.extend({defaults:function(){return{tabs:[{id:"metatrader-accounts",url:"metatrader-accounts",title:"metatrader.accounts.title",view:s,hidden:!1},{id:"metatrader-funds-transfer",url:"metatrader-funds-transfer",title:"metatrader.funds-transfer.title",view:o,hidden:!0},{id:"metatrader-leverage",url:"metatrader-leverage",title:"metatrader.leverage.title",view:d,hidden:!0},{id:"metatrader-add-account",url:"metatrader-add-account",title:"metatrader.add-account.title",view:l,hidden:!1},{id:"metatrader-deposit",url:"metatrader-deposit",title:"actions.deposit",view:c,hidden:!1},{id:"metatrader-bonuses",url:"metatrader-bonuses",title:"metatrader.bonuses.title",view:u,hidden:!0}],currentTabId:"metatrader-accounts",defaultTabId:"metatrader-accounts",resetPassword:!1}},initialize:function(){var t=this;r.prototype.initialize.apply(this,arguments);var e=this.status("statusOfMetaTraderTradingCentral");return e(g),m.getMetaTraderTradingCentral().then(function(n){f.isExternalLoginDetected()&&t.set("resetPassword",!0),e(p,{tradingCentral:n.data})}).catch(function(t){e(v)})},getCurrentTab:function(){return i.findWhere(this.get("tabs"),{id:this.getCurrentTabId()})},getCurrentTabId:function(){var t=this.get("currentTabId");return t||(t=this.get("defaultTabId")),t},getCurrentTabTitle:function(){var t=this.getCurrentTab(),e=null;return t&&(e=t.title||e),e},getCurrentTabView:function(){var t=this.getCurrentTab(),e=null;return t&&(e=t.view||e),e},getTabById:function(t){return i.findWhere(this.get("tabs"),{id:t})},setCurrentTabById:function(t){var e=this.getTabById(t);return e&&this.set({currentTabId:e.id}),e}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2645:function(t,e,n){(function(a,i){var r;void 0!==(r=function(t,e,a){var i=n(0),r=n(13),s=n(28),o=n(2646),d=n(6),l=n(2),c=n(7),u=n(36),m=n(9),f=i.template(n(2647)),h=n(379),p=h.ACTIVE,v=h.PENDING,g=h.ERROR,b=h.SUCCESS,_=r.extend({className:"metatrader-accounts",events:function(){return i.extend({},i.result(r.prototype,"events"),{"click .fn-show-add-account-tab":"showAddAccountTab","click .fn-toggle":"toggleRow"})},initialize:function(){r.prototype.initialize.apply(this,arguments),this.model=new o,this.listenTo(this.model,"change:statusOfMetaTraderAccounts",this.loadCompleted)},loadCompleted:function(){var t=this.model.get("statusOfMetaTraderAccounts");if(t===g)return this.loadError();t===b&&(this.removeChildView(".metatrader-accounts"),this.showTemplate())},loadError:function(){this.removeChildView(".metatrader-accounts"),l.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},showTemplate:function(){var t=this,e=i.filter(this.model.get("metaTraderAccounts"),function(e){return t.model.hasPlatformAccountId(e)&&(t.model.isTradingAccountStatus(e,p)||t.model.isTradingAccountStatus(e,v))}),n=(100*c.getUserAccountSettingsModel().getLiquidationLevel()).toFixed(),a=(100*c.getUserAccountSettingsModel().getMarginAlertLevel2()).toFixed(),r=this.isBonusesEnabled();return this.$el.html(f({accounts:e,numbro:u,liquidationLevel:n,marginAlertLevel2:a,isBonusesEnabled:r})),this},render:function(){return r.prototype.render.apply(this,arguments),this.addChildView(".metatrader-accounts",s,{parent:this.$el,translucent:"2"}),this},showAddAccountTab:function(){l.trigger("showMetatraderTabById","metatrader-add-account")},toggleRow:function(t){var e=d(t.target),n=e.closest(".row");d(n).hasClass("expanded")?(d(n).removeClass("expanded"),e.html("+")):(d(n).addClass("expanded"),e.html("-"));var a=n.nextElementSibling;d(a).hasClass("expanded")?d(a).removeClass("expanded"):d(a).addClass("expanded")},isBonusesEnabled:function(){return m.isBonusesEnabled()}});a.exports=_}.call(e,n,e,t))&&(t.exports=r)}).call(e,n(0),n(6))},2646:function(t,e,n){var a;void 0!==(a=function(t,e,a){var i=n(384),r=(n(0),n(379)),s=r.EMPTY;r.LOADING,r.ERROR,r.SUCCESS;a.exports=i.extend({defaults:function(){return{statusOfMetaTraderAccounts:s}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadMetaTraderAccounts()}})}.call(e,n,e,t))&&(t.exports=a)},2647:function(t,e){t.exports='<table><thead class="columns"><tr><th class="column column-account"><%=__(\'metatrader.accounts.account\')%></th><th class="column column-status"><%=__(\'metatrader.accounts.status\')%></th><th class="column column-action hidden-xs"><button class="btn btn-default btn-mobile-bottom fn-show-add-account-tab"><span class="icon-circle">+</span><%=__(\'metatrader.accounts.actions.add-account\')%></button></th></tr></thead><tbody class="rows"> <% _.each(accounts, function(account) { %> <tr class="row"><td class="row-accounts"><span class="icon-square fn-toggle">+</span> <%- account.tradePlatformType %> - <%- account.accountId %> - <%- account.currency %> </td><td class="row-status"><%=__(\'metatrader.accounts.status.\' + account.tradingAccountStatus)%> - <%=__(\'metatrader.accounts.type.\' + account.tradingAccountType)%></td><td class="metatrader-accounts-actions actions hidden-xs"> <% if(account.webLink) { %> <a class="btn btn-icon" href="<%- account.webLink %>" target="_blank" title="<%=__(\'metatrader.accounts.sirix\')%>"><i class="icon icon-launch-sirix-blue"></i></a> <% } %> <% if(account.downloadLink) { %> <a class="btn btn-icon" href="<%- account.downloadLink %>" target="_blank" title="<%=__(\'metatrader.accounts.download.\' + account.tradePlatformType)%>"><i class="icon icon-download-blue"></i></a> <% } %> <% if(account.accountStatementLink) { %> <a class="btn btn-icon" href="<%- account.accountStatementLink %>" target="_blank" title="<%=__(\'metatrader.accounts.account-statement\')%>"><i class="icon icon-report-blue"></i></a> <% } %> </td></tr><tr class="row expandable-content"><td class="info-column-left"><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.balance\')%>"></span> <%=__(\'metatrader.accounts.balance\')%> </div><div><%- numbro(account.balance).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.equity\')%>"></span> <%=__(\'metatrader.accounts.equity\')%> </div><div><%- numbro(account.equity).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.free_margin\')%>"></span> <%=__(\'metatrader.accounts.free-margin\')%> </div><div><%- numbro(account.freeMargin).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.login\')%>"></span> <%=__(\'indigo.new_account.login_link\')%> </div><div><%- account.platformAccountId %></div></div></td><td class="info-column-right"><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.used_margin\')%>"></span> <%=__(\'metatrader.accounts.used-margin\')%> </div><div><%- numbro(account.usedMargin).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.margin_level\',marginAlertLevel2,liquidationLevel)%>"></span> <%=__(\'metatrader.accounts.margin-level\')%> </div><div> <% if (account.marginLevel) {%> <%=account.marginLevel%>% <% } else { %> N/A <% } %> </div></div> <% if (isBonusesEnabled && account.hasCashBonuses) { %> <div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'funds.management.bonuses.help\')%>"></span> <%=__(\'metatrader.accounts.bonuses\')%> </div><div><%- numbro(account.accountBonusesAmount).formatForeignCurrency(__currency(account.currency)) %></div></div> <% } %> <div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'funds.management.available.help\')%>"></span> <%=__(\'metatrader.accounts.available-withdrawal\')%> </div><div><%- numbro(account.availableForWithdrawal).formatForeignCurrency(__currency(account.currency)) %></div></div></td></tr> <% }) %> </tbody></table><button class="btn btn-primary btn-mobile-bottom fn-show-add-account-tab hidden-sm hidden-md hidden-lg"><span class="icon-circle">+</span><%=__(\'metatrader.accounts.actions.add-account\')%></button>'},2648:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(13),s=n(28),o=n(2),d=n(74),l=n(199),c=n(200),u=n(2649),m=i.template(n(2650)),f=n(379),h=f.REAL,p=f.EMPTY,v=f.ERROR,g=f.SUCCESS,b=f.VALIDATE,_=f.PROCESSING,T=r.extend({className:"metatrader-funds-transfer",events:function(){return this.addEvents(r)({"click .fn-funds-transfer":"fundsTranfer"})},initialize:function(t){r.prototype.initialize.apply(this,arguments),this.model=new u,this.listenTo(this.model,"change:statusOfAllAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfFundsTransfer",this.onStatusOfFundsTransferChanged)},loadCompleted:function(){var t=this.model.get("statusOfAllAccounts");if(t===v)return this.loadError();t===g&&(this.removeChildView(".loading-wrapper"),this.$el.find(".funds-transfer").removeClass("hidden"),this.createForm())},loadError:function(){this.removeChildView(".loading-wrapper"),o.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us.funded.client"))})},createForm:function(){var t=this,e=this.$el.find(".funds-transfer-form"),n=i.filter(this.model.get("allAccounts"),function(e){return t.model.hasPlatformAccountId(e)&&t.model.isTradingAccountType(e,h)}),a={form:[[{disable:!1,template:d.inputAddon,title:__("metatrader.funds-transfer.amount")+":",name:"field_amount",addonText:"$",type:"text",translationKey:"",validation:{filters:["trim","number"],rules:{min:[1,__("errors.required",__("metatrader.funds-transfer.amount"))],not_empty:__("errors.required",__("metatrader.funds-transfer.amount"))}},dependent:[{name:"field_platformAccountIdFrom",handler:this.changeInputAddonText.bind(this)}]}],[{disable:!1,template:d.selectBox,title:__("metatrader.funds-transfer.origin-account")+":",name:"field_platformAccountIdFrom",savedData:i.first(n).accountId,options:n,transformOptionsValue:function(t){return t.accountId},transformOptionText:function(t){var e=t.accountId,n=t.tradePlatformType,a=t.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+e+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.funds-transfer.origin-account"))}},dependent:[{name:"field_platformAccountIdTo",handler:this.removeAccountFromSelect}]}],[{disable:!1,template:d.selectBox,title:__("metatrader.funds-transfer.destination-account")+":",name:"field_platformAccountIdTo",options:n,transformOptionsValue:function(t){return t.accountId},transformOptionText:function(t){var e=t.accountId,n=t.tradePlatformType,a=t.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+e+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.funds-transfer.destination-account"))}},dependent:[{name:"field_platformAccountIdFrom",handler:this.removeAccountFromSelect}]}]]},r=new c(a);this.formView=new l({model:r,$parent:e}),this.formView.show(),this.formView.form.$(".field-type-input-addon > .field-status").html(__("metatrader.funds-transfer.amount.info"))},removeAccountFromSelect:function(t){this.$el.find('[disabled="disabled"]').removeAttr("disabled"),this.$el.find(".hidden").removeClass("hidden");var e=t.value();this.$el.find('[value="'+e+'"]').attr("disabled","disabled"),this.$el.find('[data-value="'+e+'"]').addClass("hidden")},changeInputAddonText:function(t){var e=this.model.get("allAccounts"),n=i.find(e,function(e){return e.accountId===t.value()});this.getAmountField().$el.find(".field-addonText").html(__currency(n.currency))},getAllAccountsIds:function(){return i.pluck(this.model.get("allAccounts"),"accountId")},render:function(){return r.prototype.render.call(this),this.$el.html(m(this.options)),this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"}),this.$el.find(".funds-transfer").addClass("hidden"),this},getAccountIdFromField:function(){return this.formView.form.getField("field_platformAccountIdFrom")},getAccountIdToField:function(){return this.formView.form.getField("field_platformAccountIdTo")},getAmountField:function(){return this.formView.form.getField("field_amount")},fundsTranfer:function(){this.model.set("statusOfFundsTransfer",b)},onStatusOfFundsTransferChanged:function(){var t=this.model,e=t.get("statusOfFundsTransfer"),n=this.getAccountIdFromField().value(),a=this.getAccountIdToField().value(),r=this.getAmountField().value();switch(e){case b:t.set("statusOfFundsTransfer",p);if(this.formView.form.validate())return;var o=this.model.get("allAccounts"),d=i.find(o,function(t){return t.accountId===n}),l=d.currency;return void t.fundsTransfer(+n,+a,+r,l);case _:return void this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"});case g:return this.removeChildView(".loading-wrapper"),this.getAmountField().value(""),this.getAccountIdToField().fieldVerified(),void this.getAccountIdToField().setTooltipMessage(__("metatrader.funds-transfer.success"));case v:return this.removeChildView(".loading-wrapper"),void this.loadError()}}});a.exports=T}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2649:function(t,e,n){var a;void 0!==(a=function(t,e,a){var i=n(384),r=(n(0),n(8)),s=n(379),o=s.EMPTY,d=(s.LOADING,s.ERROR),l=s.SUCCESS,c=s.PROCESSING;a.exports=i.extend({defaults:function(){return{statusOfAllAccounts:o,statusOfFundsTransfer:o}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadAllAccounts()},fundsTransfer:function(t,e,n,a){var i=this.status("statusOfFundsTransfer");if(i(c),!t||!e||!n)return i(d);var s={from:t,to:e,amount:n,currency:a};r.metaTraderFundsTransfer(s).then(function(t){return i(l)}).catch(function(t){i(d)})}})}.call(e,n,e,t))&&(t.exports=a)},2650:function(t,e){t.exports='<div class="funds-transfer"><div class="funds-transfer-info"><%=__(\'metatrader.funds-transfer.info\')%></div><div class="funds-transfer-form"></div></div><div class="form-col"><button class="btn btn-primary btn-mobile-bottom btn-block fn-funds-transfer"><%- __(\'actions.submit\') %></button></div><div class="loading-wrapper"></div>'},2651:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(13),s=n(28),o=n(2),d=n(74),l=n(199),c=n(200),u=n(797),m=i.template(n(2652)),f=n(379),h=f.ACTIVE,p=f.EMPTY,v=(f.LOADING,f.ERROR),g=f.SUCCESS,b=f.VALIDATE,_=f.PROCESSING,T=r.extend({className:"metatrader-leverage",events:function(){return this.addEvents(r)({"click .fn-leverage-change":"changeLeverage"})},initialize:function(t){r.prototype.initialize.apply(this,arguments),this.model=new u,this.listenTo(this.model,"change:statusOfMetaTraderAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfLeverageChange",this.onStatusOfLeverageChanged)},loadCompleted:function(){var t=this.model.get("statusOfMetaTraderAccounts");if(t===v)return this.loadError();t===g&&(this.removeChildView(".loading-wrapper"),this.$el.find(".meta-leverage").removeClass("hidden"),this.createForm())},loadError:function(){this.removeChildView(".loading-wrapper"),o.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},createForm:function(){var t=this,e=this.$el.find(".metatrader-leverage-form"),n=i.filter(this.model.get("metaTraderAccounts"),function(e){return t.model.hasPlatformAccountId(e)&&t.model.isTradingAccountStatus(e,h)}),a={form:[[{disable:!1,template:d.selectBox,title:__("metatrader.leverage.account")+":",name:"field_platformAccountId",savedData:i.first(n).accountId,options:n,transformOptionsValue:function(t){return t.accountId},transformOptionText:function(t){var e=t.accountId,n=t.tradePlatformType,a=t.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+e+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.leverage.account"))}}}],[{disable:!0,template:d.inputBox,title:__("metatrader.leverage.current-leverage")+":",name:"field_currentLeverage",translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.leverage.current-leverage"))}},dependent:[{name:"field_platformAccountId",handler:this.setLeverageByAccountId.bind(this)}]},{disable:!1,template:d.selectBox,title:__("metatrader.leverage.new-leverage")+":",name:"field_newLeverage",savedData:"1:"+i.first(this.model.get("availableLeverages")),options:this.model.get("availableLeverages"),transformOptionText:function(t){return"1:"+t},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.leverage.new-leverage"))}},dependent:[{name:"field_platformAccountId",handler:this.setLeverageOptionsByAccountId.bind(this)}]}]]},r=new c(a);this.formView=new l({model:r,$parent:e}),this.formView.show()},setLeverageByAccountId:function(t){var e=this.model.get("metaTraderAccounts"),n=i.find(e,function(e){return e.accountId===t.value()});this.getCurrentLeverageField().setValue("1:"+n.leverage)},setLeverageOptionsByAccountId:function(t){var e=this,n=this.model.get("availableLeverages"),a=this.model.get("metaTraderAccounts"),r=i.find(a,function(e){return e.accountId===t.value()});this.getNewLeverageField();n.forEach(function(t){e.$el.find('[value="'+t+'"]').removeAttr("disabled"),e.$el.find('[data-value="'+t+'"]').removeClass("hidden")}),this.$el.find('[value="'+r.leverage+'"]').attr("disabled","disabled"),this.$el.find('[data-value="'+r.leverage+'"]').addClass("hidden")},getAllAccountsIds:function(){return i.pluck(this.model.get("allAccounts"),"tpId")},render:function(){return r.prototype.render.call(this),this.$el.html(m(this.options)),this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"}),this.$el.find(".meta-leverage").addClass("hidden"),this},getAccountIdField:function(){return this.formView.form.getField("field_platformAccountId")},getCurrentLeverageField:function(){return this.formView.form.getField("field_currentLeverage")},getNewLeverageField:function(){return this.formView.form.getField("field_newLeverage")},changeLeverage:function(){this.model.set("statusOfLeverageChange",b)},onStatusOfLeverageChanged:function(){var t=this.model,e=t.get("statusOfLeverageChange"),n=+this.getAccountIdField().value(),a=+this.getNewLeverageField().value();switch(e){case b:t.set("statusOfLeverageChange",p);if(this.formView.form.validate())return;return void t.changeLeverage(n,a);case _:return void this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"});case g:return this.removeChildView(".loading-wrapper"),this.getNewLeverageField().value(""),this.getAccountIdField().fieldVerified(),void this.getAccountIdField().setTooltipMessage(__("metatrader.leverage.success"));case v:return void this.removeChildView(".loading-wrapper")}}});a.exports=T}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2652:function(t,e){t.exports='<div class="meta-leverage"><div class="metatrader-leverage-info"><%=__(\'metatrader.leverage.info.select\')%></div><div class="metatrader-leverage-info"><%=__(\'metatrader.leverage.info.period\')%></div><div class="metatrader-leverage-info"><%=__(\'metatrader.leverage.info.position-closed\')%></div><div class="metatrader-leverage-form"></div><div class="form-col"><button class="btn btn-primary btn-mobile-bottom btn-block fn-leverage-change"><%- __(\'actions.submit\') %></button></div><ul class="metatrader-leverage-list"><li><%=__(\'metatrader.leverage.info.profile\')%></li><li><%=__(\'metatrader.leverage.info.policy\')%></li></ul></div><div class="loading-wrapper"></div>'},2653:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(0),r=n(13),s=n(28),o=n(74),d=n(199),l=n(200),c=n(2654),u=n(2),m=n(9),f=i.template(n(2655)),h=n(379),p=h.EMPTY,v=h.ERROR,g=h.SUCCESS,b=h.VALIDATE,_=h.PROCESSING,T=r.extend({className:"metatrader-add-account",events:function(){return this.addEvents(r)({"click .fn-add-account":"addAccount"})},initialize:function(t){r.prototype.initialize.apply(this,arguments),this.model=new c,this.listenTo(this.model,"change:statusOfMetaTraderAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfAddAccount",this.onStatusOfAddAccountChanged)},loadCompleted:function(){var t=this.model.get("statusOfMetaTraderAccounts");if(t===v)return this.loadError();t===g&&(this.removeChildView(".loading-wrapper"),this.$el.find(".add-account").removeClass("hidden"),this.createForm())},loadError:function(){this.removeChildView(".loading-wrapper"),u.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},createForm:function(){var t=this.$el.find(".add-account-form"),e=this.model.get("metaTraderConfiguration"),n=m.isMetaTraderInternalLeverageCreateAccountDefault()?[this.model.get("defaultLeverage")]:this.model.get("availableLeverages"),a=[],r=[],s=[];i.map(e,function(t){a.push(t.tradePlatformType),r=r.concat(t.availableCurrencies),s=s.concat(t.accountTypeList)}),r=i.uniq(r),s=i.uniq(s);var c={form:[[{disable:!1,template:o.selectBox,title:__("metatrader.add-account.type.title")+":",name:"field_accountType",savedData:s[0],options:s,transformOptionText:function(t){return __("metatrader.add-account.type."+t)},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.type.title"))}}}],[{disable:!1,template:o.selectBox,title:__("metatrader.add-account.trading-platform.title")+":",name:"field_tradingPlatform",savedData:a[0],options:a,transformOptionText:function(t){return __("metatrader.add-account.trading-platform."+t)},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.trading-platform.title"))}}}],[{disable:!1,template:o.selectBox,title:__("metatrader.add-account.currency")+":",name:"field_currency",savedData:r[0],options:r,transformOptionText:function(t){return t},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.currency"))}},dependent:[{name:"field_tradingPlatform",handler:this.changeCurrenciesOptions.bind(this)}]}],[{disable:!m.isMetaTraderInternalLeverageEnabled(),template:o.selectBox,title:__("metatrader.add-account.leverage")+":",name:"field_leverage",savedData:n[0],options:n,transformOptionText:function(t){return"1:"+t},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.leverage"))}}}]]},u=new l(c);this.formView=new d({model:u,$parent:t}),this.formView.show()},render:function(){return r.prototype.render.call(this),this.$el.html(f(this.options)),this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"}),this.$el.find(".add-account").addClass("hidden"),this},getAccountTypeField:function(){return this.formView.form.getField("field_accountType")},getTradingPlatformField:function(){return this.formView.form.getField("field_tradingPlatform")},getCurrencyField:function(){return this.formView.form.getField("field_currency")},getLeverageField:function(){return this.formView.form.getField("field_leverage")},addAccount:function(){this.model.set("statusOfAddAccount",b)},changeCurrenciesOptions:function(t){var e=this.model.get("metaTraderConfiguration"),n=void 0;i.map(e,function(e){e.tradePlatformType===t.value()&&(n=e)}),this.getCurrencyField().value(n.availableCurrencies[0]),this.showCurrenciesInSelect(n.availableCurrencies)},showCurrenciesInSelect:function(t){var e=this.$el.find('[name="field_currency"]');e.find(".dk-option").addClass("hidden"),e.find("option").attr("disabled","disabled"),i.map(t,function(t){e.find('[value="'+t+'"]').removeAttr("disabled"),e.find('[data-value="'+t+'"]').removeClass("hidden")})},onStatusOfAddAccountChanged:function(){var t=this.model,e=t.get("statusOfAddAccount"),n=this.getAccountTypeField().value(),a=this.getTradingPlatformField().value(),i=this.getCurrencyField().value(),r=+this.getLeverageField().value();switch(e){case b:t.set("statusOfAddAccount",p);if(this.formView.form.validate())return;return void t.addAccount(n,a,i,r);case _:return void this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"});case g:return this.removeChildView(".loading-wrapper"),void u.trigger("showMetatraderTabById","metatrader-accounts");case v:return this.removeChildView(".loading-wrapper"),void this.loadError()}}});a.exports=T}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2654:function(t,e,n){var a;void 0!==(a=function(t,e,a){var i=n(384),r=(n(0),n(8)),s=n(379),o=s.EMPTY,d=(s.LOADING,s.ERROR),l=s.SUCCESS,c=s.PROCESSING;a.exports=i.extend({defaults:function(){return{statusOfMetaTraderAccounts:o,statusOfAddAccount:o}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadMetaTraderAccounts()},addAccount:function(t,e,n,a){var i=this.status("statusOfAddAccount");if(i(c),!(t&&e&&n&&a))return i(d);r.metaTraderAddAccount({accountType:t,platformType:e,currency:n,leverage:a}).then(function(t){return i(l)}).catch(function(t){i(d)})}})}.call(e,n,e,t))&&(t.exports=a)},2655:function(t,e){t.exports='<div class="add-account"><div class="add-account-title"><%=__(\'metatrader.add-account.title\')%></div><div class="add-account-form"></div></div><div class="form-col btn-col"><button class="btn btn-primary btn-mobile-bottom btn-block fn-add-account"><%- __(\'actions.create\') %></button></div><div class="loading-wrapper"></div>'},2656:function(t,e,n){(function(a,i){var r;void 0!==(r=function(t,e,a){var r=n(0),s=n(13),o=n(400),d=o.DepositPopupView,l=n(28),c=n(2),u=n(2657),m=n(74),f=n(199),h=n(200),p=n(7),v=n(9),g=n(825),b=n(2658),_=n(827),T=n(828),A=r.template(n(2659)),w=n(379),C=w.REAL,y=w.ERROR,x=w.SUCCESS,I=w.MANUAL_SELECT_AMOUNT,E=w.CANCELLED,S=d.extend({className:"metatrader-deposit",name:"metatrader-deposit",initialize:function(t){s.prototype.initialize.apply(this,arguments),this.model=new u,this.listenTo(this.model,"change:statusOfFrame",this.frameLoaded),this.listenTo(this.model,"change:statusOfAllAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfDepositAmountConfig",this.loadCompleted),this.listenTo(this,"form:depositForm:change:field_platformAccountId",this.onAccountChanged),this.render()},render:function(){return s.prototype.render.call(this),this.$el.html(A(this.options)),this.addChildView(".deposit-popup",l,{parent:this.$el,translucent:"2"}),this},loadCompleted:function(){var t=this.model.get("statusOfAllAccounts"),e=this.model.get("statusOfDepositAmountConfig");if(t===y||e===y)return this.loadError();t===x&&e===x&&this.createForm()},loadError:function(){this.removeChildView(".deposit-popup"),c.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us.funded.client"))})},createForm:function(){var t=this,e=this.$el.find(".deposit-form"),n=r.filter(this.model.get("allAccounts"),function(e){return t.model.hasPlatformAccountId(e)&&t.model.isTradingAccountType(e,C)}),a={form:[[{disable:!1,template:m.selectBox,title:__("auto.withdrawal.trading_account"),name:"field_platformAccountId",options:n,transformOptionsValue:function(t){return t.accountId},transformOptionText:function(t){var e=t.accountId,n=t.tradePlatformType,a=t.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+e+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("auto.withdrawal.trading_account"))}}}]]},i=new h(a);this.formView=new f({model:i,$parent:e}),this.formView.show();for(var s in this.formView.form._fields){var o=this.formView.form._fields[s];this.listenTo(o,"all",function(e,n,a){t.trigger("form:depositForm:"+e+":"+n._name,n,a)})}this.removeChildView(".deposit-popup")},showManualDepositPopup:function(t){var e=this,n=new b(t),a=new g({parent:i("body"),source:"metatrader",model:n,onClose:function(){a=null,e.removeChildView(".deposit-popup")},onSuccess:function(){var t=e.formView.form.getField("field_platformAccountId").value(),i=e.model.getAccountById(t);a=null,e.model.set("amount",n.get("amount")),e.model.loadFrame(i)}})},showFirstDepositBonusPopup:function(t){var e=this,n=new _(t),a=new T({parent:i("body"),source:"metatrader",model:n,onClose:function(){var t=e.formView.form.getField("field_platformAccountId").value(),i=e.model.getAccountById(t);return a=null,E===n.get("status")?void e.removeChildView(".deposit-popup"):(e.model.set("bonusApplied",n.get("bonusApplied")),I===n.get("status")?e.showManualDepositPopup(i):(e.model.set("amount",n.get("selectedAmount")),void e.model.loadFrame(i)))},isHeaderShowed:!0,caption:__("deposit_bonus_table.popup.header")})},onAccountChanged:function(){var t=this.formView.form.getField("field_platformAccountId").value(),e=this.model.getAccountById(t);this.addChildView(".deposit-popup",l,{parent:this.$el,translucent:"2"}),this.isFirstDepositBonusEnabled(e.currency)?this.showFirstDepositBonusPopup(e):v.isManualDepositAmountNeeded()?this.showManualDepositPopup(e):(this.model.set("amount",this.model.getDefaultAmount()),this.model.loadFrame(e))},frameLoaded:function(){var t=this.model,e=t.get("statusOfFrame");if(e===y)return this.loadError();e===x&&(this.removeChildView(".deposit-popup"),this.renderFrame(t.get("depositHref")),this.subscribe())},close:function(){},isFirstDepositBonusEnabled:function(t){return v.isBonusesEnabled()&&v.isMtFirstDepositBonusEnabled()&&!p.isFirstDeposit()&&p.getUserAwardsModel().isFirstDepositExists(t)}});a.exports=S}.call(e,n,e,t))&&(t.exports=r)}).call(e,n(0),n(6))},2657:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(384),r=n(0),s=n(8),o=n(7),d=n(25),l=n(9),c=n(379),u=c.EMPTY,m=c.LOADING,f=c.ERROR,h=c.SUCCESS,p=c.PAY_GATE,v=c.SOLID_PAYMENTS,g=c.SAFE_CHARGE,b=c.PRAXIS;a.exports=i.extend({defaults:function(){return{amount:0,bonusApplied:!1,statusOfFrame:u,statusOfAllAccounts:u,cashierLocales:{en:"en_US",de:"de_DE",cn:"zh_CN",fr:"fr_FR",nl:"nl_NL",it:"it_IT",ja:"js_JP",es:"es_ES",ru:"ru_RU",ar:"ar_AA",pt:"bt_BR",sv:"sv_SV",da:"da_DK",ro:"ro_RO",bg:"bg_BG",pl:"pl_PL",hu:"hu_HU",id:"in_ID"}}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadAllAccounts(),this.loadDepositAmountConfig()},getBaseUrl:function(){return"https://"+window._app.getPlatformHost()+"/trading-platform/"},loadFrame:function(t){var e=this.status("statusOfFrame");e(m);var n=this.getBaseUrl(),a={accountId:t.accountId,amount:this.choseDepositAmount(),country:o.getCountry(),currency:t.currency,locale:this.getCashierLocale(d.getLanguage()),bonusApproved:this.isBonusApplied()},i=l.getPaymentsServiceVendor();i!==p&&i!==g&&i!==b||(a.successUrl=encodeURIComponent(n+"deposit.html"),a.failUrl=encodeURIComponent(n+"deposit_failed.html")),i===v&&(a.successUrl=encodeURIComponent(n+"?path=solid_payments_deposit_sucess&first_deposit="+this.get("doFirstDeposit")+"&totalAmount="+this.getAmount()+"&atmAmount="+this.getAtmAmount()+"&currency="+o.getUserCurrency()),a.failUrl=encodeURIComponent(n+"?path=solid_payments_deposit_failed")),s.getDepositUrl(a).then(function(t){e(h,{depositHref:t.data})}).catch(function(t){e(f)})},getAccountById:function(t){return r.find(this.get("allAccounts"),function(e){return e.accountId===t})},getCashierLocale:function(t){return this.get("cashierLocales")[t]?this.get("cashierLocales")[t]:this.get("cashierLocales").en},getAtmAmount:function(){var t=this.get("atmAmount");return-1===t?"Other":r.isUndefined(t)?"N/A":t},isBonusApplied:function(){return!0===this.get("bonusApplied")},choseDepositAmount:function(){return r.isNaN(this.getAmount())||-1===this.getAmount()?this.getDefaultAmount():this.getAmount()},getAmount:function(){return this.get("amount")},getAmountConfig:function(){return this.get("amountConfig")},getDefaultAmount:function(){var t=this.getAmountConfig();return t&&t.defaultAmount}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2658:function(t,e,n){var a;void 0!==(a=function(t,e,a){var i=n(826);a.exports=i.extend({initialize:function(t){this.account=t,this.loadDepositAmountsConfigForTradingAccount(this.account.accountId)},getCurrencySymbol:function(){return __currency(this.account.currency)}})}.call(e,n,e,t))&&(t.exports=a)},2659:function(t,e){t.exports='<div class="deposit-popup"><div class="deposit-form"></div><form id="deposit-frame-form" target="deposit-frame" method="POST"></form><iframe id="deposit-frame" name="deposit-frame" style="visibility: hidden"></iframe></div>'},2660:function(t,e,n){(function(a,i){var r;void 0!==(r=function(t,e,a){var i=n(0),r=n(13),s=n(28),o=n(2661),d=n(74),l=n(199),c=n(200),u=n(6),m=n(2),f=i.template(n(2662)),h=n(379),p=h.ERROR,v=h.SUCCESS,g=r.extend({className:"metatrader-bonuses",events:function(){return i.extend({},i.result(r.prototype,"events"),{"click .fn-tab":"changeTab"})},initialize:function(t){r.prototype.initialize.apply(this,arguments),this.model=new o,i.isEmpty(t.model.get("bonusesTab"))||this.model.setCurrentTabById(t.model.get("bonusesTab")),this.listenTo(this.model,"change:selectedAccountBonusesStatus",this.loadCompleted),this.listenTo(this.model,"change:currentTabId",this.updateTab),this.listenTo(this,"form:bonusesForm:change:field_platformAccountId",this.changeAccount)},loadCompleted:function(){var t=this.model.get("selectedAccountBonusesStatus");if(t===p)return this.loadError();t===v&&(this.removeChildView(".metatrader-bonuses"),this.showTemplate())},loadError:function(){this.removeChildView(".metatrader-bonuses"),m.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},showTemplate:function(){var t=this;this.$el.html(f({model:this.model.toJSON()})),this.updateTab();var e=this.$el.find(".bonuses-form"),n=this.model.get("metaTraderAccounts"),a=i.find(n,function(e){return e.platformAccountId===t.model.get("selectedAccountId")}).platformAccountId,r={form:[[{disable:!1,template:d.selectBox,title:__("metatrader.bonuses.account")+":",name:"field_platformAccountId",savedData:a,options:n,transformOptionsValue:function(t){return t.platformAccountId},transformOptionText:function(t){var e=t.accountId,n=t.tradePlatformType,a=t.currency;return n+" Trader - "+e+" - "+String(a).toUpperCase()},translationKey:""}]]},s=new c(r);this.formView=new l({model:s,$parent:e}),this.formView.show();for(var o in this.formView.form._fields){var u=this.formView.form._fields[o];this.listenTo(u,"all",function(e,n,a){t.trigger("form:bonusesForm:"+e+":"+n._name,n,a)})}return this},updateTab:function(){var t=this.model,e=__currency(i.find(t.get("metaTraderAccounts"),{platformAccountId:t.get("selectedAccountId")}).currency),n=this.model.getCurrentTabData(),a=n.view,r=n.model;this.addChildView(".tab-content",a,{model:new r({bonuses:t.getBonuses(),accountCurrency:e})}),this.$(".header-container-xs .caption").html(__(this.model.getCurrentTabName())),this.$(".tab").removeClass("active");var s=this.model.getCurrentTabId();this.$(".tab[data-tab-id="+s+"]").addClass("active")},changeTab:function(t){this.model.setCurrentTabById(u(t.currentTarget).attr("data-tab-id"))},changeAccount:function(t){var e=this.formView.form.getField("field_platformAccountId").value();this.model.loadMetaTraderBonusesForAccount(e),this.addChildView(".metatrader-bonuses",s,{parent:this.$el,translucent:"2"})},render:function(){return r.prototype.render.apply(this,arguments),this.addChildView(".metatrader-bonuses",s,{parent:this.$el,translucent:"2"}),this}});a.exports=g}.call(e,n,e,t))&&(t.exports=r)}).call(e,n(0),n(6))},2661:function(t,e,n){(function(a){var i;void 0!==(i=function(t,e,a){var i=n(384),r=n(2414),s=n(2417),o=n(2420),d=n(2421),l=n(0),c=n(379),u=c.EMPTY;c.LOADING,c.ERROR,c.SUCCESS;a.exports=i.extend({defaults:function(){return{tabs:[{id:"in-progress",name:__("bonus.tab.in_progress"),viewClass:r,modelClass:o},{id:"completed",name:__("bonus.tab.completed"),viewClass:s,modelClass:d}],currentTabId:"in-progress",defaultTabId:"in-progress",selectedAccountId:u,selectedAccountBonuses:[],statusOfMetaTraderAccountsWithBonuses:u,metaTraderAccounts:[]}},initialize:function(){var t=this;i.prototype.initialize.apply(this,arguments),this.loadMetaTraderAccountsWithBonuses().then(function(){var e=l.first(t.get("metaTraderAccounts")).platformAccountId;t.set("selectedAccountId",e),t.loadMetaTraderBonus(e)})},loadMetaTraderBonusesForAccount:function(t){this.set("selectedAccountId",t),this.loadMetaTraderBonus(t)},getCurrentTab:function(){return l.findWhere(this.get("tabs"),{id:this.getCurrentTabId()})},getCurrentTabData:function(){var t=this.getCurrentTab();return{view:t.viewClass,model:t.modelClass}},getCurrentTabId:function(){var t=this.get("currentTabId");return t||this.get("defaultTabId")},getCurrentTabName:function(){return this.getCurrentTab().name},getBonuses:function(){return this.get("selectedAccountBonuses")},setCurrentTabById:function(t){var e=this.getTabById(t);return e&&this.set({currentTabId:e.id,currentTabName:e.name}),e},getTabById:function(t){return l.findWhere(this.get("tabs"),{id:t})}})}.call(e,n,e,t))&&(t.exports=i)}).call(e,n(0))},2662:function(t,e){t.exports='<div class="bonuses"><div class="bonuses-form"></div><div class="visible-xs header-container-xs"><div class="left flex fn-close-popup flex-valign-center btn"><div class="icon arrow"></div><b><%-__(\'actions.back\') %></b></div><div class="caption flex flex-valign-center flex-align-center"> <%-model.currentTabName || model.currentTabNameMobile%> </div><div class="right flex flex-valign-center btn"></div></div><div class="bonus-progress-content"><div class="modal-dialog-container"></div><div class="bonuses_tabs flex flex-row flex-align-start hidden-xs"> <% _.each(model.tabs, function(v) { %> <div class="tab fn-tab flex flex-stretch flex-valign-center active <%- model.currentTabId == v.id ? \'active\' : \'\' %>" data-tab-id="<%- v.id %>"><%- v.name %></div> <% }) %> </div><div class="tab-content"></div></div></div>'}});