webpackJsonp([9],{1995:function(e,t,n){var a;void 0!==(a=function(e,t,a){var i=n(2817),r=n(2819);a.exports={MetatraderPopupModel:r,MetatraderPopupView:i}}.call(t,n,t,e))&&(e.exports=a)},2175:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(16),s=n(9);a.exports=r.extend({defaults:function(){return{bonuses:[]}},load:function(){var e=this;return s.queryBonusProgress().then(function(t){return e.set({bonuses:t.data})})},getBonuses:function(){return this.get("bonuses")},hasBonuses:function(){return i.isEmpty(this.getBonuses())},filter:function(e){return function(t){return i.contains(e,t.status)}}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2304:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(13),s=n(25);a.exports=r.extend({enrichBonusInfo:function(e,t){var n=this;return i.isArray(e)?i.each(e,function(e){return n.enrich(e,t)}):this.enrich(e,t),e},enrich:function(e,t){return i.isEmpty(e)||(e.statusClass=this.getStatusClass(e),e.statusLabel=this.formatStatus(e),e.title=this.getTitle(e),e.amountTitle=this.getAmountTitle(e,t),e.note=this.getNote(e,t),e.points=this.getBonusPoints(e),e.pointsEarned=this.getBonusPointsEarned(e),e.progressPercent=this.calculateProgressPercent(e),e.progressClass=this.getProgressClass(e),e.expirationTime=this.formatBonusExpirationTime(e,!1),e.expirationTimeShort=this.formatBonusExpirationTime(e,!0),e.expirationDate=this.formatBonusExpirationDate(e),e.helpMessage=this.getHelpMessage(e,t)),e},getBonusPoints:function(e){return __("bonus.item.points",e.currentPoints,e.targetPoints)},getBonusPointsEarned:function(e){return __("bonus.item.points.earned",e.currentPoints,e.targetPoints)},calculateProgressPercent:function(e){return 100*e.currentPoints/e.targetPoints},getProgressClass:function(e){switch(e.status){case"COMPLETED":case"EXPIRED":case"LOST":case"WAITING":return"inactive";default:return""}},getStatusClass:function(e){return e.status.toLowerCase()},getAmountTitle:function(e,t){return t+e.volume+" "+this.getTitle(e)},getTitle:function(e){switch(e.type){case"COMPLIANCE":return __("bonus.item.compliance.title");case"WELCOME_BONUS":return __("bonus.item.wb.title");case"PENDING_BONUS":return __("bonus.item.pb.title");case"FD_BONUS":return __("bonus.item.fd.title");case"SMS_BONUS":return __("bonus.item.sms.title");case"VERIFY_POI":return __("bonus.item.id.title");case"VERIFY_POR":return __("bonus.item.residence.title");case"UNKNOWN":return __("bonus.item.unknown.reason."+e.reason);default:return""}},formatStatus:function(e){switch(e.status){case"IN_PROGRESS":return __("bonus.item.status.in_progress");case"WAITING":return __("bonus.item.status.waiting");case"COMPLETED":return __("bonus.item.status.completed");case"EXPIRED":return __("bonus.item.status.expired");case"LOST":return __("bonus.item.status.lost");default:return""}},getHelpMessage:function(e,t){switch(e.status){case"IN_PROGRESS":return __("bonus.item.ip.help.message");case"WAITING":return __("bonus.item.waiting.help.message");case"COMPLETED":return __("bonus.item.completed.help.message",t+e.volume);case"EXPIRED":return __("bonus.item.expired.help.message");case"LOST":return __("bonus.item.lost.help.message");default:return""}},getNote:function(e,t){switch(e.status){case"LOST":return"";default:return __("bonus.item.note",t+e.volume)}},formatBonusExpirationTime:function(e,t){var n=e.expiration,a=__("bonus.item.expiration.format",n.days,n.hours,n.minutes);return(t?__("bonus.item.expiration.short"):__("bonus.item.expiration"))+" "+a},formatBonusExpirationDate:function(e){var t=new Date(e.expireAt),n=s.splitByComma(__("calendar.month_names.short"));return t.getDate()+" "+n[t.getMonth()]+", "+t.getFullYear()}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2585:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(2304),s=i.template(n(2586)),o=i.template(n(2587));a.exports=r.extend({className:"bonus-in-progress",render:function(){return r.prototype.render.call(this),this.$el.html(s({bonusTemplate:o,in_progress:this.enrichBonusInfo(this.model.getInProgressBonus(),this.model.getAccountCurrency()),waiting:this.enrichBonusInfo(this.model.getWaitingBonuses(),this.model.getAccountCurrency())})),this}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2586:function(e,t){e.exports='<div class="bonus-progress-body flex flex-column"><div class="forms-container flex flex-column flex-stretch"><div class="flex flex-column flex-stretch min-height-content"> <% if (_.isEmpty(in_progress)) { %> <div class="empty"> <%=__(\'bonus.empty.no.inprogress.message\')%> <a href="mailto:<%=__(\'brand.support.email\')%>"><%=__(\'bonus.nobonus.contact.us\')%></a></div> <% } else { %> <div class="header"><%=__(\'bonus.status.inprogress\')%></div> <%=bonusTemplate({ bonus: in_progress })%> <br><br> <% if (_.isEmpty(waiting)) { %> <div class="empty"> <%=__(\'bonus.empty.no.next.message\')%> <a href="mailto:<%=__(\'brand.support.email\')%>"><%=__(\'bonus.nobonus.contact.us\')%></a></div> <% } else { %> <div class="header"><%=__(\'bonus.status.next\')%></div> <% _.each(waiting, function(waiting_bonus) { %> <%=bonusTemplate({ bonus: waiting_bonus })%> <% }) %> <% } %> <% } %> </div></div></div>'},2587:function(e,t){e.exports='<div class="bonus-line <%= bonus.statusClass %>"><div class="bonus-title"><span class="title"><%= bonus.title %></span><span class="note"><%= bonus.note %></span></div><div class="bonus-progress"><div class="points hidden-xs"><%= bonus.points %></div><div class="bonus-progress-wrapper visible-xs visible-sm visible-md"><span class="earned-points <%= bonus.statusClass %>"><%= bonus.points %></span><span class="expiration-short"><%= bonus.expirationTimeShort %></span></div><div class="progress-bar <%= bonus.progressClass %>"><div style="width: <%= bonus.progressPercent %>%"></div></div><div class="expiration hidden-xs"><%= bonus.expirationTime %></div></div><div class="bonus-help"><%= bonus.helpMessage %></div></div>'},2588:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(2304),s=i.template(n(2589)),o=i.template(n(2590));a.exports=r.extend({className:"bonus-completed",render:function(){return r.prototype.render.call(this),this.$el.html(s({bonusTemplate:o,completed:this.enrichBonusInfo(this.model.getCompletedBonuses(),this.model.getAccountCurrency())})),this}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2589:function(e,t){e.exports='<div class="bonus-progress-body flex flex-column"><div class="forms-container flex flex-column flex-stretch"><div class="flex flex-column flex-stretch min-height-content"> <% if (_.isEmpty(completed)) { %> <div class="empty"> <%=__(\'bonus.empty.no.completed.message\')%> <a href="mailto:<%=__(\'brand.support.email\')%>"><%=__(\'bonus.nobonus.contact.us\')%></a></div> <% } else { %> <div class="grid-12-equalHeight header-grid hidden-xs"><div class="col-5"><%=__(\'bonus.item.completed.name\')%></div><div class="col-2"><%=__(\'bonus.item.completed.expiration.title\')%></div><div class="col-3"><%=__(\'bonus.item.completed.points.earned.title\')%></div><div class="col-2"><%=__(\'bonus.item.status\')%></div></div> <% _.each(completed, function(completed_bonus) { %> <%=bonusTemplate({ bonus: completed_bonus })%> <% }) %> <% } %> </div></div></div>'},2590:function(e,t){e.exports='<div class="grid-12-equalHeight bonus-line-grid hidden-xs"><div class="col-5 title"><%= bonus.amountTitle %></div><div class="col-2 expiration"><%= bonus.expirationDate %></div><div class="col-3 points"><%= bonus.pointsEarned %></div><div class="col-2"><div class="status"><span class="<%= bonus.statusClass %>"><%= bonus.statusLabel %></span><span class="question-tooltip" aria-label="<%= bonus.helpMessage %>" data-tooltip-align="right"></span></div></div></div><div class="grid-12-equalHeight bonus-line-grid visible-xs visible-sm visible-md"><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5 title"><%=__(\'bonus.item.completed.name\')%></div><div class="col-7 title"><%= bonus.amountTitle %></div></div></div><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5"><%=__(\'bonus.item.completed.expiration.title\')%></div><div class="col-7 expiration"><%= bonus.expirationDate %></div></div></div><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5"><%=__(\'bonus.item.completed.points.earned.title\')%></div><div class="col-7 points"><%= bonus.pointsEarned %></div></div></div><div class="col-12 bonus-line-column"><div class="grid-12-equalHeight-middle"><div class="col-5"><%=__(\'bonus.item.status\')%></div><div class="col-7 status <%= bonus.statusClass %>"><%= bonus.statusLabel %></div></div></div></div>'},2591:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(2175);a.exports=r.extend({defaults:function(){return{in_progress:{},waiting:[]}},initialize:function(){r.prototype.initialize.apply(this,arguments),this.load()},load:function(){this.set({in_progress:this.parseInProgressBonus(),waiting:i.filter(this.getBonuses(),this.filter(["WAITING"]))})},parseInProgressBonus:function(){var e=i.filter(this.getBonuses(),this.filter(["IN_PROGRESS"]));return i.isEmpty(e)?{}:e[0]},getInProgressBonus:function(){return this.get("in_progress")},getWaitingBonuses:function(){return this.get("waiting")},getAccountCurrency:function(){return this.get("accountCurrency")}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2592:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(2175);a.exports=r.extend({defaults:function(){return{completed:[]}},initialize:function(){this.load()},load:function(){this.set({completed:i.filter(this.getBonuses(),this.filter(["COMPLETED","LOST","EXPIRED"]))})},getCompletedBonuses:function(){return this.get("completed")},getAccountCurrency:function(){return this.get("accountCurrency")}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2817:function(e,t,n){(function(a,i){var r;void 0!==(r=function(e,t,a){var i=n(0),r=n(7),s=n(24),o=n(3),d=n(6),l=n(10),c=n(60),u=n(9),m=n(908),f=i.template(n(2818)),h=n(5),p=h.SUCCESS,v=h.ERROR,g=h.ACTIVE,b=s.extend({name:"metatrader-popup",events:function(){return i.extend({},i.result(s.prototype,"events"),{"click .fn-tab":"changeTab","click .fn-reset-password":"resetPassword"})},initialize:function(e){e.tabId&&this.model.set("currentTabId",e.tabId),e.bonusesTab&&this.model.set("bonusesTab",e.bonusesTab),s.prototype.initialize.apply(this,arguments),this._metatraderLeverage=new m,this.listenTo(this.model,"change:statusOfMetaTraderTradingCentral",this.loadCompleted),this.listenTo(this.model,"change:currentTabId",this.updateTab),this.listenTo(o,"showMetatraderTabById",this.setTabById),this.listenTo(this._metatraderLeverage,"change:statusOfMetaTraderAccounts",this.metaTraderAccountsChanged)},loadCompleted:function(){var e=this.model.get("statusOfMetaTraderTradingCentral");if(e===v)return this.loadError();e===p&&(this.render(),this.updateTab())},loadError:function(){new c({parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))}),this.close()},render:function(){return s.prototype.render.call(this),this.setContent(f({tabs:this.model.get("tabs"),currentTabId:this.model.get("currentTabId"),tradingCentral:this.model.get("tradingCentral"),resetPassword:this.model.get("resetPassword"),isMT5PlatformEnabled:l.isMT5PlatformEnabled(),isConditionsTabEnabled:l.isMetaTraderConditionsTabEnabled()})),this},updateTab:function(){var e=this.model.getCurrentTabView(),t=this.model.getCurrentTabId();this.addChildView(".tab-content",e,{model:this.model}),this.$(".header-container-xs .caption").html(__(this.model.getCurrentTabTitle())),this.$(".tab").removeClass("active"),this.$(".tab[data-tab-id="+t+"]").addClass("active")},changeTab:function(e){this.model.setCurrentTabById(r(e.currentTarget).attr("data-tab-id"))},setTabById:function(e){this.model.setCurrentTabById(e),this._metatraderLeverage.reloadMetaTraderAccounts()},resetPassword:function(){var e=d.getCustomerId(),t=d.getEmail();return u.forgotPasswordById(e).then(function(){new c({text:__("mt4.password.need.reset",t),isHeaderShowed:!1,okBtnText:__("ok"),isShowCloseForMobile:!1})})},metaTraderAccountsChanged:function(){this.showLeverageTab(),this.showBonusesTab(),this.showFundsTransferTab()},showLeverageTab:function(){var e=this;if(l.isMetaTraderInternalLeverageEnabled()){var t=i.filter(this._metatraderLeverage.get("metaTraderAccounts"),function(t){return e.model.hasPlatformAccountId(t)&&e.model.isTradingAccountStatus(t,g)}),n=this._metatraderLeverage.get("availableLeverages"),a=i.isEmpty(n)||1===n.length&&i.every(t,function(e){return e.leverage===n[0]});if(i.isEmpty(t)||a)return;this.$el.find('li[data-tab-id="metatrader-leverage"]').removeClass("hidden")}},showBonusesTab:function(){var e=this;if(l.isBonusesEnabled()){var t=i.filter(this._metatraderLeverage.get("metaTraderAccounts"),function(t){return e.model.hasPlatformAccountId(t)&&e.model.isTradingAccountStatus(t,g)&&t.hasBonuses});if(i.isEmpty(t))return;this.$el.find('li[data-tab-id="metatrader-bonuses"]').removeClass("hidden")}},showFundsTransferTab:function(){var e=this;if(l.isMetaTraderInternalFundsTransferEnabled()){var t=i.filter(this._metatraderLeverage.get("metaTraderAccounts"),function(t){return e.model.hasPlatformAccountId(t)&&e.model.isTradingAccountStatus(t,g)});i.isEmpty(t)||this.$el.find('li[data-tab-id="metatrader-funds-transfer"]').removeClass("hidden")}}});a.exports=function(e){return new b(i.extend({},e,{headerStyle:"default",isHeaderShowed:!0,closeIconStyle:"blue",headerBgStyle:"transparent"}))}}.call(t,n,t,e))&&(e.exports=r)}).call(t,n(0),n(7))},2818:function(e,t){e.exports='<div class="metatrader-popup"><div class="modal-dialog-container"></div><div class="metatrader-body flex-stretch"><div class="tabs hidden-xs"><ul> <% _.each(tabs, function(tab) { %> <li class="tab fn-tab <%- currentTabId == tab.id ? \'active\' : \'\' %> tab-<%= tab.id%> <%- tab.hidden ? \'hidden\' : \'\' %>" data-tab-id="<%- tab.id %>"><a><%- __(tab.title) %></a></li> <% }) %> <% if (tradingCentral) { %> <li class="tab"><a href="<%= tradingCentral %>" target="_blank"><%= __(\'metatrader.technical-analysis.title\') %></a></li> <% } %> <% if (isConditionsTabEnabled) { %> <li class="tab"> <%= __(\'metatrader.trading-conditions.title\') %> </li> <% } %> <% if (isMT5PlatformEnabled) { %> <li class="tab"> <%= __(\'metatrader.mt5-platform.title\') %> </li> <% } %> <% if (resetPassword) { %> <li class="tab fn-reset-password"><a><%= __(\'metatrader.reset-password.title\') %></a></li> <% } %> </ul></div><div class="tab-content"></div></div></div>'},2819:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(438),s=n(2820),o=n(2823),d=n(2826),l=n(2828),c=n(2831),u=n(2834),m=n(9),f=n(117),h=n(5),p=h.SUCCESS,v=h.ERROR,g=h.LOADING;a.exports=r.extend({defaults:function(){return{tabs:[{id:"metatrader-accounts",url:"metatrader-accounts",title:"metatrader.accounts.title",view:s,hidden:!1},{id:"metatrader-funds-transfer",url:"metatrader-funds-transfer",title:"metatrader.funds-transfer.title",view:o,hidden:!0},{id:"metatrader-leverage",url:"metatrader-leverage",title:"metatrader.leverage.title",view:d,hidden:!0},{id:"metatrader-add-account",url:"metatrader-add-account",title:"metatrader.add-account.title",view:l,hidden:!1},{id:"metatrader-deposit",url:"metatrader-deposit",title:"actions.deposit",view:c,hidden:!1},{id:"metatrader-bonuses",url:"metatrader-bonuses",title:"metatrader.bonuses.title",view:u,hidden:!0}],currentTabId:"metatrader-accounts",defaultTabId:"metatrader-accounts",resetPassword:!1}},initialize:function(){var e=this;r.prototype.initialize.apply(this,arguments);var t=this.status("statusOfMetaTraderTradingCentral");return t(g),m.getMetaTraderTradingCentral().then(function(n){f.isExternalLoginDetected()&&e.set("resetPassword",!0),t(p,{tradingCentral:n.data})}).catch(function(e){t(v)})},getCurrentTab:function(){return i.findWhere(this.get("tabs"),{id:this.getCurrentTabId()})},getCurrentTabId:function(){var e=this.get("currentTabId");return e||(e=this.get("defaultTabId")),e},getCurrentTabTitle:function(){var e=this.getCurrentTab(),t=null;return e&&(t=e.title||t),t},getCurrentTabView:function(){var e=this.getCurrentTab(),t=null;return e&&(t=e.view||t),t},getTabById:function(e){return i.findWhere(this.get("tabs"),{id:e})},setCurrentTabById:function(e){var t=this.getTabById(e);return t&&this.set({currentTabId:t.id}),t}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2820:function(e,t,n){(function(a,i){var r;void 0!==(r=function(e,t,a){var i=n(0),r=n(13),s=n(32),o=n(2821),d=n(7),l=n(3),c=n(6),u=n(34),m=n(10),f=i.template(n(2822)),h=n(5),p=h.ACTIVE,v=h.PENDING,g=h.ERROR,b=h.SUCCESS,_=r.extend({className:"metatrader-accounts",events:function(){return i.extend({},i.result(r.prototype,"events"),{"click .fn-show-add-account-tab":"showAddAccountTab","click .fn-toggle":"toggleRow"})},initialize:function(){r.prototype.initialize.apply(this,arguments),this.model=new o,this.listenTo(this.model,"change:statusOfMetaTraderAccounts",this.loadCompleted)},loadCompleted:function(){var e=this.model.get("statusOfMetaTraderAccounts");if(e===g)return this.loadError();e===b&&(this.removeChildView(".metatrader-accounts"),this.showTemplate())},loadError:function(){this.removeChildView(".metatrader-accounts"),l.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},showTemplate:function(){var e=this,t=i.filter(this.model.get("metaTraderAccounts"),function(t){return e.model.hasPlatformAccountId(t)&&(e.model.isTradingAccountStatus(t,p)||e.model.isTradingAccountStatus(t,v))}),n=(100*c.getUserAccountSettingsModel().getLiquidationLevel()).toFixed(),a=(100*c.getUserAccountSettingsModel().getMarginAlertLevel2()).toFixed(),r=this.isBonusesEnabled();return this.$el.html(f({accounts:t,numbro:u,liquidationLevel:n,marginAlertLevel2:a,isBonusesEnabled:r})),this},render:function(){return r.prototype.render.apply(this,arguments),this.addChildView(".metatrader-accounts",s,{parent:this.$el,translucent:"2"}),this},showAddAccountTab:function(){l.trigger("showMetatraderTabById","metatrader-add-account")},toggleRow:function(e){var t=d(e.target),n=t.closest(".row");d(n).hasClass("expanded")?(d(n).removeClass("expanded"),t.html("+")):(d(n).addClass("expanded"),t.html("-"));var a=n.nextElementSibling;d(a).hasClass("expanded")?d(a).removeClass("expanded"):d(a).addClass("expanded")},isBonusesEnabled:function(){return m.isBonusesEnabled()}});a.exports=_}.call(t,n,t,e))&&(e.exports=r)}).call(t,n(0),n(7))},2821:function(e,t,n){var a;void 0!==(a=function(e,t,a){var i=n(438),r=n(5),s=r.EMPTY;a.exports=i.extend({defaults:function(){return{statusOfMetaTraderAccounts:s}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadMetaTraderAccounts()}})}.call(t,n,t,e))&&(e.exports=a)},2822:function(e,t){e.exports='<table><thead class="columns"><tr><th class="column column-account"><%=__(\'metatrader.accounts.account\')%></th><th class="column column-status"><%=__(\'metatrader.accounts.status\')%></th><th class="column column-action hidden-xs"><button class="btn btn-default btn-mobile-bottom fn-show-add-account-tab"><span class="icon-circle">+</span><%=__(\'metatrader.accounts.actions.add-account\')%></button></th></tr></thead><tbody class="rows"> <% _.each(accounts, function(account) { %> <tr class="row"><td class="row-accounts"><span class="icon-square fn-toggle">+</span> <%- account.tradePlatformType %> - <%- account.accountId %> - <%- account.currency %> </td><td class="row-status"><%=__(\'metatrader.accounts.status.\' + account.tradingAccountStatus)%> - <%=__(\'metatrader.accounts.type.\' + account.tradingAccountType)%></td><td class="metatrader-accounts-actions actions hidden-xs"> <% if(account.webLink) { %> <a class="btn btn-icon" href="<%- account.webLink %>" target="_blank" title="<%=__(\'metatrader.accounts.sirix\')%>"><i class="icon icon-launch-sirix-blue"></i></a> <% } %> <% if(account.downloadLink) { %> <a class="btn btn-icon" href="<%- account.downloadLink %>" target="_blank" title="<%=__(\'metatrader.accounts.download.\' + account.tradePlatformType)%>"><i class="icon icon-download-blue"></i></a> <% } %> <% if(account.accountStatementLink) { %> <a class="btn btn-icon" href="<%- account.accountStatementLink %>" target="_blank" title="<%=__(\'metatrader.accounts.account-statement\')%>"><i class="icon icon-report-blue"></i></a> <% } %> </td></tr><tr class="row expandable-content"><td class="info-column-left"><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.balance\')%>"></span> <%=__(\'metatrader.accounts.balance\')%> </div><div><%- numbro(account.balance).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.equity\')%>"></span> <%=__(\'metatrader.accounts.equity\')%> </div><div><%- numbro(account.equity).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.free_margin\')%>"></span> <%=__(\'metatrader.accounts.free-margin\')%> </div><div><%- numbro(account.freeMargin).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.login\')%>"></span> <%=__(\'indigo.new_account.login_link\')%> </div><div><%- account.platformAccountId %></div></div></td><td class="info-column-right"><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.used_margin\')%>"></span> <%=__(\'metatrader.accounts.used-margin\')%> </div><div><%- numbro(account.usedMargin).formatForeignCurrency(__currency(account.currency)) %></div></div><div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'help.account.margin_level\',marginAlertLevel2,liquidationLevel)%>"></span> <%=__(\'metatrader.accounts.margin-level\')%> </div><div> <% if (account.marginLevel) {%> <%=account.marginLevel%>% <% } else { %> N/A <% } %> </div></div> <% if (isBonusesEnabled && account.hasCashBonuses) { %> <div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'funds.management.bonuses.help\')%>"></span> <%=__(\'metatrader.accounts.bonuses\')%> </div><div><%- numbro(account.accountBonusesAmount).formatForeignCurrency(__currency(account.currency)) %></div></div> <% } %> <div class="info-row"><div class="info-row-left"><span class="icon icon-help" aria-label="<%=__(\'funds.management.available.help\')%>"></span> <%=__(\'metatrader.accounts.available-withdrawal\')%> </div><div><%- numbro(account.availableForWithdrawal).formatForeignCurrency(__currency(account.currency)) %></div></div></td></tr> <% }) %> </tbody></table><button class="btn btn-primary btn-mobile-bottom fn-show-add-account-tab hidden-sm hidden-md hidden-lg"><span class="icon-circle">+</span><%=__(\'metatrader.accounts.actions.add-account\')%></button>'},2823:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(13),s=n(32),o=n(3),d=n(84),l=n(229),c=n(230),u=n(2824),m=i.template(n(2825)),f=n(5),h=f.LIVE_ACCOUNT_ID,p=f.EMPTY,v=f.ERROR,g=f.SUCCESS,b=f.VALIDATE,_=f.PROCESSING,T=r.extend({className:"metatrader-funds-transfer",events:function(){return this.addEvents(r)({"click .fn-funds-transfer":"fundsTranfer"})},initialize:function(e){r.prototype.initialize.apply(this,arguments),this.model=new u,this.listenTo(this.model,"change:statusOfAllAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfFundsTransfer",this.onStatusOfFundsTransferChanged)},loadCompleted:function(){var e=this.model.get("statusOfAllAccounts");if(e===v)return this.loadError();e===g&&(this.removeChildView(".loading-wrapper"),this.$el.find(".funds-transfer").removeClass("hidden"),this.createForm())},loadError:function(){this.removeChildView(".loading-wrapper"),o.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us.funded.client"))})},createForm:function(){var e=this,t=this.$el.find(".funds-transfer-form"),n=i.filter(this.model.get("allAccounts"),function(t){return e.model.hasPlatformAccountId(t)&&e.model.isTradingAccountType(t,h)}),a={form:[[{disable:!1,template:d.inputAddon,title:__("metatrader.funds-transfer.amount")+":",name:"field_amount",addonText:"$",type:"text",translationKey:"",validation:{filters:["trim","number"],rules:{min:[1,__("errors.required",__("metatrader.funds-transfer.amount"))],not_empty:__("errors.required",__("metatrader.funds-transfer.amount"))}},dependent:[{name:"field_platformAccountIdFrom",handler:this.changeInputAddonText.bind(this)}]}],[{disable:!1,template:d.selectBox,title:__("metatrader.funds-transfer.origin-account")+":",name:"field_platformAccountIdFrom",savedData:i.first(n).accountId,options:n,transformOptionsValue:function(e){return e.accountId},transformOptionText:function(e){var t=e.accountId,n=e.tradePlatformType,a=e.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+t+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.funds-transfer.origin-account"))}},dependent:[{name:"field_platformAccountIdTo",handler:this.removeAccountFromSelect}]}],[{disable:!1,template:d.selectBox,title:__("metatrader.funds-transfer.destination-account")+":",name:"field_platformAccountIdTo",options:n,transformOptionsValue:function(e){return e.accountId},transformOptionText:function(e){var t=e.accountId,n=e.tradePlatformType,a=e.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+t+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.funds-transfer.destination-account"))}},dependent:[{name:"field_platformAccountIdFrom",handler:this.removeAccountFromSelect}]}]]},r=new c(a);this.formView=new l({model:r,$parent:t}),this.formView.show(),this.formView.form.$(".field-type-input-addon > .field-status").html(__("metatrader.funds-transfer.amount.info"))},removeAccountFromSelect:function(e){this.$el.find('[disabled="disabled"]').removeAttr("disabled"),this.$el.find(".hidden").removeClass("hidden");var t=e.value();this.$el.find('[value="'+t+'"]').attr("disabled","disabled"),this.$el.find('[data-value="'+t+'"]').addClass("hidden")},changeInputAddonText:function(e){var t=this.model.get("allAccounts"),n=i.find(t,function(t){return t.accountId===e.value()});this.getAmountField().$el.find(".field-addonText").html(__currency(n.currency))},getAllAccountsIds:function(){return i.pluck(this.model.get("allAccounts"),"accountId")},render:function(){return r.prototype.render.call(this),this.$el.html(m(this.options)),this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"}),this.$el.find(".funds-transfer").addClass("hidden"),this},getAccountIdFromField:function(){return this.formView.form.getField("field_platformAccountIdFrom")},getAccountIdToField:function(){return this.formView.form.getField("field_platformAccountIdTo")},getAmountField:function(){return this.formView.form.getField("field_amount")},fundsTranfer:function(){this.model.set("statusOfFundsTransfer",b)},onStatusOfFundsTransferChanged:function(){var e=this.model,t=e.get("statusOfFundsTransfer"),n=this.getAccountIdFromField().value(),a=this.getAccountIdToField().value(),r=this.getAmountField().value();switch(t){case b:e.set("statusOfFundsTransfer",p);if(this.formView.form.validate())return;var o=this.model.get("allAccounts"),d=i.find(o,function(e){return e.accountId===n}),l=d.currency;return void e.fundsTransfer(+n,+a,+r,l);case _:return void this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"});case g:return this.removeChildView(".loading-wrapper"),this.getAmountField().value(""),this.getAccountIdToField().fieldVerified(),void this.getAccountIdToField().setTooltipMessage(__("metatrader.funds-transfer.success"));case v:return this.removeChildView(".loading-wrapper"),void this.loadError()}}});a.exports=T}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2824:function(e,t,n){var a;void 0!==(a=function(e,t,a){var i=n(438),r=n(9),s=n(5),o=s.EMPTY,d=s.ERROR,l=s.SUCCESS,c=s.PROCESSING;a.exports=i.extend({defaults:function(){return{statusOfAllAccounts:o,statusOfFundsTransfer:o}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadAllAccounts()},fundsTransfer:function(e,t,n,a){var i=this.status("statusOfFundsTransfer");if(i(c),!e||!t||!n)return i(d);var s={from:e,to:t,amount:n,currency:a};r.metaTraderFundsTransfer(s).then(function(e){return i(l)}).catch(function(e){i(d)})}})}.call(t,n,t,e))&&(e.exports=a)},2825:function(e,t){e.exports='<div class="funds-transfer"><div class="funds-transfer-info"><%=__(\'metatrader.funds-transfer.info\')%></div><div class="funds-transfer-form"></div></div><div class="form-col"><button class="btn btn-primary btn-mobile-bottom btn-block fn-funds-transfer"><%- __(\'actions.submit\') %></button></div><div class="loading-wrapper"></div>'},2826:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(13),s=n(32),o=n(3),d=n(84),l=n(229),c=n(230),u=n(908),m=i.template(n(2827)),f=n(5),h=f.ACTIVE,p=f.EMPTY,v=f.ERROR,g=f.SUCCESS,b=f.VALIDATE,_=f.PROCESSING,T=r.extend({className:"metatrader-leverage",events:function(){return this.addEvents(r)({"click .fn-leverage-change":"changeLeverage"})},initialize:function(e){r.prototype.initialize.apply(this,arguments),this.model=new u,this.listenTo(this.model,"change:statusOfMetaTraderAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfLeverageChange",this.onStatusOfLeverageChanged)},loadCompleted:function(){var e=this.model.get("statusOfMetaTraderAccounts");if(e===v)return this.loadError();e===g&&(this.removeChildView(".loading-wrapper"),this.$el.find(".meta-leverage").removeClass("hidden"),this.createForm())},loadError:function(){this.removeChildView(".loading-wrapper"),o.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},createForm:function(){var e=this,t=this.$el.find(".metatrader-leverage-form"),n=i.filter(this.model.get("metaTraderAccounts"),function(t){return e.model.hasPlatformAccountId(t)&&e.model.isTradingAccountStatus(t,h)}),a={form:[[{disable:!1,template:d.selectBox,title:__("metatrader.leverage.account")+":",name:"field_platformAccountId",savedData:i.first(n).accountId,options:n,transformOptionsValue:function(e){return e.accountId},transformOptionText:function(e){var t=e.accountId,n=e.tradePlatformType,a=e.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+t+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.leverage.account"))}}}],[{disable:!0,template:d.inputBox,title:__("metatrader.leverage.current-leverage")+":",name:"field_currentLeverage",translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.leverage.current-leverage"))}},dependent:[{name:"field_platformAccountId",handler:this.setLeverageByAccountId.bind(this)}]},{disable:!1,template:d.selectBox,title:__("metatrader.leverage.new-leverage")+":",name:"field_newLeverage",savedData:"1:"+i.first(this.model.get("availableLeverages")),options:this.model.get("availableLeverages"),transformOptionText:function(e){return"1:"+e},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.leverage.new-leverage"))}},dependent:[{name:"field_platformAccountId",handler:this.setLeverageOptionsByAccountId.bind(this)}]}]]},r=new c(a);this.formView=new l({model:r,$parent:t}),this.formView.show()},setLeverageByAccountId:function(e){var t=this.model.get("metaTraderAccounts"),n=i.find(t,function(t){return t.accountId===e.value()});this.getCurrentLeverageField().setValue("1:"+n.leverage)},setLeverageOptionsByAccountId:function(e){var t=this,n=this.model.get("availableLeverages"),a=this.model.get("metaTraderAccounts"),r=i.find(a,function(t){return t.accountId===e.value()});this.getNewLeverageField();n.forEach(function(e){t.$el.find('[value="'+e+'"]').removeAttr("disabled"),t.$el.find('[data-value="'+e+'"]').removeClass("hidden")}),this.$el.find('[value="'+r.leverage+'"]').attr("disabled","disabled"),this.$el.find('[data-value="'+r.leverage+'"]').addClass("hidden")},getAllAccountsIds:function(){return i.pluck(this.model.get("allAccounts"),"tpId")},render:function(){return r.prototype.render.call(this),this.$el.html(m(this.options)),this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"}),this.$el.find(".meta-leverage").addClass("hidden"),this},getAccountIdField:function(){return this.formView.form.getField("field_platformAccountId")},getCurrentLeverageField:function(){return this.formView.form.getField("field_currentLeverage")},getNewLeverageField:function(){return this.formView.form.getField("field_newLeverage")},changeLeverage:function(){this.model.set("statusOfLeverageChange",b)},onStatusOfLeverageChanged:function(){var e=this.model,t=e.get("statusOfLeverageChange"),n=+this.getAccountIdField().value(),a=+this.getNewLeverageField().value();switch(t){case b:e.set("statusOfLeverageChange",p);if(this.formView.form.validate())return;return void e.changeLeverage(n,a);case _:return void this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"});case g:return this.removeChildView(".loading-wrapper"),this.getNewLeverageField().value(""),this.getAccountIdField().fieldVerified(),void this.getAccountIdField().setTooltipMessage(__("metatrader.leverage.success"));case v:return void this.removeChildView(".loading-wrapper")}}});a.exports=T}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2827:function(e,t){e.exports='<div class="meta-leverage"><div class="metatrader-leverage-info"><%=__(\'metatrader.leverage.info.select\')%></div><div class="metatrader-leverage-info"><%=__(\'metatrader.leverage.info.period\')%></div><div class="metatrader-leverage-info"><%=__(\'metatrader.leverage.info.position-closed\')%></div><div class="metatrader-leverage-form"></div><div class="form-col"><button class="btn btn-primary btn-mobile-bottom btn-block fn-leverage-change"><%- __(\'actions.submit\') %></button></div><ul class="metatrader-leverage-list"><li><%=__(\'metatrader.leverage.info.profile\')%></li><li><%=__(\'metatrader.leverage.info.policy\')%></li></ul></div><div class="loading-wrapper"></div>'},2828:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(0),r=n(13),s=n(32),o=n(84),d=n(229),l=n(230),c=n(2829),u=n(3),m=n(10),f=i.template(n(2830)),h=n(5),p=h.EMPTY,v=h.ERROR,g=h.SUCCESS,b=h.VALIDATE,_=h.PROCESSING,T=r.extend({className:"metatrader-add-account",events:function(){return this.addEvents(r)({"click .fn-add-account":"addAccount"})},initialize:function(e){r.prototype.initialize.apply(this,arguments),this.model=new c,this.listenTo(this.model,"change:statusOfMetaTraderAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfAddAccount",this.onStatusOfAddAccountChanged)},loadCompleted:function(){var e=this.model.get("statusOfMetaTraderAccounts");if(e===v)return this.loadError();e===g&&(this.removeChildView(".loading-wrapper"),this.$el.find(".add-account").removeClass("hidden"),this.createForm())},loadError:function(){this.removeChildView(".loading-wrapper"),u.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},createForm:function(){var e=this.$el.find(".add-account-form"),t=this.model.get("metaTraderConfiguration"),n=[],a=[],r=[];i.map(t,function(e){n.push(e.tradePlatformType),a=a.concat(e.availableCurrencies),r=r.concat(e.accountTypeList)}),a=i.uniq(a),r=i.uniq(r);var s={form:[[{disable:!1,template:o.selectBox,title:__("metatrader.add-account.type.title")+":",name:"field_accountType",savedData:r[0],options:r,transformOptionText:function(e){return __("metatrader.add-account.type."+e)},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.type.title"))}}}],[{disable:!1,template:o.selectBox,title:__("metatrader.add-account.trading-platform.title")+":",name:"field_tradingPlatform",savedData:n[0],options:n,transformOptionText:function(e){return __("metatrader.add-account.trading-platform."+e)},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.trading-platform.title"))}}}],[{disable:!1,template:o.selectBox,title:__("metatrader.add-account.currency")+":",name:"field_currency",savedData:a[0],options:a,transformOptionText:function(e){return e},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.currency"))}},dependent:[{name:"field_tradingPlatform",handler:this.changeCurrenciesOptions.bind(this)}]}]]};this.addLeverageElement(s);var c=new l(s);this.formView=new d({model:c,$parent:e}),this.formView.show()},addLeverageElement:function(e){var t=this.getCurrentLeverages();1===t.length?e.form.push([{title:__("metatrader.add-account.leverage")+":",translationKey:"",template:o.textLabel,description:"1:"+t[0]}]):e.form.push([{disable:!1,template:o.selectBox,title:__("metatrader.add-account.leverage")+":",name:"field_leverage",savedData:t[0],options:t,transformOptionText:function(e){return"1:"+e},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("metatrader.add-account.leverage"))}}}])},getCurrentLeverages:function(){return m.isMetaTraderInternalLeverageEnabled()?this.model.get("availableLeverages"):[this.model.get("defaultLeverage")]},render:function(){return r.prototype.render.call(this),this.$el.html(f(this.options)),this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"}),this.$el.find(".add-account").addClass("hidden"),this},getAccountTypeField:function(){return this.formView.form.getField("field_accountType")},getTradingPlatformField:function(){return this.formView.form.getField("field_tradingPlatform")},getCurrencyField:function(){return this.formView.form.getField("field_currency")},getLeverageField:function(){return this.formView.form.getField("field_leverage")},addAccount:function(){this.model.set("statusOfAddAccount",b)},changeCurrenciesOptions:function(e){var t=this.model.get("metaTraderConfiguration"),n=void 0;i.map(t,function(t){t.tradePlatformType===e.value()&&(n=t)}),this.getCurrencyField().value(n.availableCurrencies[0]),this.showCurrenciesInSelect(n.availableCurrencies)},showCurrenciesInSelect:function(e){var t=this.$el.find('[name="field_currency"]');t.find(".dk-option").addClass("hidden"),t.find("option").attr("disabled","disabled"),i.map(e,function(e){t.find('[value="'+e+'"]').removeAttr("disabled"),t.find('[data-value="'+e+'"]').removeClass("hidden")})},onStatusOfAddAccountChanged:function(){var e=this.model,t=e.get("statusOfAddAccount"),n=this.getAccountTypeField().value(),a=this.getTradingPlatformField().value(),i=this.getCurrencyField().value(),r=this.getCurrentLeverages(),o=1===r.length?r[0]:this.getLeverageField().value();switch(t){case b:e.set("statusOfAddAccount",p);if(this.formView.form.validate())return;return void e.addAccount(n,a,i,o);case _:return void this.addChildView(".loading-wrapper",s,{parent:this.$el,translucent:"2"});case g:return this.removeChildView(".loading-wrapper"),void u.trigger("showMetatraderTabById","metatrader-accounts");case v:return this.removeChildView(".loading-wrapper"),void this.loadError()}}});a.exports=T}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2829:function(e,t,n){var a;void 0!==(a=function(e,t,a){var i=n(438),r=n(9),s=n(5),o=s.EMPTY,d=s.ERROR,l=s.SUCCESS,c=s.PROCESSING;a.exports=i.extend({defaults:function(){return{statusOfMetaTraderAccounts:o,statusOfAddAccount:o}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadMetaTraderAccounts()},addAccount:function(e,t,n,a){var i=this.status("statusOfAddAccount");if(i(c),!(e&&t&&n&&a))return i(d);r.metaTraderAddAccount({accountType:e,platformType:t,currency:n,leverage:a}).then(function(e){return i(l)}).catch(function(e){i(d)})}})}.call(t,n,t,e))&&(e.exports=a)},2830:function(e,t){e.exports='<div class="add-account"><div class="add-account-title"><%=__(\'metatrader.add-account.title\')%></div><div class="add-account-form"></div></div><div class="form-col btn-col"><button class="btn btn-primary btn-mobile-bottom btn-block fn-add-account"><%- __(\'actions.create\') %></button></div><div class="loading-wrapper"></div>'},2831:function(e,t,n){(function(a,i){var r;void 0!==(r=function(e,t,a){var r=n(0),s=n(13),o=n(333),d=o.DepositPopupView,l=n(32),c=n(3),u=n(2832),m=n(84),f=n(229),h=n(230),p=n(6),v=n(10),g=n(471),b=n(932),_=n(472),T=n(473),C=r.template(n(2833)),A=n(5),w=A.LIVE_ACCOUNT_ID,y=A.ERROR,x=A.SUCCESS,I=A.DEPOSIT_STATUSES,E=d.extend({className:"metatrader-deposit",name:"metatrader-deposit",initialize:function(e){s.prototype.initialize.apply(this,arguments),this.model=new u,this.listenTo(this.model,"change:statusOfFrame",this.frameLoaded),this.listenTo(this.model,"change:statusOfAllAccounts",this.loadCompleted),this.listenTo(this.model,"change:statusOfDepositAmountConfig",this.loadCompleted),this.listenTo(this,"form:depositForm:change:field_platformAccountId",this.onAccountChanged),this.render()},render:function(){return s.prototype.render.call(this),this.$el.html(C(this.options)),this.addChildView(".deposit-popup",l,{parent:this.$el,translucent:"2"}),this},loadCompleted:function(){var e=this.model.get("statusOfAllAccounts"),t=this.model.get("statusOfDepositAmountConfig");if(e===y||t===y)return this.loadError();e===x&&t===x&&this.createForm()},loadError:function(){this.removeChildView(".deposit-popup"),c.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us.funded.client"))})},createForm:function(){var e=this,t=this.$el.find(".deposit-form"),n=r.filter(this.model.get("allAccounts"),function(t){return e.model.hasPlatformAccountId(t)&&e.model.isTradingAccountType(t,w)}),a={form:[[{disable:!1,template:m.selectBox,title:__("auto.withdrawal.trading_account"),name:"field_platformAccountId",options:n,transformOptionsValue:function(e){return e.accountId},transformOptionText:function(e){var t=e.accountId,n=e.tradePlatformType,a=e.currency;return(n="COSMOS"===n?__("brand.name"):n)+" Trader - "+t+" - "+String(a).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",__("auto.withdrawal.trading_account"))}}}]]},i=new h(a);this.formView=new f({model:i,$parent:t}),this.formView.show();for(var s in this.formView.form._fields){var o=this.formView.form._fields[s];this.listenTo(o,"all",function(t,n,a){e.trigger("form:depositForm:"+t+":"+n._name,n,a)})}this.removeChildView(".deposit-popup")},showManualDepositPopup:function(e){var t=this,n=new b(e),a=new g({parent:i("body"),source:"metatrader",model:n,onClose:function(){a=null,t.removeChildView(".deposit-popup")},onSuccess:function(){var e=t.formView.form.getField("field_platformAccountId").value(),i=t.model.getAccountById(e);a=null,t.model.set("amount",n.get("amount")),t.model.loadFrame(i)}})},showFirstDepositBonusPopup:function(e){var t=this,n=new _(e),a=new T({parent:i("body"),source:"metatrader",model:n,onClose:function(){var e=t.formView.form.getField("field_platformAccountId").value(),i=t.model.getAccountById(e);return a=null,I.CANCELLED===n.get("status")?void t.removeChildView(".deposit-popup"):(t.model.set("bonusApplied",n.get("bonusApplied")),I.MANUAL_SELECT_AMOUNT===n.get("status")?t.showManualDepositPopup(i):(t.model.set("amount",n.get("selectedAmount")),void t.model.loadFrame(i)))},isHeaderShowed:!0,caption:__("deposit_bonus_table.popup.header")})},onAccountChanged:function(){var e=this.formView.form.getField("field_platformAccountId").value(),t=this.model.getAccountById(e);this.addChildView(".deposit-popup",l,{parent:this.$el,translucent:"2"}),this.isFirstDepositBonusEnabled(t.currency)?this.showFirstDepositBonusPopup(t):v.isManualDepositAmountNeeded()?this.showManualDepositPopup(t):(this.model.set("amount",this.model.getDefaultAmount()),this.model.loadFrame(t))},frameLoaded:function(){var e=this.model,t=e.get("statusOfFrame");if(t===y)return this.loadError();t===x&&(this.removeChildView(".deposit-popup"),this.renderFrame(e.get("depositHref")),this.subscribe())},close:function(){},isFirstDepositBonusEnabled:function(e){return v.isBonusesEnabled()&&v.isMtFirstDepositBonusEnabled()&&!p.isFirstDeposit()&&p.getUserAwardsModel().isFirstDepositExists(e)}});a.exports=E}.call(t,n,t,e))&&(e.exports=r)}).call(t,n(0),n(7))},2832:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(438),r=n(0),s=n(9),o=n(6),d=n(25),l=n(10),c=n(5),u=c.cashierLocales,m=c.EMPTY,f=c.LOADING,h=c.ERROR,p=c.SUCCESS,v=c.PAY_GATE,g=c.SOLID_PAYMENTS,b=c.SAFE_CHARGE,_=c.PRAXIS,T=n(33);a.exports=i.extend({defaults:function(){return{amount:0,bonusApplied:!1,statusOfFrame:m,statusOfAllAccounts:m}},initialize:function(){i.prototype.initialize.apply(this,arguments),this.loadAllAccounts(),this.loadDepositAmountConfig()},loadFrame:function(e){var t=this.status("statusOfFrame");t(f);var n=T.baseUrl,a={accountId:e.accountId,amount:this.choseDepositAmount(),country:o.getCountry(),currency:e.currency,locale:this.getCashierLocale(d.getLanguage()),bonusApproved:this.isBonusApplied()},i=l.getPaymentsServiceVendor();i!==v&&i!==b&&i!==_||(a.successUrl=encodeURIComponent(n+"deposit.html"),a.failUrl=encodeURIComponent(n+"deposit_failed.html")),i===g&&(a.successUrl=encodeURIComponent(n+"?path=solid_payments_deposit_sucess&first_deposit="+this.get("doFirstDeposit")+"&totalAmount="+this.getAmount()+"&atmAmount="+this.getAtmAmount()+"&currency="+o.getUserCurrency()),a.failUrl=encodeURIComponent(n+"?path=solid_payments_deposit_failed")),s.getDepositUrl(a).then(function(e){t(p,{depositHref:e.data})}).catch(function(e){t(h)})},getAccountById:function(e){return r.find(this.get("allAccounts"),function(t){return t.accountId===e})},getCashierLocale:function(e){return u[e]?u[e]:u.en},getAtmAmount:function(){var e=this.get("atmAmount");return-1===e?"Other":r.isUndefined(e)?"N/A":e},isBonusApplied:function(){return!0===this.get("bonusApplied")},choseDepositAmount:function(){return r.isNaN(this.getAmount())||-1===this.getAmount()?this.getDefaultAmount():this.getAmount()},getAmount:function(){return this.get("amount")},getAmountConfig:function(){return this.get("amountConfig")},getDefaultAmount:function(){var e=this.getAmountConfig();return e&&e.defaultAmount}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2833:function(e,t){e.exports='<div class="deposit-popup"><div class="deposit-form"></div><form id="deposit-frame-form" target="deposit-frame" method="POST"></form><iframe id="deposit-frame" name="deposit-frame" style="visibility: hidden"></iframe></div>'},2834:function(e,t,n){(function(a,i){var r;void 0!==(r=function(e,t,a){var i=n(0),r=n(13),s=n(32),o=n(2835),d=n(84),l=n(229),c=n(230),u=n(7),m=n(3),f=i.template(n(2836)),h=n(5),p=h.ERROR,v=h.SUCCESS,g=r.extend({className:"metatrader-bonuses",events:function(){return i.extend({},i.result(r.prototype,"events"),{"click .fn-tab":"changeTab"})},initialize:function(e){r.prototype.initialize.apply(this,arguments),this.model=new o,i.isEmpty(e.model.get("bonusesTab"))||this.model.setCurrentTabById(e.model.get("bonusesTab")),this.listenTo(this.model,"change:selectedAccountBonusesStatus",this.loadCompleted),this.listenTo(this.model,"change:currentTabId",this.updateTab),this.listenTo(this,"form:bonusesForm:change:field_platformAccountId",this.changeAccount)},loadCompleted:function(){var e=this.model.get("selectedAccountBonusesStatus");if(e===p)return this.loadError();e===v&&(this.removeChildView(".metatrader-bonuses"),this.showTemplate())},loadError:function(){this.removeChildView(".metatrader-bonuses"),m.trigger("ui:message-box",{parent:document.body,text:__("server.request.generic.error.body",__("link.contact_us"))})},showTemplate:function(){var e=this;this.$el.html(f({model:this.model.toJSON()})),this.updateTab();var t=this.$el.find(".bonuses-form"),n=this.model.get("metaTraderAccounts"),a=i.find(n,function(t){return t.platformAccountId===e.model.get("selectedAccountId")}).platformAccountId,r={form:[[{disable:!1,template:d.selectBox,title:__("metatrader.bonuses.account")+":",name:"field_platformAccountId",savedData:a,options:n,transformOptionsValue:function(e){return e.platformAccountId},transformOptionText:function(e){var t=e.accountId,n=e.tradePlatformType,a=e.currency;return n+" Trader - "+t+" - "+String(a).toUpperCase()},translationKey:""}]]},s=new c(r);this.formView=new l({model:s,$parent:t}),this.formView.show();for(var o in this.formView.form._fields){var u=this.formView.form._fields[o];this.listenTo(u,"all",function(t,n,a){e.trigger("form:bonusesForm:"+t+":"+n._name,n,a)})}return this},updateTab:function(){var e=this.model,t=__currency(i.find(e.get("metaTraderAccounts"),{platformAccountId:e.get("selectedAccountId")}).currency),n=this.model.getCurrentTabData(),a=n.view,r=n.model;this.addChildView(".tab-content",a,{model:new r({bonuses:e.getBonuses(),accountCurrency:t})}),this.$(".header-container-xs .caption").html(__(this.model.getCurrentTabName())),this.$(".tab").removeClass("active");var s=this.model.getCurrentTabId();this.$(".tab[data-tab-id="+s+"]").addClass("active")},changeTab:function(e){this.model.setCurrentTabById(u(e.currentTarget).attr("data-tab-id"))},changeAccount:function(e){var t=this.formView.form.getField("field_platformAccountId").value();this.model.loadMetaTraderBonusesForAccount(t),this.addChildView(".metatrader-bonuses",s,{parent:this.$el,translucent:"2"})},render:function(){return r.prototype.render.apply(this,arguments),this.addChildView(".metatrader-bonuses",s,{parent:this.$el,translucent:"2"}),this}});a.exports=g}.call(t,n,t,e))&&(e.exports=r)}).call(t,n(0),n(7))},2835:function(e,t,n){(function(a){var i;void 0!==(i=function(e,t,a){var i=n(438),r=n(2585),s=n(2588),o=n(2591),d=n(2592),l=n(0),c=n(5),u=c.EMPTY;a.exports=i.extend({defaults:function(){return{tabs:[{id:"in-progress",name:__("bonus.tab.in_progress"),viewClass:r,modelClass:o},{id:"completed",name:__("bonus.tab.completed"),viewClass:s,modelClass:d}],currentTabId:"in-progress",defaultTabId:"in-progress",selectedAccountId:u,selectedAccountBonuses:[],statusOfMetaTraderAccountsWithBonuses:u,metaTraderAccounts:[]}},initialize:function(){var e=this;i.prototype.initialize.apply(this,arguments),this.loadMetaTraderAccountsWithBonuses().then(function(){var t=l.first(e.get("metaTraderAccounts")).platformAccountId;e.set("selectedAccountId",t),e.loadMetaTraderBonus(t)})},loadMetaTraderBonusesForAccount:function(e){this.set("selectedAccountId",e),this.loadMetaTraderBonus(e)},getCurrentTab:function(){return l.findWhere(this.get("tabs"),{id:this.getCurrentTabId()})},getCurrentTabData:function(){var e=this.getCurrentTab();return{view:e.viewClass,model:e.modelClass}},getCurrentTabId:function(){var e=this.get("currentTabId");return e||this.get("defaultTabId")},getCurrentTabName:function(){return this.getCurrentTab().name},getBonuses:function(){return this.get("selectedAccountBonuses")},setCurrentTabById:function(e){var t=this.getTabById(e);return t&&this.set({currentTabId:t.id,currentTabName:t.name}),t},getTabById:function(e){return l.findWhere(this.get("tabs"),{id:e})}})}.call(t,n,t,e))&&(e.exports=i)}).call(t,n(0))},2836:function(e,t){e.exports='<div class="bonuses"><div class="bonuses-form"></div><div class="visible-xs header-container-xs"><div class="left flex fn-close-popup flex-valign-center btn"><div class="icon arrow"></div><b><%-__(\'actions.back\') %></b></div><div class="caption flex flex-valign-center flex-align-center"> <%-model.currentTabName || model.currentTabNameMobile%> </div><div class="right flex flex-valign-center btn"></div></div><div class="bonus-progress-content"><div class="modal-dialog-container"></div><div class="bonuses_tabs flex flex-row flex-align-start hidden-xs"> <% _.each(model.tabs, function(v) { %> <div class="tab fn-tab flex flex-stretch flex-valign-center active <%- model.currentTabId == v.id ? \'active\' : \'\' %>" data-tab-id="<%- v.id %>"><%- v.name %></div> <% }) %> </div><div class="tab-content"></div></div></div>'}});