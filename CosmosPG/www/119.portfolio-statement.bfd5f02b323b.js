(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{2170:function(e,t,n){"use strict";n.r(t);var a=n(98),o=n(6),r=n.n(o),i=n(50),s=n(0),l=n.n(s),c=n(10),u=n.n(c),d=n(135),m=n(2),p=n(872),f=n(67),b=n(92),h=n(100),_=n(13),g=n.n(_),y=n(1),E=n.n(y),v=n(123),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={statusOfGeneration:m.EMPTY,selectedPeriodId:e.defaultPeriod,periods:e.periods,begin:E.a.isNumber(e.begin)?e.begin:n.getPeriod(e.defaultPeriod).begin,end:E.a.isNumber(e.end)?e.end:n.getPeriod(e.defaultPeriod).end},g()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),C(t,[{key:"componentDidMount",value:function(){this._mounted=!0}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"mounted",value:function(){return this._mounted}},{key:"onChange",value:function(e){var t=this.getPeriod(e);this.setState({selectedPeriodId:e,begin:t.begin,end:t.end})}},{key:"getPeriod",value:function(e){var t=E.a.findWhere(this.props.periods,{id:e});return t?t.data:{}}},{key:"setCustomBeginDate",value:function(e){this.setState({begin:r()(E.a.first(e))})}},{key:"setCustomEndDate",value:function(e){this.setState({end:r()(E.a.first(e))})}},{key:"generate",value:function(){var e=this.props.onAsyncGenerate,t=this.state,n=t.begin,a=t.end,o=r()().utc().format("YYYY-MM-DD"),i=r()(n).utc().format("YYYY-MM-DD"),s=r()(a).utc().format("YYYY-MM-DD"),l={beginPeriod:i,endPeriod:s,isToday:i===s===o};E.a.isFunction(e)&&e!==E.a.noop&&(this.setState({statusOfGeneration:m.IN_PROCESS}),e(l).then(E.a.callIf(this.onSuccess,this.mounted)).catch(E.a.callIf(this.onError,this.mounted)))}},{key:"onSuccess",value:function(e){this.setState({statusOfGeneration:m.SUCCESS}),this.props.onSuccess(e)}},{key:"onError",value:function(){this.setState({statusOfGeneration:m.ERROR})}},{key:"close",value:function(){this.props.onClose()}},{key:"render",value:function(){var e=this,t=this.state,n=t.selectedPeriodId,a=t.periods,o=t.begin,i=t.end,s=t.statusOfGeneration,c=this.props,u=c.displayDateFormat,d=c.onErrorClose,_=c.onErrorCancel,g=c.onClose,y=r()(this.props.absMinDate),E=r()();return s===m.ERROR?l.a.createElement(b.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.generate,onCancel:_,onClose:d}):l.a.createElement("div",{className:"popup-container account-statement-no-bg popup-type-confirm"},l.a.createElement("div",{className:"account-statement-wrapper flex flex-column popup-holder"},l.a.createElement("div",{className:"confirm-dialog"},l.a.createElement("div",{className:"account-statement-body"},s===m.IN_PROCESS&&l.a.createElement(f.a,{fit:!0,position:"absolute"}),l.a.createElement("h3",{className:"fs-24"},__("reports.request.popup.title")),l.a.createElement("div",{className:"form-inline"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"_sr-only",htmlFor:"inputPeriod"},__("period.title")),l.a.createElement(h.a,{childClassName:"pane pane__fluid",className:"pane__xfluid",as:"div",ref:"dropdown",selected:n,options:a,transformOptionsValue:function(e){return e.id},transformOptionText:function(e){return e.title},onChange:this.onChange}),n!==v.c&&l.a.createElement("div",{className:"period-detail"},l.a.createElement("b",null,__("reports.request.popup.from")),o.format(u)," ",l.a.createElement("b",null,__("reports.request.popup.to")),i.format(u))),n===v.c&&l.a.createElement("div",null,l.a.createElement("div",{className:"form-group custom-period inner-addon right-addon"},l.a.createElement("label",null,__("reports.request.popup.from")),l.a.createElement(p.a,{name:"from",ref:function(t){return e.calendarBeginNode=t},minDate:y.utc().toDate().getTime(),maxDate:i.utc().toDate().getTime(),defaultDate:o.utc().toDate().getTime(),dateFormat:"d/m/Y",onChange:this.setCustomBeginDate,disableMobile:!0,className:"form-control flatpickr-input"}),l.a.createElement("i",{className:"glyphicon icon-calendar"})),l.a.createElement("div",{className:"form-group custom-period inner-addon right-addon"},l.a.createElement("label",null,__("reports.request.popup.to")),l.a.createElement(p.a,{name:"to",ref:function(t){return e.calendarEndNode=t},maxDate:E.utc().toDate().getTime(),minDate:o.utc().toDate().getTime(),defaultDate:E.utc().toDate().getTime(),dateFormat:"d/m/Y",disableMobile:!0,onChange:this.setCustomEndDate,className:"form-control flatpickr-input"}),l.a.createElement("i",{className:"glyphicon icon-calendar"}))))),l.a.createElement("div",{className:"actions"},l.a.createElement("div",{className:"block-button"},l.a.createElement("button",{className:"btn flex-stretch text-center fn-cancel",onClick:g},l.a.createElement("span",{className:"flex flex-align-center flex-valign-center"},__("actions.close")))),l.a.createElement("div",{className:"block-button"},l.a.createElement("button",{className:"btn btn-primary flex-stretch text-center fn-ok",onClick:this.generate},l.a.createElement("span",{className:"flex flex-align-center flex-valign-center"},__("actions.generate"))))))))}}]),t}(l.a.Component);O.defaultProps={onAsyncGenerate:E.a.noop,onCancel:E.a.noop,onSuccess:E.a.noop,onErrorCancel:E.a.noop,onErrorClose:E.a.noop,periods:[],defaultPeriod:null,begin:null,end:null,absMinDate:0,displayDateFormat:"DD/MM/YYYY"};var D=O,N=n(4),k=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,o=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var P=function(e){var t=e.asyncGenerate,n=e.onClose,o=Object(s.useState)(!0),i=k(o,2),c=i[0],m=i[1],p=Object(s.useCallback)(d.default),f=new Date(u.a.getUserInfoModel().get("account").accountCreationTime),b=function(){m(!1),n()};return l.a.createElement(a.b,{open:c},l.a.createElement(D,{onAsyncGenerate:t,onSuccess:p,onErrorClose:b,onErrorCancel:b,onClose:b,defaultPeriod:v.k,absMinDate:f,periods:[{id:v.c,data:Object(v.d)(r()(),r()()),title:__("period.custom")},{id:v.k,data:Object(v.n)(),title:__("period.this_month")},{id:v.e,data:Object(v.h)(),title:__("period.last_month")},{id:v.l,data:Object(v.o)(),title:__("period.this_quarter")},{id:v.f,data:Object(v.i)(),title:__("period.last_quarter")},{id:v.m,data:Object(v.p)(),title:__("period.this_year")},{id:v.g,data:Object(v.j)(),title:__("period.last_year")},{id:v.a,data:Object(v.b)(r()(f),r()()),title:__("period.all")}]}))};P.defaultProps={asyncGenerate:E.a.noop,onClose:E.a.noop};t.default=Object(N.connect)(null,(function(e){return{asyncGenerate:function(t){var n=t.beginPeriod,a=t.endPeriod,o=t.isToday;return e(Object(i.m)(n,a,o))}}}))(P)}}]);