(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{2158:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(27),o=n(1221),i=n(0),c=n.n(i),s=n(8),l=n.n(s),u=n(9),p=n.n(u),f=n(100),m=n.n(f),d=n(7),v=n.n(d),h=n(12),b=n.n(h),O=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var y=function(){return p.a.getApplicationSettings()},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:m.a.size(),open:y().floatingOpenPositionsEnabled()},b()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),O(t,[{key:"componentDidMount",value:function(){y().on("change:floatingOpenPositionsEnabled",this.handle,this),m.a.on("remove update",this.handle,this)}},{key:"componentWillUnmount",value:function(){y().off("change:floatingOpenPositionsEnabled",this.handle,this),m.a.off("remove update",this.handle,this)}},{key:"handle",value:function(){this.setState({visible:m.a.size(),open:y().floatingOpenPositionsEnabled()})}},{key:"click",value:function(e){e.stopPropagation();var t=!y().floatingOpenPositionsEnabled();y().floatingOpenPositionsEnabled(t),v.a.trigger("ui:click:floating:open-positions",t)}},{key:"render",value:function(){var e,t,n,a=this.props,r=a.className,o=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(a,["className"]),i=this.state,s=i.open,u=i.visible,p=l()((n=!!r,(t=r)in(e={"icon-open-floating-view":!s,"icon-close-floating-view":s})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e));return u?c.a.createElement(o.as,{className:p,onClick:this.click}):null}}]),t}(c.a.Component);g.defaultProps={as:"span",className:""};var E=g,_=n(2364),j=(n(1220),n(4)),S=n(58),N=n(46),P=n(1),I=n.n(P),k=n(51),w=n.n(k),C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};var U=Object(j.connect)((function(e,t){var n=t.pathUrl,a=e.instruments.treePathsMap[n];return{localizationKey:a&&a._localizedNameKey,name:a&&a.category}}))((function(e){e.value,e.pathUrl;var t=e.localizationKey,n=e.name,a=(e.dispatch,e.as),r=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["value","pathUrl","localizationKey","name","dispatch","as"]);return c.a.createElement(a||"div",C({},r),w.a.fixCategoryName(t,n))})),T=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var x=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.click=n.click.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),T(t,[{key:"click",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.selectCategoryPath(this.props.node._pathUrl)}},{key:"render",value:function(){var e=l()({node:!0,tree_node_selected:this.props.selected});return c.a.createElement("div",{className:e,onMouseDown:this.click},c.a.createElement("div",{className:"name"},c.a.createElement("div",{className:"icon"}),c.a.createElement(U,{as:"div",className:"text",pathUrl:this.props.node._pathUrl})))}}]),t}(i.Component);var D=Object(j.connect)((function(e,t){var n=e.ui,r=n.selectedInstrumentCategoryTreePath;return{selected:n.section===a.UI_SECTION_TRADING&&t.node._pathUrl===r}}),(function(e){return{selectCategoryPath:I.a.throttle((function(t){e(Object(N.selectInstrumentCategoryTreePath)(t)),e(Object(N.selectFirstSymbolInSymbolList)(t)),e(Object(N.closeInstrumentDetails)()),e(Object(N.setTradingSection)())}),10)}}))(x),R=n(157),F=n(60),z=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.click=n.click.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),z(t,[{key:"componentDidMount",value:function(){this.checkShouldCategoryBeOpened(this.props)}},{key:"componentDidUpdate",value:function(){this.checkShouldCategoryBeOpened(this.props)}},{key:"checkShouldCategoryBeOpened",value:function(e){var t=e.node,n=e.selectedInstrumentCategoryTreePath,a=e.setCategoryState;!0!==e.categoriesOpenState[t._pathUrl]&&t._pathUrl&&this.checkIsCategoryActive(t._pathUrl,n)&&a(t._pathUrl,!0)}},{key:"checkIsCategoryActive",value:function(e,t){var n=String(t).toLowerCase(),a=String(e).toLowerCase();return-1!==n.indexOf(a)}},{key:"click",value:function(e){e.stopPropagation();var t=this.props,n=t.node,a=t.categoriesOpenState,r=t.selectedInstrumentCategoryTreePath;this.checkIsCategoryActive(n._pathUrl,r)||this.props.setCategoryState(n._pathUrl,!a[n._pathUrl])}},{key:"render",value:function(){var e=this.props,t=e.node,n=!e.categoriesOpenState[t._pathUrl];if(t.empty)return null;var a=l()({node:!0,folder:!0,closed:n});return c.a.createElement("div",{className:a},c.a.createElement("div",{className:"name",onClick:this.click},c.a.createElement("div",{className:"icon"},c.a.createElement("i",{className:"arrow"})),c.a.createElement(U,{as:"div",className:"text",pathUrl:t._pathUrl})),!n&&t.elements&&t.elements.length&&c.a.createElement("div",{className:"children"},I.a.map(t.elements,(function(e){return Object(R.g)(e)?null:Object(R.f)(e)?c.a.createElement(K,{key:e._pathUrl,node:e}):c.a.createElement(D,{key:e._pathUrl,node:e})}))))}}]),t}(i.Component),K=Object(j.connect)((function(e){return{categoriesOpenState:Object(F.getInstrumentTreeCategoriesOpenState)(e),selectedInstrumentCategoryTreePath:Object(F.getSelectedInstrumentCategoryTreePath)(e)}}),(function(e){return{setCategoryState:function(){e(N.setInstrumentTreeCategoryState.apply(void 0,arguments))}}}))(A),B=K;var L=Object(j.connect)((function(e){return{tree:e.instruments.tree}}))((function(e){var t=e.tree,n=I.a.map(t,(function(e){return e.empty?null:Object(R.f)(e)?c.a.createElement(B,{key:e._pathUrl,node:e}):c.a.createElement(D,{key:e._pathUrl,node:e})}));return c.a.createElement("div",{className:"tree-container"},n)}));n.d(t,"SelectedSectionState",(function(){return J})),n.d(t,"InstrumentTreeContainer",(function(){return G}));var M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}var J=Object(j.connect)((function(e){return{section:e.ui.section}}))((function(e){e.dispatch;var t,n=e.className,a=e.section,r=e.sectionName,o=e.children,i=H(e,["dispatch","className","section","sectionName","children"]),s=l()((V(t={},n,!!n),V(t,"tree_node_selected",a===r),t));return c.a.createElement(i.as||"div",M({},i,{className:s}),o)})),G=function(e){var t=e.openFavoritesSection,n=e.openOpenPositionSection,i=e.openOrdersSection,s=(e.openPortfoliosSection,e.openInvestSection),l=H(e,["openFavoritesSection","openOpenPositionSection","openOrdersSection","openPortfoliosSection","openInvestSection"]);return c.a.createElement("div",{className:"pane pane__column pane__fluid"},c.a.createElement("div",{className:"tree-container menu"},c.a.createElement(J,{as:"div",className:"node",sectionName:a.UI_SECTION_FAVORITES},c.a.createElement("div",{className:"name",id:"instruments-tree-favorites",onClick:t},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"text"},__("tab.favorites")))),c.a.createElement(J,{as:"div",className:"node",sectionName:a.UI_SECTION_OPEN_POSITION},c.a.createElement("div",{className:"name",id:"instruments-tree-open-positions",onClick:n},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"text flex flex-valign-center"},__("tab.open_positions"),c.a.createElement("div",{className:"badge"},c.a.createElement(o.default,{as:"span"})),c.a.createElement(r.default,{desktop:!0},c.a.createElement(E,{as:"span"}))))),c.a.createElement(J,{as:"div",className:"node",sectionName:a.UI_SECTION_ORDERS},c.a.createElement("div",{className:"name",id:"instruments-tree-orders",onClick:i},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"text  flex flex-valign-center"},__("tab.orders"),c.a.createElement("div",{className:"badge"},c.a.createElement(_.a,{as:"span"}))))),(l.isPortfolioEnabled||l.isDmaEnabled)&&c.a.createElement(J,{as:"div",className:"node",sectionName:a.UI_SECTION_INVEST},c.a.createElement("div",{className:"name",id:"instruments-tree-invest",onClick:s,"aria-label":__("invest.tooltip")},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"text  flex flex-valign-center"},__("tab.invest"),!l.isHideInvestIndicator&&c.a.createElement("div",{className:"new-indicator"}))))),c.a.createElement("div",{className:"instruments-tree"},c.a.createElement(L,null)))};t.default=Object(j.connect)((function(e){return{isPortfolioEnabled:Object(S.isPortfolioEnabled)(e),isDmaEnabled:Object(S.isDmaEnabled)(e),isHideInvestIndicator:Object(S.getSettingValueByKey)(e,"hideInvestIndicator")}}),(function(e){return{openFavoritesSection:function(){e(Object(N.closeInstrumentDetails)()),e(Object(N.setFavoritesSection)())},openOpenPositionSection:function(){e(Object(N.closeInstrumentDetails)()),e(Object(N.setOpenPositionsSection)())},openOrdersSection:function(){e(Object(N.closeInstrumentDetails)()),e(Object(N.setOrdersSection)())},openPortfoliosSection:function(){e(Object(N.closeInstrumentDetails)()),e(Object(N.setPortfoliosSection)()),e(Object(N.navigateSection)(a.UI_SECTION_PORTFOLIOS))},openInvestSection:function(){e(Object(N.closeInstrumentDetails)()),e(Object(N.setInvestSection)()),v.a.trigger("ui:invest")}}}))(G)},2364:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(4),i=n(119),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.a=Object(o.connect)((function(e){return{value:Object(i.getTotalOrdersCount)(e)}}))((function(e){var t=e.as,n=e.value,a=(e.dispatch,function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["as","value","dispatch"]));return r.a.createElement(t||"span",c({},a),n)}))}}]);