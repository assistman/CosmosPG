(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{1913:function(e,t,n){"use strict";n.r(t);var o=n(3),a=n(2020),r=n(8),i=n.n(r),l=function(e){return i.a.createTradingAccount(e).then((function(e){return e.data}))},s=n(408),c=n(0),u=n.n(c),p=n(15),f=n.n(p),m=n(4),d=n(27),_=n(9),h=n.n(_),v=n(5),b=n.n(v),y=n(149),E=n(230),g=n(1),O=n.n(g),N=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:o.EMPTY},f()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),N(t,[{key:"componentDidMount",value:function(){this._mount=!0,this.run()}},{key:"componentWillUnmount",value:function(){this._mount=!1}},{key:"mounted",value:function(){return this._mount}},{key:"run",value:function(){this.setState({status:o.LOADING});var e=this.props,t=e.onBefore,n=e.action,a=e.params;t(),n.apply(this,a).then(O.a.callIf(this.onSuccess,this.mounted)).catch(O.a.callIf(this.onError,this.mounted))}},{key:"onSuccess",value:function(e){this.setState({status:o.SUCCESS});var t=this.props,n=t.onSuccess,a=t.onAfter;n(e),a(o.SUCCESS)}},{key:"onError",value:function(e){this.setState({status:o.ERROR});var t=this.props,n=t.onError,a=t.onAfter;n(),a(o.ERROR)}},{key:"getStatus",value:function(){return this.state.status}},{key:"render",value:function(){var e=this.state.status,t=this.props,n=t.silentError,a=t.onErrorClose,r=t.onErrorCancel,i=t.onAfter;return t.withLoading&&e===o.LOADING?u.a.createElement(y.a,{position:"fixed",fit:!0}):n||e!==o.ERROR?null:u.a.createElement(E.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.run,onCancel:O.a.compose(r,(function(){return i(o.ERROR)})),onClose:O.a.compose(a,(function(){return i(o.ERROR)}))})}}]),t}(u.a.Component);S.defaultProps={onErrorClose:O.a.noop,onErrorCancel:O.a.noop,onError:O.a.noop,onBefore:O.a.noop,onAfter:O.a.noop,onSuccess:O.a.noop,silentError:!1,action:Promise.reject,params:null,withLoading:!1};var w=S,C=n(263),P=n(2123),k=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var j=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return f()(n),n.state={pending:!0,shouldLoadAccounts:!1,shouldBuildPortfolio:!1,shouldSwitchToPortfolios:!1,shouldCreateAccount:!1,isButtonEnabled:!1,showConsentPopup:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),k(t,[{key:"componentDidMount",value:function(){this.props.isPortfolioEnabled?this.setState({shouldLoadAccounts:!0,pending:!0}):b.a.navigate("/")}},{key:"findQRAccount",value:function(e){return O.a.findWhere(e||this.props.allAccounts,{tradingAccountInstrumentType:o.ACCOUNT_TRADING_TYPE.QUANT_RANKS,tradingAccountType:h.a.getPlatformTypeId()})}},{key:"navigateToPortfolio",value:function(e){var t=this.findQRAccount(e);if(t){var n=t.platformAccountId,o=h.a.getPlatformType().toLowerCase();b.a.trigger("platform:switch:account",o,n)}}},{key:"createAccount",value:function(){var e=this.props,t=e.userCurrency,n=e.accountsMap[o.ACCOUNT_TRADING_TYPE.QUANT_RANKS]||{},a=O.a.contains(n.currencies,t)?t:n.defaultCurrency;this.setState({shouldBuildPortfolio:!1,shouldSilentCreateAccount:!0,isButtonEnabled:!1,pending:!0,currency:a})}},{key:"toggleConsentPopup",value:function(){this.setState({showConsentPopup:!this.state.showConsentPopup})}},{key:"onCreateAccountError",value:function(){this.setState({shouldBuildPortfolio:!0,shouldSilentCreateAccount:!1,shouldSwitchToPortfolios:!1,isButtonEnabled:!0,pending:!1})}},{key:"onCreateAccountSuccess",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tradingAccounts;this.setState({isButtonEnabled:!0,shouldSilentCreateAccount:!1,isQRAccountCreated:!!this.findQRAccount(t)}),this.navigateToPortfolio(t)}},{key:"onLoadAccountsError",value:function(){this.setState({shouldLoadAccounts:!1,pending:!1})}},{key:"onLoadAccountsSuccess",value:function(){var e=!!this.findQRAccount();this.setState({pending:!1,shouldLoadAccounts:!1,shouldBuildPortfolio:!e,shouldSwitchToPortfolios:e,isButtonEnabled:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.pending,a=t.shouldSilentCreateAccount,r=t.shouldSwitchToPortfolios,i=t.shouldBuildPortfolio,l=t.isButtonEnabled,s=t.shouldLoadAccounts,c=t.currency,p=t.showConsentPopup,f=this.props,m=f.loadAccounts,d=f.createTradingAccount,_=f.defaultLeverage;return u.a.createElement("div",null,n&&u.a.createElement(y.a,{fit:!0}),s&&u.a.createElement(w,{onErrorClose:this.onLoadAccountsError,onErrorCancel:this.onLoadAccountsError,onSuccess:this.onLoadAccountsSuccess,action:m}),i&&u.a.createElement("button",{disabled:!l||void 0,className:"btn btn-primary btn-action",onClick:this.toggleConsentPopup},__("invest.build.portfolio")),r&&u.a.createElement("div",null,u.a.createElement("button",{className:"btn btn-primary btn-action",onClick:function(){return e.navigateToPortfolio()}},__("invest.goto.portfolio"))),a&&u.a.createElement(w,{onErrorClose:this.onCreateAccountError,onErrorCancel:this.onCreateAccountError,onSuccess:this.onCreateAccountSuccess,action:d,params:[{accountType:o.ACCOUNT_TYPE.REAL,platformType:o.PLATFORM_TYPE.COSMOS,tradingAccountInstrumentType:o.ACCOUNT_TRADING_TYPE.QUANT_RANKS,currency:c,leverage:_}]}),p&&u.a.createElement(P.a,{onSuccessCallback:this.createAccount,onCloseCallback:this.toggleConsentPopup}))}}]),t}(u.a.Component);t.default=Object(m.connect)((function(e){return{userInstrumentType:Object(d.getUserInstrumentType)(e),allAccounts:Object(d.getUserTradingAccounts)(e),userCurrency:Object(d.getUserCurrency)(e),isPortfolioEnabled:Object(C.isPortfolioEnabled)(e),accountsMap:Object(a.a)(e),defaultLeverage:Object(a.d)(e)}}),(function(e){return{loadAccounts:function(){return e(Object(s.loadAllAccounts)())},createTradingAccount:function(e){return l(e)}}}))(j)},1949:function(e,t,n){"use strict";n.r(t);var o=n(3),a=n(149),r=n(51),i=n(0),l=n.n(i),s=n(15),c=n.n(s),u=n(4),p=n(192),f=n(1),m=n.n(f),d=n(310),_=(n(2418),function(e){var t=e.children,n=e.title,o=void 0===n?"Untitled":n,a=e.description,r=void 0===a?"Unknown":a,i=e.onClose,s=void 0===i?m.a.noop:i;return l.a.createElement(d.b,{valign:"top",holderClass:"popup-page-holder",contentClass:"popup-page-content"},l.a.createElement("div",{className:"popup-page__header"},l.a.createElement("div",{className:"popup-page__header-body"},l.a.createElement("div",{className:"popup-page__header-title fs-16"},o),l.a.createElement("div",{className:"popup-page__header-description text-muted fs-13"},r)),l.a.createElement("div",{className:"popup-page__header-actions"},l.a.createElement("div",null,l.a.createElement("i",{className:"icon-close-blue cursor--pointer",onClick:s})))),l.a.createElement("div",{className:"page__body pane__fluid"},t))}),h=n(13),v=n(91),b=n.n(v),y=n(1018),E=n(876),g=n(677),O=n(414),N=n(65),S=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function w(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var C=function(e){var t=Object(i.useCallback)((function(){e.selectProps.onAdd(e.getValue()),e.clearValue(),e.setValue()})),n=Object(i.useCallback)((function(){e.selectProps.onRemove(e.getValue()),e.clearValue(),e.setValue()}));return l.a.createElement(N.g.DropdownIndicator,e,l.a.createElement("div",{onClick:n,onTouchEnd:n,className:"btn-default indicator-remove pane pane__row"},l.a.createElement("span",null,"âˆ’")),l.a.createElement("div",{onClick:t,onTouchEnd:t,className:"btn-default indicator-add pane pane__row"},l.a.createElement("span",null,"+")))},P=function(e){var t=e.input,n=t.value,o=n.whiteList,a=void 0===o?[]:o,r=n.blackList,s=void 0===r?[]:r,c=t.onChange,u=e.tooltip,p=e.options,f=Object(i.useCallback)((function(e){var t=S(e,1)[0];return t&&c({blackList:s,whiteList:[].concat(w(a),[t.stockID])})})),d=Object(i.useCallback)((function(e){var t=S(e,1)[0];return t&&c({whiteList:a,blackList:[].concat(w(s),[t.stockID])})})),_=Object(i.useCallback)((function(e){return c({whiteList:a,blackList:m.a.reject(s,(function(t){return e.stockID===t}))})})),h=Object(i.useCallback)((function(e){return c({blackList:s,whiteList:m.a.reject(a,(function(t){return e.stockID===t}))})})),v=Object(i.useCallback)((function(e,t){return t.length>1&&e.label.toLowerCase().includes(t.toLowerCase())})),b=m.a.reject(p,(function(e){var t=e.stockID;return m.a.contains(s,t)||m.a.contains(a,t)})),y=!m.a.isEmpty(a),E=!m.a.isEmpty(s);return l.a.createElement("div",{className:"pane pane__column"},l.a.createElement("div",{className:"pane pane__row flex-valign-center"},l.a.createElement(O.default,{size:"big",components:{DropdownIndicator:C},isSearchable:!0,placeholder:__("portfolio.explore.search.placeholder"),noOptionsMessage:function(){return null},onAdd:f,onRemove:d,filterOption:v,blurInputOnSelect:!0,getOptionLabel:function(e){return e.symbol+" - "+e.companyName},getOptionValue:function(e){return e.symbol},options:b}),u&&l.a.createElement("i",{className:"icon icon-information","aria-label":u})),(y||E)&&l.a.createElement("div",{className:"pane pane__row"},l.a.createElement("div",{className:"pane pane__xfluid pane__row"},l.a.createElement("div",{className:"portfolio__added-shares pane pane__xfluid pane__column"},l.a.createElement("div",{className:"title pane"},__("portfolio.filters.add.share")),l.a.createElement("div",{className:"pane pane__column"},m.a.map(a,(function(e,t){var n=m.a.findWhere(p,{stockID:e});return l.a.createElement("div",{key:t,className:"pane pane__row pane--center fs-13 portfolio__added-share"},l.a.createElement("span",{className:"pane"},n&&n.companyName),l.a.createElement("i",{onClick:function(){return h(n)},className:"icon icon-minus-ico"}))})))),l.a.createElement("div",{className:"portfolio__removed-shares pane pane__xfluid pane__column"},l.a.createElement("div",{className:"title pane"},__("portfolio.filters.remove.share")),l.a.createElement("div",{className:"pane pane__column"},m.a.map(s,(function(e,t){var n=m.a.findWhere(p,{stockID:e});return l.a.createElement("div",{key:t,className:"pane pane__row pane--center fs-13 portfolio__removed-share"},l.a.createElement("span",{className:"pane"},n&&n.companyName),l.a.createElement("i",{onClick:function(){return _(n)},className:"icon icon-plus-ico"}))}))))),l.a.createElement("div",{className:"pane pane__xfluid"})))},k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var j=function(e){var t=e.tooltip,n=e.input,o=e.meta,a=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["tooltip","input","meta"]);return l.a.createElement("div",{className:"pane pane__row flex-valign-center "},l.a.createElement(O.default,k({className:"Select__multiselect pane",size:"big",isMulti:!0,isClearable:!1,onChange:n.onChange,value:n.value,defaultValue:o.initial},a)),t&&l.a.createElement("i",{className:"icon icon-information","aria-label":t}))},x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var R=function(e){var t=e.tooltip,n=e.input,o=e.meta,a=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["tooltip","input","meta"]);return!n.value&&o.initial&&n.onChange(o.initial),l.a.createElement("div",{className:"pane pane__xfluid pane__column"},l.a.createElement("div",{className:"pane pane__row flex-valign-center"},l.a.createElement(O.default,x({onChange:n.onChange,formatOptionLabel:function(e){return e.label},devaultValue:o.initial,value:n.value},a)),t&&l.a.createElement("i",{className:"icon icon-information","aria-label":t})),o.touched&&o.error&&l.a.createElement("div",{className:"pane error fs-13"},o.error))};R.defaultProps={tooltip:"",size:"big"};var A=R,T=n(2380),D=n(7),L=n.n(D),I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var F=function(e){var t,n,o,a=e.className,r=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["className"]);return l.a.createElement(T.b.Range,I({className:L()((t={range:!0},n=a,o=!!a,n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t))},r))},B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},U=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var V=function(e){var t=e.title,n=e.marks,o=e.min,a=e.max,r=e.tooltip,i=e.input,s=(e.defaultValue,e.meta.initial),c=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["title","marks","min","max","tooltip","input","defaultValue","meta"]),u=i.value?i.value:[o.value,a.value],p=U(u,2),f=p[0],d=p[1],_=o.value,h=a.value,v=m.a.findWhere(n,{markValue:f}).label,b=m.a.findWhere(n,{markValue:d}).label,y=m.a.reduce(n,(function(e,t){return e[t.markValue]=t.label,e}),{});return l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"title pane fs-13"},l.a.createElement("span",null,t),l.a.createElement("span",null,v," - ",b)),l.a.createElement("div",{className:"range pane pane__row flex-valign-center"},l.a.createElement(F,B({onChange:function(e){return e[0]===_&&e[1]===h?i.onChange(null):i.onChange(e)},min:_,max:h,value:i.value?i.value:[_,h],defaultValue:s||[_,h],marks:y},c)),l.a.createElement("i",{className:"icon icon-information","aria-label":r})))};V.defaultProps={step:100};var M=V,z=n(418),W=n(41),G=Object(u.connect)((function(e){return{signals:Object(W.B)(e)}}))((function(e){var t=e.signals,n=m.a.pick(t,(function(e){return!!e}));if(m.a.isEmpty(n))return null;var o=m.a.chain(n).keys().map((function(e){return e.split(h.F)[1]})).value();return l.a.createElement("div",{className:"portfolio__details portfolio__signals_details"},l.a.createElement("div",{className:"portfolio__portfolio-details_title fs-16"},__("portfolio.details.signals.title")),l.a.createElement("ul",{className:"portfolio__portfolio-details_list"},m.a.map(o,(function(e){return l.a.createElement("li",{key:"li-"+e},__("portfolio.signal.score."+e))}))))})),q=Object(u.connect)((function(e){return{formValues:Object(y.a)(h.n)(e),selectedUniverseType:Object(W.N)(e),selectedMarketCapRanges:Object(W.K)(e),selectedDailyVolumeRanges:Object(W.J)(e),selectedPeRatioRanges:Object(W.L)(e),selectedBetaRanges:Object(W.I)(e)}}))((function(e){var t=e.formValues,n=e.selectedUniverseType,o=e.selectedMarketCapRanges,a=e.selectedDailyVolumeRanges,r=e.selectedPeRatioRanges,i=e.selectedBetaRanges;return l.a.createElement("div",{className:"portfolio__details portfolio__index_details"},l.a.createElement("div",{className:"portfolio__portfolio-details_title fs-16"},__("portfolio.details.index.title")),t&&l.a.createElement("ul",{className:"portfolio__portfolio-details_list"},l.a.createElement("li",null,n&&n.label),m.a.map(t.sectors,(function(e){return l.a.createElement("li",{key:e.value},e.label)})),o&&l.a.createElement("li",null,__("portfolio.details.index.mcap"),": ",o[0].label," - ",o[1].label),a&&l.a.createElement("li",null,__("portfolio.details.index.adv"),": ",a[0].label," - ",a[1].label),r&&l.a.createElement("li",null,__("portfolio.details.index.peratio"),": ",r[0].label," - ",r[1].label),i&&l.a.createElement("li",null,__("portfolio.details.index.beta"),": ",i[0].label," - ",i[1].label)))})),K=Object(u.connect)((function(e){return{formValues:Object(W.x)(e)}}))((function(e){var t=e.formValues,n=void 0===t?{}:t,o=n.longPositionFactor,a=n.timeHorizon;return o||a?l.a.createElement("div",{className:"portfolio__details portfolio__strategy_details"},l.a.createElement("div",{className:"portfolio__portfolio-details_title fs-16"},__("portfolio.details.strategy.title")),l.a.createElement("ul",{className:"portfolio__portfolio-details_list"},a&&l.a.createElement("li",null,a.label),o&&l.a.createElement("li",null,__("portfolio.builder.shares.title"),": ",o.label))):null})),H=n(261),Y=n.n(H),Q=function(){return l.a.createElement("div",{className:"pane__scroll-content"},l.a.createElement(Y.a,null,l.a.createElement("div",null,l.a.createElement(q,null),l.a.createElement(G,null),l.a.createElement(K,null))))},X=n(875),J=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var $=l.a.createContext({onSave:function(){},onNext:function(){},onPrev:function(){},isLast:function(){}}),Z=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.data={0:{},1:{},2:{},3:{}},n.step=e.initialStep,n.state={currentStep:e.initialStep},c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),J(t,[{key:"getStepLength",value:function(){return m.a.size(this.props.steps)}},{key:"setStep",value:function(e){var t=this.state.currentStep,n=this.getStepLength(),o=e>=0&&e<n?e:t;this.step=o,this.setState({currentStep:o})}},{key:"next",value:function(){return this.setStep(this.state.currentStep+1),this.props.onNext(this.step)}},{key:"prev",value:function(){this.setStep(this.state.currentStep-1)}},{key:"save",value:function(){return this.props.onSave(this.step)}},{key:"close",value:function(e){this.props.onClose(e)}},{key:"getCurrentStepComponent",value:function(){var e=this.props.stepOptions,t=this.props.steps[this.state.currentStep].component;return t?l.a.createElement(t,{onSubmit:this.next,onSave:this.save,onPrev:this.prev,onClose:this.close,onBuildSuccess:this.props.onBuildSuccess,stepOptions:e}):null}},{key:"isLast",value:function(){return this.step===this.getStepLength()-1}},{key:"isCurrent",value:function(e){return this.getCurrentStep()===e}},{key:"hasStepData",value:function(e){return!m.a.isNil(this.data[e])}},{key:"getCurrentStep",value:function(){return this.state.currentStep}},{key:"render",value:function(){var e,t,n,o=this,a=this.props,r=a.steps,i=a.className;return l.a.createElement($.Provider,{value:{onSave:this.save,onNext:this.next,onPrev:this.prev,isLast:this.isLast}},l.a.createElement("div",{className:L()((e={page__body:!0,pane:!0,pane__fluid:!0,pange__row:!0},t=i,n=!!i,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e))},l.a.createElement("div",{className:"portfolio__builder-left-panel pane pane__fluid"},l.a.createElement("ol",{className:"list-group vertical-steps"},m.a.map(r,(function(e,t){return l.a.createElement("li",{className:L()({"list-group-item":!0,completed:t<o.getCurrentStep(),active:o.isCurrent(t)}),key:t,onClick:function(){return t<o.getCurrentStep()&&o.hasStepData(t)&&o.setStep(t)}},l.a.createElement("span",{className:"list-group-item__title"},e.title),l.a.createElement("span",{className:"list-group-item__description"},e.description))})))),l.a.createElement("div",{className:"portfolio__builder-center-panel pane pane__fluid pane__column"},this.getCurrentStepComponent()),l.a.createElement("div",{className:"portfolio__builder-panel-separator"}),l.a.createElement("div",{className:"portfolio__builder-right-panel pane pane__column"},l.a.createElement("div",{className:"pane bold"},__("portfolio.builder.portfolio.details.title")),l.a.createElement("div",{className:"pane pane__scroll"},l.a.createElement(Q,null)))))}}]),t}(i.PureComponent);Z.defaultProps={steps:[],initialStep:0,onFinish:m.a.noop,onSave:m.a.noop,onClose:m.a.noop,onBuildSuccess:m.a.noop,onBeforeNext:m.a.noop,stepOptions:null};var ee=Z,te=function(e){var t=e.children,n=e.onSubmit;return l.a.createElement("div",{className:"pane pane__fluid"},l.a.createElement(X.a,{onSubmit:n,className:"pane pane__fluid pane__column"},t))},ne=function(e){var t=e.children;return l.a.createElement("div",{className:"portfolio__builder-center-panel-body pane pane__row pane__fluid"},t)},oe=Object(E.a)({form:h.n,destroyOnUnmount:!1,forceUnregisterOnUnmount:!0})((function(e){var t=e.onNext,n=e.valid,o=e.shouldShowPrevious,a=void 0===o||o,r=e.shouldShowSave,i=void 0!==r&&r,s=e.forceDisableSubmit,c=e.btnSaveText;return l.a.createElement($.Consumer,null,(function(e){var o=e.onSave,r=e.onPrev,u=e.isLast;return l.a.createElement("div",{className:"pane pane__row portfolio__wizard-actions flex-align-end"},i&&l.a.createElement("a",{href:"#",className:"pane flex-valign-center pane__yfluid fs-13 btn-link flex-align-center",onClick:function(e){e.preventDefault(),o()}},__("actions.save_draft")),a&&l.a.createElement("button",{className:"pane btn btn-primary fs-13 flex-align-center",onClick:r},"< ",__("actions.previous")),l.a.createElement("button",{type:"submit",onClick:t,disabled:!n||s,className:"pane btn btn-primary fs-13 flex-align-center"},u()?c||__("portfolio.actions.save_portfolio"):__("actions.next")+b()(" &gt;")))}))})),ae=n(877),re=n(158),ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var le=function(e){var t=e.children,n=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["children"]);return l.a.createElement(N.g.ValueContainer,n,l.a.createElement("div",{className:"pane pane__row"},l.a.createElement("div",{className:"pane"},l.a.createElement("i",{className:"icon icon-magnifier-ico fs-20"})),l.a.createElement("div",{className:"pane"},t)))},se=function(e){return l.a.createElement(N.g.Option,e,l.a.createElement("div",{className:"pane pane__xfluid pane__row portfolio-search__option"},l.a.createElement("div",null,e.children),l.a.createElement("div",{className:"pane pane__row flex-valign-center portfolio-search__option-actions"},l.a.createElement("i",{className:"icon icon-minus-ico",onClick:function(){e.selectProps.onRemove(e.value),e.clearValue()}}),l.a.createElement("i",{className:"icon icon-plus-ico",onClick:function(){e.selectProps.onAdd(e.value),e.clearValue()}}))))},ce=function(e){var t=Object(i.useCallback)((function(e,t){return t.length>1&&e.label.toLowerCase().includes(t.toLowerCase())}));return l.a.createElement(O.default,ie({className:"pane pane__xfluid",components:{DropdownIndicator:null,ValueContainer:le,Option:se},isSearchable:!0,placeholder:__("portfolio.explore.search.placeholder"),noOptionsMessage:function(){return null},filterOption:t,blurInputOnSelect:!0},e))},ue=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function pe(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var fe=new re.c({fixedWidth:!0,minHeight:30}),me=Object(u.connect)((function(e){return{currentShares:Object(W.e)(e),shares:Object(W.O)(e),whiteList:Object(W.X)(e),blackList:Object(W.c)(e)}}))((function(e){var t=e.allShares,n=e.currentShares,o=e.whiteList,a=e.blackList,r=e.onCancel,s=e.onSuccess,c=Object(i.useState)(m.a.indexBy(t,"stockID")),u=ue(c,1)[0],p=Object(i.useState)(t),f=ue(p,2),_=f[0],h=f[1],v=Object(i.useState)([].concat(pe(n))),b=ue(v,2),y=b[0],E=b[1],g=Object(i.useState)(o||[]),O=ue(g,2),N=O[0],S=O[1],w=Object(i.useState)(a||[]),C=ue(w,2),P=C[0],k=C[1],j=Object(i.useCallback)((function(e,t){return t.length>1&&e.label.toLowerCase().includes(t.toLowerCase())})),x=Object(i.useCallback)((function(e){return S([].concat(pe(N),[e]))})),R=Object(i.useCallback)((function(e){return k([].concat(pe(P),[e]))})),A=Object(i.useCallback)((function(e){S(m.a.reject(N,(function(t){return t===e})))})),T=Object(i.useCallback)((function(e){k(m.a.reject(P,(function(t){return t===e})))}));Object(i.useEffect)((function(){var e=m.a.chain(t).filter((function(e){return m.a.contains(N,e.stockID)})).pluck("stockID").value(),o=m.a.chain(t).filter((function(e){return m.a.contains(P,e.stockID)})).pluck("stockID").value();h(m.a.reject(t,(function(t){return m.a.contains(e,t.stockID)||m.a.contains(o,t.stockID)}))),E(m.a.reject(n,(function(t){return m.a.contains(e,t.stockID)||m.a.contains(o,t.stockID)})))}),[N,P]);var D=Object(i.useCallback)((function(){return s({blackList:P,whiteList:N})})),L=!m.a.isEmpty(N),I=!m.a.isEmpty(P);return l.a.createElement(d.b,null,l.a.createElement(d.a,null,l.a.createElement("div",{className:"portfolio-explore-shares-popup pane pane__column"},l.a.createElement("div",{className:"pane pane__row pane__xfluid flex-valign-center"},l.a.createElement(ce,{options:_,filterOption:j,getOptionLabel:function(e){return e.companyName},getOptionValue:function(e){return e.stockID},placeholder:__("portfolio.explore.search.placeholder"),className:"pane pane__xfluid portfolio-explore-shares__search",onAdd:x,onRemove:R})),l.a.createElement("div",{className:"pane pane__fluid flex-row"},l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"pane pane__column pane_padded-small portfolio-explore-shares__caption"},l.a.createElement("div",{className:"pane bold fs-16"},__("portfolio.portfolio")),l.a.createElement("div",{className:"text-primary"},y.length," ",__("portoflio.builder.all_shares"))),l.a.createElement("div",{className:"pane pane__fluid"},l.a.createElement(Y.a,null,l.a.createElement(re.a,null,(function(e){var t=e.height,n=e.width;return l.a.createElement(re.d,{height:t,rowCount:y.length,rowHeight:fe.rowHeight,width:n,overscanRowCount:5,"aria-label":"",rowRenderer:function(e){var t=e.index,n=e.key,o=e.parent,a=e.style;return l.a.createElement(re.b,{cache:fe,columnIndex:0,key:n,parent:o,rowIndex:t},l.a.createElement("div",{key:n,style:a,className:"pane pane__row pane--center portfolio-explore-shares__item"},l.a.createElement("span",{className:"pane fs-13"},y[t]&&y[t].companyName)))}})}))))),l.a.createElement("div",{className:"pane portfolio-explore-shares__result pane__row filters__add-remove-share"},l.a.createElement("div",{className:"pane portfolio-explore-shares__result-border"}),l.a.createElement("div",{className:"pane pane__fluid"},l.a.createElement(Y.a,null,!L&&!I&&l.a.createElement("div",{className:"pane text-primary fs-13"},__("portfolio.filters.add.share")," / ",__("portfolio.filters.remove.share")),l.a.createElement("div",{className:"pane pane__fluid pane__column pane__scroll-content"},L&&l.a.createElement("div",{className:"portfolio__added-shares pane pane__xfluid pane__column pane_padded-small"},l.a.createElement("div",{className:"pane fs-13 text-primary"},__("portfolio.filters.add.share")),l.a.createElement("div",{className:"pane pane__column"},m.a.map(N,(function(e){return l.a.createElement("div",{className:"pane pane__xfluid",key:e},l.a.createElement("div",{className:"pane pane__row pane--center fs-13 portfolio__added-share"},l.a.createElement("span",{className:"pane"},u[e]&&u[e].companyName),l.a.createElement("div",{className:"icon icon-minus-ico cursor--pointer",onClick:function(){return A(e)}})))})))),I&&l.a.createElement("div",{className:"portfolio__removed-shares pane pane__xfluid pane__column pane_padded-small"},l.a.createElement("div",{className:"pane fs-13 text-primary"},__("portfolio.filters.remove.share")),l.a.createElement("div",{className:"pane pane__column"},m.a.map(P,(function(e){return l.a.createElement("div",{className:"pane pane__xfluid",key:e},l.a.createElement("div",{className:"pane pane__row pane--center fs-13 portfolio__removed-share"},l.a.createElement("span",{className:"pane"},u[e]&&u[e].companyName),l.a.createElement("div",{className:"icon icon-plus-ico cursor--pointer",onClick:function(){return T(e)}})))}))))))))),l.a.createElement("div",{className:"pane portfolio-explore-shares__actions pane__row flex-align-end"},l.a.createElement("button",{className:"pane btn btn-secondary fs-13 flex-align-center",onClick:r},__("order.form.cancel")),l.a.createElement("button",{onClick:D,className:"pane btn btn-primary fs-13 flex-align-center"},__("order.form.confirmation.confirm"))))))})),de=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var _e=Object(E.a)({form:h.n,destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:function(e,t){var n={};return t.totalPortfolioCount<2?(n[h.H]="portfolio.universe.min_value.warning",n):n}})((function(e){var t=e.handleSubmit,n=e.shares,o=e.valid,a=e.onSave,r=e.pristine,i=e.sectors,s=e.universeTypes,c=e.marketCap,u=e.defaultMarketCap,p=e.dailyVolumes,f=e.defaultDailyVolumes,d=e.peRatios,_=e.defaultPeRatio,v=e.betas,b=e.defaultBeta,y=e.currentShares,E=e.selectedShareFilters,g=e.change,O=e.totalPortfolioCount,N=l.a.useState(!1),S=de(N,2),w=S[0],C=S[1],k=l.a.useCallback((function(e){var t=e.whiteList,n=e.blackList;g(h.I,{whiteList:t,blackList:n}),C(!1)}));return l.a.createElement(te,{onSubmit:t,onSave:a,className:"pane pane__fluid"},l.a.createElement(ne,null,l.a.createElement("div",{className:"portfolio__filters pane pane__fluid pane__column pane__fluid"},l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"filters-section pane pane__xfluid pane__row"},l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"pane fs-16 bold"},__("portfolio.select.index")),l.a.createElement(ae.a,{size:"big",name:"universeType",component:A,options:s})),l.a.createElement("div",{className:"filters__shares pane pane__fluid flex-align-end"},l.a.createElement("div",{className:"portfolio__current-shares pane pane__column"},l.a.createElement("div",{className:"pane pane__column"},l.a.createElement("div",{className:"title pane fs-16 bold"},l.a.createElement("span",null,__("portfolio.portfolio"))),l.a.createElement("div",{className:"shares fs-16 pane"},O," ",__("portoflio.builder.current_shares")),l.a.createElement("div",{className:"pane"},l.a.createElement("button",{onClick:function(){return C(!0)},className:"pane btn btn-default fs-13 flex-align-center",type:"button"},__("actions.explore")))),w&&l.a.createElement(me,{onSuccess:k,onCancel:function(){return C(!1)},allShares:n,currentShares:y,blackList:E&&E.blackList,whiteList:E&&E.whiteList})))),l.a.createElement("div",{className:"filters-section range-section pane pane__xfluid pane__column"},l.a.createElement("div",{className:"title pane fs-16 bold"},__("portfolio.filters.add")),l.a.createElement("div",{className:"description pane fs-13"},__("portfolio.filters.description")),l.a.createElement("div",{className:"filters-content pane pane__fluid"},l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"pane fs-13"},__("portfolio.filters.select.sector")),l.a.createElement(ae.a,{size:"big",placeholder:__("items.all"),tooltip:__("portfolio.select.sector.tooltip"),name:h.J,component:j,options:i})),l.a.createElement(ae.a,{name:"marketCap",tooltip:__("portfolio.select.cap.tooltip"),title:__("portfolio.filters.select.cap"),min:u.min,max:u.max,marks:c,component:M})),l.a.createElement("div",{className:"filters-content pane pane__fluid"},l.a.createElement(ae.a,{name:"dailyVolume",title:__("portfolio.filters.average.daily.vol"),tooltip:__("portfolio.select.average.daily.vol.tooltip"),min:f.min,max:f.max,marks:p,component:M}),l.a.createElement(ae.a,{name:"peRatio",title:__("portfolio.filters.peratio")+":",tooltip:__("portfolio.select.peratio.tooltip"),min:_.min,max:_.max,marks:d,step:10,component:M})),l.a.createElement("div",{className:"filters-content pane pane__fluid"},l.a.createElement(ae.a,{name:"beta",title:__("portfolio.filters.beta")+":",tooltip:__("portfolio.select.beta.tooltip"),min:b.min,max:b.max,marks:v,component:M}))),l.a.createElement("div",{className:"filters-section filters__add-remove-share spane pane__xfluid pane__column"},l.a.createElement("div",{className:"pane fs-16 bold"},__("portfolio.builder.add_remove_current_shares")),l.a.createElement("div",{className:"pane pane__column"},l.a.createElement(ae.a,{size:"big",tooltip:__("portfolio.builder.add_remove_shares.tooltip"),name:h.I,label:h.I,component:P,options:n}))),l.a.createElement("div",{className:"filters-sections"},l.a.createElement(z.a,null))),l.a.createElement(ae.a,{name:h.H,type:"hidden",component:"input",value:m.a.size(y)}))),l.a.createElement(oe,{shouldShowSave:!r,shouldShowPrevious:!1,valid:o}))})),he=Object(u.connect)((function(e){return{shares:Object(W.O)(e),sectors:Object(W.H)(e),universeTypes:Object(W.W)(e),defaultUniverseType:Object(W.k)(e),marketCap:Object(W.u)(e),defaultMarketCap:Object(W.i)(e),dailyVolumes:Object(W.f)(e),defaultDailyVolumes:Object(W.h)(e),peRatios:Object(W.v)(e),defaultPeRatio:Object(W.j)(e),betas:Object(W.b)(e),defaultBeta:Object(W.g)(e),currentShares:Object(W.e)(e),selectedShareFilters:Object(W.M)(e),totalPortfolioCount:Object(W.d)(e)}}))(_e),ve=n(1019),be=n(515),ye=l.a.createContext({}),Ee=function(e){var t=e.state,n=e.children;return l.a.createElement(ye.Provider,{value:t},n)},ge=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Oe(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Ne=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return c()(n),n.state={currentShares:e.currentShares,shares:e.shares,whiteList:e.whiteList,blackList:e.blackList,setWhiteList:n.setWhiteList,setBlackList:n.setBlackList,cleanFilter:n.cleanFilter},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ge(t,[{key:"setWhiteList",value:function(e){var t=this.state.whiteList;this.setState({whiteList:[].concat(Oe(t),[e])})}},{key:"setBlackList",value:function(e){var t=this.state.blackList;this.setState({blackList:[].concat(Oe(t),[e])})}},{key:"cleanFilter",value:function(e,t){var n=this.state,o=n.whiteList,a=n.blackList;e===h.P&&this.setState({whiteList:m.a.without(o,t),blackList:a}),e===h.k&&this.setState({blackList:m.a.without(a,t),whiteList:o})}},{key:"onSubmit",value:function(){var e={blackList:this.state.blackList,whiteList:this.state.whiteList};this.props.onSubmit(e)}},{key:"onClose",value:function(){this.props.onClose()}},{key:"render",value:function(){return l.a.createElement(d.b,{popupStyle:"quant"},l.a.createElement(d.a,null,l.a.createElement(Ee,{state:this.state},this.props.children(this.onClose,this.onSubmit))))}}]),t}(i.Component),Se=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var we=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={shouldOpenExplorePopup:!1},c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Se(t,[{key:"onClick",value:function(){this.setState({shouldOpenExplorePopup:!0})}},{key:"closeExplorePopup",value:function(){this.setState({shouldOpenExplorePopup:!1})}},{key:"onSubmit",value:function(e){this.props.dispatch(Object(be.a)(this.props.form,h.I,e)),this.closeExplorePopup()}},{key:"render",value:function(){var e=this.props,t=e.currentShares,n=e.shares,o=e.whiteList,a=e.blackList,r=e.totalPortfolioCount,i=this.state.shouldOpenExplorePopup;return l.a.createElement("div",{className:"portfolio__current-shares pane pane__column"},l.a.createElement("div",{className:"pane pane__column"},l.a.createElement("div",{className:"title pane fs-16 bold"},l.a.createElement("span",null,__("portfolio.portfolio"))),l.a.createElement("div",{className:"shares fs-16 pane"},r+" "+__("portfolio.shares")),l.a.createElement("div",{className:"pane"},l.a.createElement("button",{onClick:this.onClick,className:"pane btn btn-default fs-13 flex-align-center",type:"button"},__("actions.explore")))),l.a.createElement("div",{className:"pane"},i&&l.a.createElement(Ne,{onSubmit:this.onSubmit,onClose:this.closeExplorePopup,currentShares:t,shares:n,whiteList:o,blackList:a},this.props.children)))}}]),t}(i.PureComponent);we.defalutProps={form:""};var Ce=Object(u.connect)((function(e){return{currentShares:Object(W.e)(e),shares:Object(W.O)(e),whiteList:Object(W.X)(e),blackList:Object(W.c)(e),totalPortfolioCount:Object(W.d)(e)}}))(we),Pe=n(83),ke=n.n(Pe),je=n(658),xe=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Re=m.a.debounce((function(e,t){e.onChange(t),e.onBlur(t),e.onFocus(t)}),500),Ae=function(e){var t=e.input;return l.a.createElement(je.a,{step:1,minValue:0,maxValue:100,value:t.value,precision:1,onChange:function(e){return Re(t,e)},onBlur:t.onBlur,onFocus:t.onFocus})},Te=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={checked:e.checked,isInfoOpened:!1},c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),xe(t,[{key:"onCheckboxClick",value:function(e){var t=e.target.checked;this.setState({checked:t}),this.props.onCheck(this.props.score,t)}},{key:"onInfoClick",value:function(){this.setState({isInfoOpened:!this.state.isInfoOpened})}},{key:"render",value:function(){var e=this,t=this.props.score,n=this.state.checked;return l.a.createElement("div",null,l.a.createElement("div",{className:"portfolio__signals_score-types_item"},l.a.createElement("div",{className:"portfolio__signals_score-types_item_header"},l.a.createElement("div",{className:L()({"score-checkbox":!0,checked:n})},l.a.createElement("input",{id:"checkbox-"+t,type:"checkbox",ref:"checkbox",className:"custom-checkbox",onClick:this.onCheckboxClick,defaultChecked:n}),l.a.createElement("label",{htmlFor:"checkbox-"+t})),l.a.createElement("div",{className:"score-name",onClick:function(){e.refs.checkbox&&e.refs.checkbox.click()}},__("portfolio.signal.score."+t)),l.a.createElement("div",{className:"form score-input"},n&&l.a.createElement(ae.a,{component:Ae,name:h.F+t,normalize:function(e){return e?parseFloat(e):0}})),l.a.createElement("div",{className:"score-icon",onClick:this.onInfoClick},this.state.isInfoOpened?l.a.createElement("i",{className:"icon icon-close-circle"}):l.a.createElement("i",{className:"icon icon-info-circle-thin"}))),this.state.isInfoOpened&&l.a.createElement("div",{className:"score-description"},__("portfolio.signal.score_description."+t))))}}]),t}(l.a.Component),De=function(e){var t=e.input,n=e.meta,o=e.adjustSignalsWeight;return l.a.createElement("div",{className:"portfolio__signals_adjust"},l.a.createElement("div",{className:"portfolio__signals_adjust_warning"},n.error&&__(n.error)),l.a.createElement("div",{className:"pane pane__row"},l.a.createElement("div",{className:"pane pane__xfluid pane--center"},l.a.createElement("span",null,__("portfolio.signal.adjust.total"),":"),l.a.createElement("span",{className:"portfolio__signals_adjust_total-value"},t.value||0,"%")),l.a.createElement("div",null,l.a.createElement("button",{type:"button",className:"portfolio__signals_adjust_btn btn btn-default",onClick:function(){o()}},__("portfolio.signal.adjust.button")))))};De.defaultProps={adjustSignalsWeight:m.a.noop};var Le=De,Ie=n(42),Fe=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var Be=Object(u.connect)((function(e){return{currentShares:Object(W.e)(e),shares:Object(W.O)(e),whiteList:Object(W.X)(e),blackList:Object(W.c)(e),totalPortfolioCount:Object(W.d)(e)}}))((function(e){var t=e.whiteList,n=e.blackList,o=e.shares,a=e.currentShares,s=e.totalPortfolioCount,c=Object(i.useState)([]),u=Fe(c,2),p=u[0],f=u[1];return Object(i.useEffect)((function(){Object(r.j)(a,o,t,n).then((function(e){f(e)}))}),[o,t,n]),l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"title pane pane__xfluid fs-16 bold"},l.a.createElement("span",null,__("portfolio.portfolio"))),l.a.createElement("div",{className:"pane pane__xfluid shares fs-16"},s," ",__("portfolio.shares")),l.a.createElement("div",{className:"pane pane__fluid"},l.a.createElement("div",{className:"pane__scroll"},l.a.createElement("div",{className:"pane__scroll-content"},l.a.createElement(Y.a,null,l.a.createElement(re.a,null,(function(e){var t=e.height,n=e.width;return l.a.createElement(re.d,{height:t,rowCount:p.length,rowHeight:30,width:n,overscanRowCount:5,"aria-label":"",rowRenderer:function(e){var t=e.index,n=e.key,o=e.style;return l.a.createElement("div",{key:n,style:o,className:"pane pane__row pane--center fs-13"},l.a.createElement("span",{className:"pane"},p[t]&&p[t].companyName))}})})))))))})),Ue=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Ve=function(e){return parseFloat(Number(e).toFixed(1))},Me=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.auto=!0,n.pristine=!0,n.state={activeGroup:null,activeCategories:[],shouldRestoreCategories:!0,autoAdjust:!0},c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ue(t,[{key:"componentDidMount",value:function(){this.setState({activeGroup:m.a.first(m.a.keys(this.props.groups))}),this._setActiveCategoriesBasedOnSignals(this.props)}},{key:"componentWillUpdate",value:function(e,t){m.a.isEmpty(e.groups)||t.activeGroup||(this.state.activeGroup=m.a.first(m.a.keys(e.groups))),this.state.shouldRestoreCategories&&m.a.isEmpty(t.activeCategories)&&!m.a.isEmpty(e.signals)&&this._setActiveCategoriesBasedOnSignals(e),this.pristine&&m.a.size(e.signals)&&(this.pristine=!1)}},{key:"_setActiveCategoriesBasedOnSignals",value:function(e){var t=m.a.keys(e.categories),n=m.a.keys(e.groups),o=m.a.chain(e.signals).keys().map((function(e){return e.split(h.F)[1]})).value(),a=m.a.filter(t,(function(t){return m.a.some(o,(function(n){return m.a.contains(e.categories[t],n)}))})),r=m.a.filter(n,(function(t){return m.a.some(a,(function(n){return m.a.contains(e.groups[t],n)}))}));m.a.isEmpty(a)||this.setState({activeCategories:a,activeGroup:m.a.first(r)||this.state.activeGroup,shouldRestoreCategories:!1})}},{key:"adjustSignalsWeight",value:function(){var e=this,t=this.props.signals,n=this.props.signalsTotal,o=null,a=0,r=0,i=m.a.mapObject(t,(function(e,t){return e?((e=Ve(h.t*(Number(e)/n)))>a&&(o=t,a=e),r=Ve(r+e),e):e}));r!==h.t&&(i[o]=Ve(h.t-r+i[o])),m.a.each(i,(function(t,n){e.props.change(n,t)}))}},{key:"setActiveGroup",value:function(e){this.setState({activeGroup:e})}},{key:"toggleActiveCategory",value:function(e,t){var n=this.state.activeCategories,o=t?m.a.union(n,[e]):m.a.without(n,e);this.setState({activeCategories:o})}},{key:"onCheck",value:function(e,t){var n=this.props,o=n.dispatch,a=n.form,r=h.F+e;t?(o(Object(be.b)(a,!1,!1,r)),o(Object(be.a)(a,r,0,!1))):(o(Object(be.a)(a,r,null,!1)),o(Object(be.b)(a,!1,!1,r)))}},{key:"onNext",value:function(e){this.pristine&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.pristine=!1,this.adjustSignalsWeight())}},{key:"render",value:function(){var e=this,t=this.props,n=t.handleSubmit,o=t.onSave,a=t.valid,r=t.pristine;return l.a.createElement(te,{className:"pane pane__row pane__fluid portfolio__signals",onSubmit:n,onSave:o},l.a.createElement(ne,null,l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"pane fs-16 bold"},__("portfolio.step2.title")),l.a.createElement("div",{className:"portfolio__signals_form pane__fluid"},l.a.createElement("div",{className:"pane pane__column pane__fluid"},l.a.createElement("div",{className:"pane pane__row pane__yfluid"},l.a.createElement("div",{className:"portfolio__signals_panel groups"},l.a.createElement("div",{className:"pane__scroll"},l.a.createElement("div",{className:"pane__scroll-content"},l.a.createElement(Y.a,null,l.a.createElement("div",{className:"portfolio__signals_list portfolio__signals_groups"},m.a.map(m.a.keys(this.props.groups),(function(t,n){return l.a.createElement("div",{key:t+"-"+n,className:L()({"portfolio__signals_list-item":!0,active:e.state.activeGroup===t}),onClick:function(){e.setActiveGroup(t)}},__("portfolio.signal.group."+t))})))))),l.a.createElement(ae.a,{name:h.G,component:Le,adjustSignalsWeight:this.adjustSignalsWeight,onChange:function(e){return e}})),l.a.createElement("div",{className:"portfolio__signals_panel categories"},l.a.createElement("div",{className:"pane__scroll"},l.a.createElement("div",{className:"pane__scroll-content"},l.a.createElement(Y.a,null,l.a.createElement("div",{className:"portfolio__signals_list portfolio__signals_categories"},m.a.map(this.props.groups[this.state.activeGroup],(function(t,n){var o=m.a.contains(e.state.activeCategories,t);return l.a.createElement("div",{key:t+"-"+n},l.a.createElement("div",{className:L()({"portfolio__signals_list-item":!0,collapsible:!0,active:o}),onClick:function(){e.toggleActiveCategory(t,!o)}},__("portfolio.signal.category."+t)),o&&l.a.createElement("div",{className:"portfolio__signals_score-types"},m.a.map(e.props.categories[t],(function(t,n){var o=h.F+t;return l.a.createElement(Te,{onCheck:e.onCheck,checked:m.a.has(e.props.signals,o),score:t,key:n+"-"+o})}))))})))))))))),l.a.createElement(z.a,null)),l.a.createElement("div",{className:"pane"},l.a.createElement(Ce,{form:h.n},(function(e){return l.a.createElement("div",{className:"pane pane__fluid pane__column portfolio__explore"},l.a.createElement("div",{className:"pane pane__fluid portfolio__explore-body"},l.a.createElement(Be,{isShowIcon:!1})),l.a.createElement("div",{className:"pane pane__fluid portfolio__explore-bottom flex-align-end"},l.a.createElement("button",{className:"pane btn btn-primary fs-13 flex-align-center",onClick:e},__("actions.close"))))})))),l.a.createElement(oe,{onNext:this.onNext,shouldShowSave:!r,valid:a}))}}]),t}(l.a.Component),ze=Object(E.a)({form:h.n,destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:function(e,t){var n={},o=m.a.pick(e,(function(e,t){return Object(Pe.startWith)(h.F,t)})),a=m.a.isEmpty(o),r=m.a.some(o,(function(e){return 0===e}));if(m.a.isUndefined(t.signalsTotal)&&a)return n;if(a)return n[h.G]="portfolio.signal.not_selected.warning",n;if(r)return n[h.G]="portfolio.signal.zero_value.warning",n;var i=m.a.reduce(o,(function(e,t){return e=Ve(e+Number(t))}),0);return(a||i!==h.t)&&(n[h.G]="portfolio.signal.adjust.warning"),n},onChange:function(e,t,n){var o=n.fields,a=m.a.filter(m.a.keys(e),(function(e){return ke.a.startWith(h.F,e)})),r=m.a.reduce(a,(function(t,n){var a=o&&o[n],r=a&&a.visited,i={fieldName:n,value:e[n]};return null===i.value?t:(r?t.dirtyFields.push(i):t.pristineFields.push(i),t)}),{pristineFields:[],dirtyFields:[]}),i=m.a.reduce(r.dirtyFields,(function(e,t){return parseFloat(t.value)+e}),0);if(i>=h.t&&m.a.each(r.pristineFields,(function(e){var o=e.fieldName;t(Object(be.a)(n.form,o,0))})),i<h.t){var l=h.t-i,s=Ve(l/r.pristineFields.length),c=i;if(m.a.each(r.pristineFields,(function(e){var o=e.fieldName;c=Ve(s+c),t(Object(be.a)(n.form,o,s))})),c!==h.t){var u=m.a.last(r.pristineFields);if(u){var p=Ve(h.t-c+s);t(Object(be.a)(n.form,u.fieldName,p))}}}var f=m.a.pick(e,(function(e,t){return Object(Pe.startWith)(h.F,t)}))||Ie.b;m.a.isEmpty(f)&&t(Object(be.a)(n.form,h.G,0));var d=m.a.reduce(f,(function(e,t){return t&&(e+=Number(t)),e}),0);t(Object(be.a)(n.form,h.G,parseFloat(d.toFixed(1))))}})(Me),We=Object(u.connect)((function(e){return{scoreTypes:Object(W.D)(e),groups:Object(W.E)(e),categories:Object(W.C)(e),initialValues:Object(ve.a)(h.n)(e),fields:e.form[h.n].fields,signals:Object(W.B)(e),signalsTotal:Object(W.F)(e)}}))(ze),Ge=function(e){var t=e.timeHorizons,n=e.longPositionFactors,o=e.handleSubmit,a=e.valid,r=e.onSave,i=e.pristine;return l.a.createElement(te,{onSubmit:o,onSave:r},l.a.createElement(ne,null,l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"pane fs-16 bold"},__("portfolio.builder.strateqy.title")),l.a.createElement("div",{className:"pane"},__("portfolio.builder.strateqy.frequency.title")),l.a.createElement("div",{className:"pane pane__row"},l.a.createElement("div",{className:"pane pane__fluid"},l.a.createElement(ae.a,{name:"timeHorizon",component:A,placeholder:__("portfolio.builder.strateqy.frequency.dropdown.placeholder"),fluid:!0,options:t,isSearchable:!1})),l.a.createElement("div",{className:"pane flex flex-valign-center"},l.a.createElement("div",{className:"icon icon-information","aria-label":__("portfolio.builder.strateqy.frequency.info")}))),l.a.createElement("div",{className:"pane"},__("portfolio.builder.strategy.shares.title")),l.a.createElement("div",{className:"pane pane__row"},l.a.createElement("div",{className:"pane pane__fluid"},l.a.createElement(ae.a,{name:"longPositionFactor",component:A,placeholder:__("portfolio.builder.strategy.shares.dropdown.placeholder"),fluid:!0,options:n,isSearchable:!1})),l.a.createElement("div",{className:"pane flex flex-valign-center"},l.a.createElement("div",{className:"icon icon-information","aria-label":__("portfolio.builder.strategy.shares.info")}))),l.a.createElement(z.a,null)),l.a.createElement(Ce,{form:h.n},(function(e){return l.a.createElement("div",{className:"pane pane__fluid pane__column portfolio__explore"},l.a.createElement("div",{className:"pane pane__fluid portfolio__explore-body"},l.a.createElement(Be,{isShowIcon:!1})),l.a.createElement("div",{className:"pane pane__fluid portfolio__explore-bottom flex-align-end"},l.a.createElement("button",{className:"pane btn btn-primary fs-13 flex-align-center",onClick:e},__("actions.close"))))}))),l.a.createElement(oe,{shouldShowSave:!i,valid:a}))};Ge.defaultProps={timeHorizons:h.K,longPositionFactors:h.s};var qe=Object(E.a)({form:h.n,destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,initialValues:{timeHorizon:h.m,longPositionFactor:h.l},validate:function(e){var t={};return e.timeHorizon||(t.timeHorizon=__("validation.required")),e.longPositionFactor||(t.longPositionFactor=__("validation.required")),t},onSubmit:function(e,t,n){}})(Ge),Ke=n(656),He=n(654),Ye=n(642),Qe=n(655),Xe=n(123),Je=n(2094),$e=n(230),Ze=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var et=function(e){var t=e.input,n=t.value,o=t.onChange,a=t.onBlur,r=t.onFocus;return l.a.createElement("input",{type:"text",className:"form-control input-field",value:n,onChange:o,onFocus:r,onBlur:a})},tt=function(e){var t=e.meta.error;return t?l.a.createElement("div",{className:"pane fs-13 color--danger"},t):null},nt=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return c()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ze(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.onErrorClose,o=e.onErrorCancel,r=e.valid,i=e.submit,s=e.handleSubmit,c=e.submitting;return e.submitFailed?l.a.createElement($e.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:i,onCancel:o,onClose:n}):l.a.createElement(d.b,{popupStyle:"quant",onClose:t,title:__("portfolio.builder.save.title")},l.a.createElement(d.a,null,c&&l.a.createElement(a.a,{fit:!0,position:"absolute",translucent:2}),l.a.createElement(X.a,{onSubmit:s,className:"form pane pane__fluid pane__column pane_padded-small"},l.a.createElement("div",{className:"pane fs-13"},__("portfolio.builder.portfolio_name")," :"),l.a.createElement("div",{className:"pane pane__fluid pane__column field field-type-input pane_padded-small"},l.a.createElement("div",{className:"pane pane__row"},l.a.createElement("div",{className:"pane pane__fluid"},l.a.createElement(ae.a,{name:"portfolioName",component:et})),l.a.createElement("div",{className:"pane"},l.a.createElement("button",{type:"submit",className:"btn btn-primary portfolio__width--bigger",disabled:c||!r},__("actions.save.title")))),l.a.createElement(ae.a,{name:"portfolioName",component:tt})),l.a.createElement("div",{className:"pane fs-11 color--muted"},__("portfolio.builder.save.description")))))}}]),t}(l.a.Component);nt.defaultProps={onSuccess:m.a.noop,onErrorCancel:m.a.noop,onErrorClose:m.a.noop,onClose:m.a.noop};var ot=Object(u.connect)((function(e){return{excludeNames:Object(W.A)(e)}}))(Object(E.a)({form:"portfolioName",onSubmit:function(e,t,n){n.clearSubmitErrors(),n.startSubmit(),t(Object(Xe.d)(e.portfolioName)).then((function(){n.setSubmitSucceeded(),n.stopSubmit(),n.onSuccess(e.portfolioName)})).catch((function(){n.setSubmitFailed(),n.stopSubmit()}))},validate:function(e,t){var n={},o=e.portfolioName;return 0===m.a.size(o)&&(n.portfolioName=__("validation.required",__("portfolio.builder.portfolio_name"))),m.a.size(o)>50&&(n.portfolioName=__("validation.length_less",__("portfolio.builder.portfolio_name"),50)),m.a.includes(o," ")&&(n.portfolioName=__("validation.space_not_allowed",__("portfolio.builder.portfolio_name"))),m.a.includes(t.excludeNames,o)&&(n.portfolioName=__("validation.value_exists",__("portfolio.builder.portfolio_name"))),n}})(nt)),at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},rt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var it=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return c()(n),n.state={shouldInvest:!1,shouldOpenNamePopup:!1,isInvested:!1,portfolioName:null,shouldShowLoading:!0,investCancelled:!1,backtestRunnerStatus:o.EMPTY,shouldRunBacktest:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),rt(t,[{key:"componentDidMount",value:function(){this.props.portfolio?this.setState({portfolioName:this.props.portfolio.portfolioName,shouldOpenNamePopup:!1}):this.setState({portfolioName:this.props.portfolioFormValues.portfolioName})}},{key:"closePortfolioNameForm",value:function(){this.setState({shouldOpenNamePopup:!1})}},{key:"onPortfolioNameFormSubmit",value:function(e){var t=e&&e.portfolioName,n=this.props.portfolioFormValues;this.setState({portfolioName:t,shouldOpenNamePopup:!1,shouldInvest:!0}),this.props.createLocalPortfolio(t,n,{step:3,filled:!0}),this.props.formPersist(t,n)}},{key:"showPortfolioInvest",value:function(e){Object(r.E)({portfolioName:e,backtest:this.state.createdBacktest,onSuccess:this.onInvestSuccess,onCancel:this.onInvestClose,onClose:this.onInvestClose,onErrorClose:this.onInvestClose,onErrorCancel:this.onInvestClose})}},{key:"onSubmit",value:function(e){e.preventDefault();var t=this.state,n=t.portfolioName,o=t.isInvested,a=t.investCancelled;return n?(this.props.updateLocalPortfolio(n,{filters:at({},this.props.portfolioFormValues),options:{step:3,filled:!0}}),a||o?(this.props.formPersist(n,{filters:at({},this.props.portfolioFormValues),options:{step:3,filled:!0}}),this.props.onClose({finished:!0,invested:!a}),!1):(this.showPortfolioInvest(n),!1)):(this.setState({shouldOpenNamePopup:!0}),!1)}},{key:"onBacktestRunnerSuccess",value:function(e){this.setState({createdBacktest:e,backtestRunnerStatus:o.SUCCESS,shouldRunBacktest:!1,shouldShowLoading:!1})}},{key:"onInvestSuccess",value:function(e){this.props.onBuildSuccess(e)}},{key:"onInvestClose",value:function(){this.setState({shouldInvest:!1,investCancelled:!0})}},{key:"render",value:function(){var e=this.props,t=e.onSave,n=e.countPortfolios,r=e.pristine,s=e.onPrev,c=e.portfolioFormValues,u=this.state,p=u.shouldOpenNamePopup,f=u.shouldShowLoading,m=u.backtestRunnerStatus,d=u.shouldRunBacktest,_=u.createdBacktest,h=u.investCancelled,v=this.props.portfolioName||this.state.portfolioName,b=c||{};return l.a.createElement(i.Fragment,null,l.a.createElement(te,{onSubmit:this.onSubmit,onSave:t},l.a.createElement(ne,null,l.a.createElement("div",{className:"pane pane__fluid pane__column relative"},f&&l.a.createElement(a.a,{fit:!0,position:"absolute",translucent:2}),l.a.createElement("div",{className:"pane fs-16 bold"},__("portfolio.step4.title")),d&&l.a.createElement(Je.a,{filters:b,onSuccess:this.onBacktestRunnerSuccess,onErrorOK:s}),m===o.SUCCESS&&l.a.createElement("div",{className:"pane__scroll"},l.a.createElement("div",{className:"pane__scroll-content"},l.a.createElement(Y.a,null,l.a.createElement("div",{className:"portfolio__backtest"},l.a.createElement(Ye.a,{universeName:b.universeType&&b.universeType.label,dailyReturnData:_.backtest.dailyReturnData,yearlyPerformanceData:_.backtest.yearlyPerformanceData}),l.a.createElement(He.a,{timeHorizon:b.timeHorizon&&b.timeHorizon.value,yearlyInsightsData:_.overview.yearlyInsightsData}),l.a.createElement(Qe.a,{yearlyPerformanceData:_.backtest.yearlyPerformanceData}),l.a.createElement(Ke.a,{lastPortfolioPositionData:_.overview.lastPortfolioData.positions})),l.a.createElement(z.a,null)))))),l.a.createElement(oe,{shouldShowSave:!r,onNext:this.onSubmit,valid:m===o.SUCCESS,forceDisableSubmit:m!==o.SUCCESS,btnSaveText:v&&!h?__("actions.invest"):null})),p&&l.a.createElement(ot,{initialValues:{portfolioName:__("portfolio-edit.name.default")+(n+1)},onSubmit:this.onPortfolioNameFormSubmit,onClose:this.closePortfolioNameForm}))}}]),t}(i.PureComponent),lt=Object(E.a)({form:h.n,destroyOnUnmount:!1,forceUnregisterOnUnmount:!0})(it),st=Object(u.connect)((function(e,t){var n=t.stepOptions,o=n&&n.portfolioName;return{countPortfolios:Object(W.a)(e),portfolio:Object(W.s)(e,o),portfolioFormValues:Object(W.x)(e),portfolioName:o}}),(function(e){return{buildPortfolio:function(){return e(Xe.a.apply(void 0,arguments))},formPersist:function(t,n){return e(Object(be.c)(h.n,n))},createLocalPortfolio:function(t,n,o){return e(Object(Xe.d)(t,n,o))},updateLocalPortfolio:function(t,n){return e(Object(Xe.r)(t,n))}}}))(lt),ct=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var ut=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return c()(n),n.wizardRef=l.a.createRef(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ct(t,[{key:"getValues",value:function(){return this.props.values}},{key:"onSave",value:function(e){return this.props.onSave(this.getValues(),e)}},{key:"onNext",value:function(e){return this.props.onNext(this.getValues(),e)}},{key:"onClose",value:function(e){this.props.onClose(e)}},{key:"render",value:function(){var e=this.props,t=e.initialWizardStep,n=e.onFinish,o=e.stepOptions;return l.a.createElement(g.a,{loaderComponent:l.a.createElement("div",{className:"pane pane__fluid pane--relative"},l.a.createElement(a.a,{position:"absolute",fit:!0})),errorComponent:l.a.createElement("div",{className:"pane pane__fluid flex-valign-center flex-align-center"},b()(__("server.request.generic.error.body",__("link.contact_us.funded.client"))))},l.a.createElement(ee,{ref:this.wizardRef,className:"portfolio-builder-wizard",initialStep:t,onSave:this.onSave,onFinish:n,onNext:this.onNext,onClose:this.onClose,onBuildSuccess:this.props.onBuildSuccess,stepOptions:o,steps:[{id:"step1",title:__("portfolio.step1.title"),description:__("portfolio.step1.description"),component:he},{id:"step2",title:__("portfolio.step2.title"),description:__("portfolio.step2.description"),component:We},{id:"step3",title:__("portfolio.step3.title"),description:__("portfolio.step3.description"),component:qe},{id:"step4",title:__("portfolio.step4.title"),description:__("portfolio.step4.description"),component:st}]}))}}]),t}(l.a.PureComponent);ut.defaultProps={onFinish:m.a.noop,onSave:m.a.noop,onNext:m.a.noop,onClose:m.a.noop,onBuildSuccess:m.a.noop,initialWizardStep:0};var pt=Object(E.a)({form:h.n})(Object(u.connect)((function(e){return{values:Object(y.a)(h.n)(e)}}))(ut)),ft=n(1020),mt=(n(2021),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var dt=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.currentStep=0,n.shouldSaveOnEveryStep=!1,n.state={shouldSetPortfolioName:!1,shouldShowUnsavedChangesPopup:!1},c()(n),n.wizardCreationRef=l.a.createRef(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),mt(t,[{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.invested,n=e.finished,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.props.isPristine||o||n?this.props.history.push("/portfolios/"+(t?"funded":"unfunded")):this.setState({shouldShowUnsavedChangesPopup:!0})}},{key:"onUnsavedPopupCancel",value:function(){this.setState({shouldShowUnsavedChangesPopup:!1})}},{key:"onUnsavedPopupExit",value:function(){this.setState({shouldShowUnsavedChangesPopup:!1}),this.close({},!0)}},{key:"finish",value:function(){this.props.emitEvent(h.C.CREATION,{trigger:"finish",step:step}),this.close()}},{key:"onBuildSuccess",value:function(){this.props.history.push("/portfolios/funded")}},{key:"onPortfolioNameFormClose",value:function(){this.setState({shouldSetPortfolioName:!1})}},{key:"onPortfoliosNameFormSuccess",value:function(e){this.props.setFormField("portfolioName",e),this.props.onSave(e,this.getValues(),{step:this.currentStep}),this.onPortfolioNameFormClose()}},{key:"getValues",value:function(){return this.wizardCreationRef.current.values}},{key:"save",value:function(e,t){return this.currentStep=t,m.a.isObject(e)?m.a.isEmpty(e.portfolioName)?(this.setState({shouldSetPortfolioName:!0}),!1):void this.props.onSave(e.portfolioName,e,{step:this.currentStep}):(this.setState({shouldSetPortfolioName:!0}),!1)}},{key:"next",value:function(e,t){if(this.currentStep=t,this.props.emitEvent(h.C.CREATION,{trigger:"next",step:t}),!this.shouldSaveOnEveryStep)return!0;if(!m.a.isObject(e))return this.setState({shouldSetPortfolioName:!0}),!1;if(m.a.isEmpty(e.portfolioName))return this.setState({shouldSetPortfolioName:!0}),!1;var n=e.portfolioName;return this.props.onSave(e,{step:this.currentStep},{portfolioName:n}),!0}},{key:"render",value:function(){var e=this.props,t=e.defaultUniverseType,n=e.portfolioNameFormValues,o=e.existsPortfolioNames,a=this.state,i=a.shouldSetPortfolioName,s=a.shouldShowUnsavedChangesPopup,c=n&&n.portfolioName;return l.a.createElement(_,{title:c||__("portfolio.builder.title"),description:"",onClose:this.close},i&&l.a.createElement(ot,{initialValues:{portfolioName:Object(r.i)(o)},onSuccess:this.onPortfoliosNameFormSuccess,onClose:this.onPortfolioNameFormClose,onErrorCancel:this.onPortfolioNameFormClose,onErrorClose:this.onPortfolioNameFormClose}),s&&l.a.createElement($e.a,{title:__("portfolio.builder.unsaved_changes.title"),message:__("portfolio.builder.unsaved_changes.message"),textOK:__("actions.exit"),onOK:this.onUnsavedPopupExit,onCancel:this.onUnsavedPopupCancel,onClose:this.onUnsavedPopupCancel}),l.a.createElement("div",{className:"pane pane__fluid portfolio__page"},l.a.createElement(pt,{ref:this.wizardCreationRef,initialValues:{universeType:t},onNext:this.next,onSave:this.save,onClose:this.close,onBuildSuccess:this.onBuildSuccess,onFinish:this.finish})))}}]),t}(l.a.PureComponent);dt.defaultProps={initialWizardValues:null,initialWizardStep:0,onClose:m.a.noop};var _t=Object(p.g)(Object(u.connect)((function(e){return{portfolioNameFormValues:Object(W.x)(e),defaultUniverseType:Object(W.k)(e),isPristine:Object(ft.a)(h.n)(e),existsPortfolioNames:Object(W.A)(e)}}),(function(e){return{onSave:function(t,n,o){return e(Object(Xe.r)(t,{filters:n,options:o})),e(Object(be.c)(h.n,n)),!0},setFormField:function(t,n){e(Object(be.d)(h.n,t,"Field")),e(Object(be.a)(h.n,t,n))},createLocalPortfolio:function(t,n,o){e(Object(Xe.d)(t,n,o))},emitEvent:function(t,n){e(Object(Xe.f)(t,n))}}}))(dt));n(967);var ht=function(e){var t=e.successComponent,n=e.notFoundComponent,o=e.children,a=e.data;return m.a.isEmpty(a)?n||null:m.a.isFunction(o)?o(a):t?l.a.createElement(t,{data:a}):m.a.isFunction(o)?o(a):o};ht.defaultProps={notFoundComponent:null,successComponent:null,data:null};var vt=Object(p.g)(Object(u.connect)((function(e,t){return{data:Object(W.s)(e,t.portfolioName)}}))(ht)),bt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var yt=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),bt(t,[{key:"close",value:function(e){var t=this.props.history;!e&&t.length>2?t.goBack():t.push("/portfolios"+(e?"/funded":"/unfunded"))}},{key:"save",value:function(e,t){var n=this.props.match.params.portfolioName;this.props.onSave(n,e,{step:t})}},{key:"render",value:function(){var e=this,t=this.props.match.params.portfolioName;return l.a.createElement(_,{title:t||__("portfolio.builder.title"),description:"",onClose:this.close},l.a.createElement(vt,{portfolioName:t,notFoundComponent:l.a.createElement("div",{className:"pane pane__fluid flex-valign-center flex-align-center portfolio__page"},__("portfolios.not_found")),successComponent:function(n){var o=n.data;return l.a.createElement("div",{className:"pane pane__fluid portfolio__page"},l.a.createElement(pt,{initialWizardStep:o.options.step,initialValues:o.filters,onSave:e.save,onFinish:e.close,onClose:e.close,stepOptions:{portfolioName:t},onBuildSuccess:e.close}))}}))}}]),t}(l.a.PureComponent);yt.defaultProps={initialWizardValues:null,initialWizardStep:0,onClose:m.a.noop};var Et=Object(p.g)(Object(u.connect)(null,(function(e){return{onSave:function(t,n,o){e(Object(Xe.s)(t,{filters:n,options:o}))},setFormField:function(t,n){e(Object(be.d)(h.n,t,"Field")),e(Object(be.a)(h.n,t,n))},createLocalPortfolio:function(t,n){e(Object(Xe.d)(t,n))}}}))(yt)),gt=n(869),Ot=n(263),Nt=n(46),St=n(529),wt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Ct=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:o.EMPTY},c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),wt(t,[{key:"componentDidMount",value:function(){this._mounted=!0}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"mounted",value:function(){return this._mounted}},{key:"close",value:function(){var e=this.props.history;e.length>2?e.goBack():e.push("/portfolios")}},{key:"handleClose",value:function(){this.setState({status:o.IN_PROCESS}),this.props.closePortfolio(this.props.portfolio.portfolioProviderId),this.onSuccess()}},{key:"onSuccess",value:function(){this.props.onSuccess(),this.close()}},{key:"onError",value:function(){this.setState({status:o.ERROR})}},{key:"onTryAgain",value:function(){this.setState({status:o.IN_PROCESS}),setTimeout(m.a.callIf(this.handleClose,this.mounted),500)}},{key:"render",value:function(){var e=this.state.status,t=this.props,n=t.portfolio,r=(t.onSuccess,t.onClose),i=t.onCancel,s=t.onErrorClose,c=t.onErrorCancel;if(!n&&e===o.EMPTY)return l.a.createElement(St.default,{title:__("portfolios.confirm.closing.title"),message:__("portfolios.not_found"),onOK:r===m.a.noop?this.close:r});switch(e){case o.EMPTY:case o.CONFIRM:return l.a.createElement($e.a,{title:__("portfolios.confirm.closing.title"),message:__("portfolios.confirm.closing.text",n.portfolioName),onClose:r===m.a.noop?this.close:r,onCancel:i===m.a.noop?this.close:i,onOK:this.handleClose,textOK:__("yes"),textCancel:__("no")});case o.IN_PROCESS:return l.a.createElement(d.b,null,l.a.createElement(a.a,{position:"absolute",fit:!0}));case o.ERROR:return l.a.createElement($e.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.onTryAgain,onCancel:c===m.a.noop?this.close:c,onClose:s===m.a.noop?this.close:s})}return null}}]),t}(l.a.PureComponent);Ct.defaultProps={onSuccess:m.a.noop,onClose:m.a.noop,onCancel:m.a.noop,onErrorClose:m.a.noop,onErrorCancel:m.a.noop};var Pt=Object(p.g)(Object(u.connect)((function(e,t){var n=t.portfolioProviderId,o=t.match.params;return{portfolio:Object(W.G)(e,n||o.portfolioProviderId)}}),(function(e){return{closePortfolio:function(t){return e(Object(Xe.b)(t))}}}))(Ct)),kt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var jt=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:o.EMPTY},c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),kt(t,[{key:"componentDidMount",value:function(){this._mounted=!0}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"mounted",value:function(){return this._mounted}},{key:"close",value:function(){var e=this.props.history;e.length>2?e.goBack():e.push("/portfolios")}},{key:"handleClose",value:function(){this.setState({status:o.IN_PROCESS}),this.props.deletePortfolio(this.props.portfolio.portfolioName),this.onSuccess()}},{key:"onSuccess",value:function(){this.props.onSuccess(),this.close()}},{key:"onError",value:function(){this.setState({status:o.ERROR})}},{key:"onTryAgain",value:function(){this.setState({status:o.IN_PROCESS}),setTimeout(m.a.callIf(this.handleClose,this.mounted),500)}},{key:"render",value:function(){var e=this.state.status,t=this.props,n=t.portfolio,r=(t.onSuccess,t.onClose),i=t.onCancel,s=t.onErrorClose,c=t.onErrorCancel;if(!n&&e===o.EMPTY)return l.a.createElement(St.default,{title:__("portfolios.confirm.deletion.title"),message:__("portfolios.not_found"),onOK:r===m.a.noop?this.close:r});switch(e){case o.EMPTY:case o.CONFIRM:return l.a.createElement($e.a,{title:__("portfolios.confirm.deletion.title"),message:__("portfolios.confirm.deletion.text",n.portfolioName),onClose:r===m.a.noop?this.close:r,onCancel:i===m.a.noop?this.close:i,onOK:this.handleClose,textOK:__("yes"),textCancel:__("no")});case o.IN_PROCESS:return l.a.createElement(d.b,null,l.a.createElement(a.a,{position:"absolute",fit:!0}));case o.ERROR:return l.a.createElement($e.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.onTryAgain,onCancel:c===m.a.noop?this.close:c,onClose:s===m.a.noop?this.close:s})}return null}}]),t}(l.a.PureComponent);jt.defaultProps={onSuccess:m.a.noop,onClose:m.a.noop,onCancel:m.a.noop,onErrorClose:m.a.noop,onErrorCancel:m.a.noop};var xt=Object(p.g)(Object(u.connect)((function(e,t){var n=t.portfolioName,o=t.match.params;return{portfolio:Object(W.s)(e,n||o.portfolioName)}}),(function(e){return{deletePortfolio:function(t){return e(Object(Xe.e)(t))}}}))(jt)),Rt=n(2172),At=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Tt=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return c()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),At(t,[{key:"back",value:function(){var e=this.props.history;e.length>2?e.goBack():e.push("/portfolios")}},{key:"render",value:function(){var e=this.props.portfolio;return l.a.createElement(Rt.a,{portfolioName:e&&e.portfolioName,onSuccess:this.back,onClose:this.back,onErrorClose:this.back,onErrorCancel:this.back})}}]),t}(l.a.Component),Dt=Object(p.g)(Object(u.connect)((function(e,t){var n=t.match.params.portfolioProviderId;return{portfolio:Object(W.l)(e,n)}}))(Tt)),Lt=n(138),It=n(482),Ft=n(431),Bt=n(629);var Ut=Object(u.connect)((function(e){return{sort:Object(W.p)(e)}}),(function(e){return{sortByName:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.NAME,t))},sortByCreatedDate:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.CREATED_DATE,t))},sortByChange:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.CHANGE,t))},sortByGainRebalanced:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.GAIN_REBALANCED,t))},sortByGainCreated:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.GAIN_CREATED,t))},sortByLastRebalancedDate:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.LAST_REBALANCED_DATE,t))},sortByNextRebalancedDate:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.NEXT_REBALANCED_DATE,t))},sortByPL:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.PL,t))},sortByInvestedFunds:function(t){e(Object(Xe.p)(h.D.FUNDED,h.y.INVESTED_FUNDS,t))}}}))((function(e){var t=e.sort,n=e.sortByName,o=e.sortByCreatedDate,a=e.sortByChange,r=e.sortByGainRebalanced,i=e.sortByGainCreated,s=e.sortByLastRebalancedDate,c=e.sortByNextRebalancedDate,u=e.sortByPL,p=e.sortByInvestedFunds;return l.a.createElement("thead",{className:"portfolio-table__header"},l.a.createElement("tr",{className:"portfolio-table__row"},l.a.createElement(Bt.a,{name:h.y.NAME,active:t.column===h.y.NAME,onSort:n,as:"th",className:"portfolio-table__name"},__("portfolio.table.portfolio_name")),l.a.createElement(Bt.a,{name:h.y.CREATED_DATE,active:t.column===h.y.CREATED_DATE,onSort:o,as:"th",className:"portfolio-table__date-created"},__("portfolio.table.created_date")),l.a.createElement("th",{className:"portfolio-table__position-type"},__("portfolio.table.position_type")),l.a.createElement(Bt.a,{name:h.y.CHANGE,active:t.column===h.y.CHANGE,onSort:a,as:"th",className:"portfolio-table__change"},__("portfolio.table.last7days")),l.a.createElement(Bt.a,{name:h.y.GAIN_REBALANCED,active:t.column===h.y.GAIN_REBALANCED,onSort:r,as:"th",className:"portfolio-table__gain-rebalanced"},__("portfolio.table.gain_rebalance")),l.a.createElement(Bt.a,{name:h.y.GAIN_CREATED,active:t.column===h.y.GAIN_CREATED,onSort:i,as:"th",className:"portfolio-table__gain-created"},__("portfolio.table.gain_created")),l.a.createElement(Bt.a,{name:h.y.LAST_REBALANCED_DATE,active:t.column===h.y.LAST_REBALANCED_DATE,onSort:s,as:"th",className:"portfolio-table__last-rebalance-date"},__("portfolio.table.last_rebalance_date")),l.a.createElement(Bt.a,{name:h.y.NEXT_REBALANCED_DATE,active:t.column===h.y.NEXT_REBALANCED_DATE,onSort:c,as:"th",className:"portfolio-table__next-rebalance-date"},__("portfolio.table.next_rebalance_date")),l.a.createElement(Bt.a,{name:h.y.PL,active:t.column===h.y.PL,onSort:u,as:"th",className:"portfolio-table__pl"},__("p_l")),l.a.createElement(Bt.a,{name:h.y.INVESTED_FUNDS,active:t.column===h.y.INVESTED_FUNDS,onSort:p,as:"th",className:"portfolio-table__investment-funds"},__("portfolio.table.invested_funds")),l.a.createElement("th",{className:"portfolio-table__actions"})))})),Vt=n(470),Mt=n(683),zt=n(682),Wt=n(680),Gt=n(681),qt=n(471),Kt=n(872),Ht=n(483),Yt=n(340),Qt=n(32),Xt=n.n(Qt),Jt=n(873),$t=Object(Jt.a)((function(e){var t=e.name,n=e.quantity,o=e.pl,a=e.orderSide;return l.a.createElement("tr",{className:"portfolio-table__row"},l.a.createElement("td",{colSpan:11},l.a.createElement("div",{className:"flex flex-row"},l.a.createElement("div",{className:"portfolio-table__name bold"},l.a.createElement("div",{className:"portfolio-addon"}),t),l.a.createElement("div",{className:"portfolio-pl-value portfolio--text-overflow"},l.a.createElement(Yt.a,{value:o},o?__("p_l")+": "+Xt()(o).format("0,0[.][00000000]"):l.a.createElement("div",{className:"text-muted"},"-"))),o&&l.a.createElement("div",{className:"portfolio-position-type-value"},a===h.w?__("actions.bought"):__("action.sold"),": ",n||l.a.createElement("span",{className:"text-muted"},"â€”")))))}));var Zt=Object(u.connect)((function(e,t){var n=t.portfolio;return{items:Object(W.n)(e,n.portfolioProviderId)}}))((function(e){var t=e.items,n=e.portfolio;return l.a.createElement(l.a.Fragment,null,m.a.isEmpty(t)&&l.a.createElement("tr",{className:"portfolio-table__row text-center"},l.a.createElement("td",{colSpan:11},__("portfolio.no_items"))),m.a.map(t,(function(e,t){return l.a.createElement($t,{portfolio:n,portfolioItem:e,key:t})})))}));var en=function(e){var t=e.portfolioTotalPL,n=e.executedAmount,o=e.empty,a=e.format,r=e.postfix;if(!n||!t)return o;var i=t/n*h.t,s=Xt()(i).format(a);return l.a.createElement(Yt.a,{value:i},s+r)};en.defaultProps={portfolioTotalPL:null,executedAmount:null,empty:"â€”",format:"0,0[.][00]",postfix:"%"};var tn=Object(u.connect)((function(e,t){var n=t.portfolio,o=n.portfolioProviderId,a=n.portfolioID;return{portfolioTotalPL:Object(W.q)(e,a),executedAmount:Object(W.m)(e,o)}}))(en),nn=n(108),on=n(87),an=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var rn=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return c()(e),e.state={isInfoOpen:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),an(t,[{key:"toggle",value:function(){this.props.shouldOpenInfo&&this.setState({isInfoOpen:!this.state.isInfoOpen})}},{key:"render",value:function(){var e=this.state.isInfoOpen,t=this.props,n=t.shouldShowInvest,a=t.shouldShowPerformanceLink,i=t.shouldOpenInfo,s=t.shouldShowClose,c=t.shouldShowEdit,u=t.onInvest,p=t.onClose,f=t.onPerformance,m=t.onEdit,d=this.props.portfolio,_=d.portfolioName,h=d.portfolioProviderId,v=d.portfolioStatus,b=v===o.COMPLETED,y=v===o.CLOSING,E=Object(r.k)(),g=E.start,O=E.end;return l.a.createElement(l.a.Fragment,null,l.a.createElement("tr",{className:"portfolio-table__row"},l.a.createElement("td",{className:"portfolio-table__name bold cursor--pointer",onClick:this.toggle},i&&l.a.createElement("div",{className:"portfolio-addon"},l.a.createElement("i",{className:L()({icon:!0,"icon-plus-ico":!e,"icon-minus-ico":e})})),_),l.a.createElement("td",{className:"portfolio-table__date-created"},l.a.createElement(Vt.a,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__position-type"},l.a.createElement(Gt.a,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__change"},l.a.createElement(zt.a,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__gain-rebalanced"},l.a.createElement(Kt.a,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__gain-created"},l.a.createElement(tn,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__last-rebalance-date"},l.a.createElement(Mt.a,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__next-rebalance-date"},l.a.createElement(Wt.a,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__pl change"},l.a.createElement(Ht.a,{portfolio:d})),l.a.createElement("td",{className:"portfolio-table__investment-funds portfolio--text-overflow"},l.a.createElement(qt.a,{amount:d&&(b?d.executedAmount:d.requestedAmount)})),l.a.createElement("td",{className:"portfolio-table__actions pane pane__row flex-valign-center pane_padded-small"},g&&O&&l.a.createElement("i",{className:"pane icon icon-clock mh-5","data-tooltip-align":"bottom","aria-label":g+" - "+O+" ("+nn.user.GMTPostfix()+")"}),c&&b&&l.a.createElement("span",{className:"portfolio--edit-icon",onClick:function(){return m(d)}},l.a.createElement(on.default,{name:"edit_portfolio",width:16,height:15})),b&&l.a.createElement(l.a.Fragment,null,s&&l.a.createElement("i",{className:"pane icon icon-close-round-square cursor--pointer",onClick:function(){return p(h)}}),n&&l.a.createElement(Lt.a,{btnType:"primary",onClick:function(){return u(h)},className:"pane",size:"small"},__("actions.invest")),a&&l.a.createElement("a",{href:"#",className:"pane",onClick:function(e){e.preventDefault(),f(h)}},__("portfolio.performance.link"))),!b&&l.a.createElement(l.a.Fragment,null,s&&l.a.createElement("div",{className:"pane portfolio__item-action-width",onClick:function(){return p(h)}}),l.a.createElement("div",{className:"pane"},__("status.title"),":"),l.a.createElement("div",{className:"pane text-muted","aria-label":y?__("portfolio.status.close_pending.tooltip"):__("portfolio.status.tooltip"),"data-tooltip-align":"right"},__("status.pending"))))),e&&l.a.createElement(Zt,{portfolio:d}))}}]),t}(l.a.Component);rn.defaultProps={onClose:m.a.noop,onPerformance:m.a.noop,onInvest:m.a.noop,onEdit:m.a.noop,shouldShowPerformanceLink:!1,shouldOpenInfo:!0,shouldShowInvest:!1,shouldShowPL:!1,shouldShowInvestFunds:!1,shouldShowClose:!0,shouldShowEdit:!1,portfolio:null};var ln=rn,sn=n(647),cn=n(648),un=n(63),pn=n(6),fn=n.n(pn),mn=n(874),dn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var _n=function(e){var t=e.input,n=t.value,o=t.onChange,a=t.onBlur,r=t.onFocus,i=t.name,s=e.className,c=e.step,u=e.meta.error;return l.a.createElement("div",{className:s},l.a.createElement(cn.a,{name:i,type:"text",className:"form-control input-field",value:n,onChange:o,onFocus:r,onBlur:a,error:!!u,errorMessage:u}),l.a.createElement(sn.a,{onPlusClick:function(){return o(n&&Number(n)-c>-1?Number(n)+c:c)},onMinusClick:function(){return o(n&&Number(n)-c>-1?Number(n)-c:0)}}))},hn=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputStep=n.props.getStepIncrement(n.requestedAmount),c()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),dn(t,[{key:"componentDidMount",value:function(){this._mounted=!0}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"mounted",value:function(){return this._mounted}},{key:"onUpdatePortfolioSuccess",value:function(){this.props.onSuccess()}},{key:"trySubmitAgain",value:function(){this.props.dispatch(Object(be.e)(this.props.form))}},{key:"validateTakeProfit",value:function(e,t,n){n.syncErrors}},{key:"validateStopLoss",value:function(e,t,n){var o=n.syncErrors,a=o&&o.amount?fn.a.getUserAccountMetricsModel().getBuyingPower():t.amount;if(e=Number(e),!m.a.isNaN(e)){var r=a-1;return e>r?__("portfolio.errors.stopLoss.too_high",r.toFixed(2)):void 0}}},{key:"submit",value:function(e,t,n){var o=e.takeProfit,a=e.stopLoss,r=e.portfolioName;return n.clearSubmitErrors(),n.startSubmit(),this.props.updatePortfolio(this.props.portfolioProviderId,r,o,a).then((function(e){n.setSubmitSucceeded()})).then(m.a.callIf(this.onUpdatePortfolioSuccess,this.mounted)).catch((function(){n.setSubmitFailed()})),!1}},{key:"isLiquidation",value:function(){return m.a.contains(un.MARGIN_VALUES_WARNING_LEVELS,this.props.marginLevelRange)}},{key:"render",value:function(){var e=this.props,t=e.invalid,n=e.onClose,o=e.handleSubmit,r=e.submitting,i=e.submitFailed,s=e.normalizeNumber,c=e.portfolioName,u=fn.a.getUserCurrency();return i?l.a.createElement($e.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.trySubmitAgain,onCancel:n,onClose:n}):l.a.createElement(d.b,{popupStyle:"quant",onClose:n,title:__("portfolio.update.popup.title")+" - "+c},l.a.createElement(d.a,null,r&&l.a.createElement(a.a,{position:"absolute",fit:!0}),l.a.createElement(X.a,{autoComplete:"off",onSubmit:o(this.submit),className:"form form__amount pane pane__fluid pane__column pane_padded-small pane--relative"},l.a.createElement("div",{key:"invest-portfolio-form",className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"form-row"},l.a.createElement("div",{className:"pane pane__fluid fs-13 pane__row flex-valign-center"},l.a.createElement("div",{className:"pane"},l.a.createElement("i",{className:"icon icon-information","aria-label":__("portfolio.amount.popup.tooltip.take_profit")})),l.a.createElement("div",{className:"pane pane__column pane__fluid"},l.a.createElement("div",null,__("portfolio.amount.popup.take_profit")),l.a.createElement("div",null,u))),l.a.createElement(ae.a,{name:"takeProfit",className:"pane",component:_n,step:this.inputStep,validate:this.validateTakeProfit,normalize:s})),l.a.createElement("div",{className:"form-row"},l.a.createElement("div",{className:"pane pane__fluid fs-13 pane__row flex-valign-center"},l.a.createElement("div",{className:"pane"},l.a.createElement("i",{className:"icon icon-information","aria-label":__("portfolio.amount.popup.tooltip.stop_loss")})),l.a.createElement("div",{className:"pane pane__column pane__fluid"},l.a.createElement("div",null,__("portfolio.amount.popup.stop_loss")),l.a.createElement("div",null,u))),l.a.createElement(ae.a,{name:"stopLoss",className:"pane",component:_n,step:this.inputStep,validate:this.validateStopLoss,normalize:s}),l.a.createElement(ae.a,{name:"portfolioName",component:"input",type:"hidden",value:c}))),l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement("div",{className:"pane pane__xfluid"},l.a.createElement("button",{className:"btn btn-primary pane pane__fluid flex-align-center",type:"submit",disabled:this.isLiquidation()||t},__("actions.update")))))))}}]),t}(l.a.PureComponent);hn.defaultProps={portfolio:{},updatePortfolio:m.a.noop,onSuccess:m.a.noop,onClose:m.a.noop};var vn=Object(E.a)({form:h.z,getStepIncrement:function(e){var t=parseInt(e/10/h.t,10)*h.t;return t>100?t:100},normalizeNumber:function(e,t){return m.a.isEmpty(e)?e:/^\d*\.?\d{0,2}$/gi.test(e)?e:t}})(hn),bn=Object(mn.a)(vn),yn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var En=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={shouldShowEditPopup:!1},c()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),yn(t,[{key:"onPerformance",value:function(e){this.props.history.push("/portfolios/performance/"+e)}},{key:"onClose",value:function(e){this.props.history.push("/portfolios/funded/close/"+e)}},{key:"onEdit",value:function(e){var t=e.portfolioProviderId,n=e.portfolioName;this.setState({shouldShowEditPopup:!0,portfolioName:n,portfolioProviderId:t})}},{key:"onEditSuccess",value:function(){this.setState({shouldShowEditPopup:!1})}},{key:"onEditClose",value:function(){this.setState({shouldShowEditPopup:!1})}},{key:"render",value:function(){var e=this,t=this.props.portfolios,n=this.state,o=n.shouldShowEditPopup,a=n.portfolioProviderId,r=n.portfolioName,i=m.a.isEmpty(t);return l.a.createElement("div",{className:"pane flex-column portfolios-content"},l.a.createElement("div",{className:"p-10 color__brand-primary bold portfolios__title"},!i&&__("portfolios.funded.title")),l.a.createElement("div",{className:"pane pane__fluid flex-column"},!i&&l.a.createElement("table",{className:"portfolio-table"},l.a.createElement(Ut,null),l.a.createElement("tbody",{className:"portfolio-table__body"},m.a.map(t,(function(t,n){return l.a.createElement(ln,{key:n,portfolio:t,onPerformance:e.onPerformance,onClose:e.onClose,onEdit:e.onEdit,shouldShowPerformanceLink:!0,shouldShowEdit:!0,shouldShowClose:!0})})))),o&&l.a.createElement(bn,{onSuccess:this.onEditSuccess,onClose:this.onEditClose,portfolioName:r,portfolioProviderId:a})))}}]),t}(i.PureComponent),gn=Object(p.g)(Object(u.connect)((function(e){return{portfolios:Object(W.P)(e)}}))(En));var On=Object(u.connect)((function(e){return{sort:Object(W.U)(e)}}),(function(e){return{sortByName:function(t){e(Object(Xe.p)(h.D.UNFUNDED,h.y.NAME,t))},sortByCreatedDate:function(t){e(Object(Xe.p)(h.D.UNFUNDED,h.y.CREATED_DATE,t))}}}))((function(e){var t=e.sort,n=e.sortByName,o=e.sortByCreatedDate;return l.a.createElement("thead",{className:"portfolio-table__header"},l.a.createElement("tr",{className:"portfolio-table__row"},l.a.createElement(Bt.a,{name:h.y.NAME,active:t.column===h.y.NAME,onSort:n,as:"th",className:"portfolio-table__name"},__("portfolio.table.portfolio_name")),l.a.createElement(Bt.a,{name:h.y.CREATED_DATE,active:t.column===h.y.CREATED_DATE,onSort:o,as:"th",className:"portfolio-table__date-created"},__("portfolio.table.created_date")),l.a.createElement("th",{className:"portfolio-table__investment-funds"},__("portfolio.table.invested_funds")),l.a.createElement("th",{className:"portfolio-table__position-type"},__("portfolio.table.position_type")),l.a.createElement("th",{className:"portfolio-table__change"},__("portfolio.table.last7days")),l.a.createElement("th",{className:"portfolio-table__gain-rebalanced"},__("portfolio.table.gain_rebalance")),l.a.createElement("th",{className:"portfolio-table__gain-created"},__("portfolio.table.gain_created")),l.a.createElement("th",{className:"portfolio-table__last-rebalance-date"},__("portfolio.table.last_rebalance_date")),l.a.createElement("th",{className:"portfolio-table__next-rebalance-date"},__("portfolio.table.next_rebalance_date")),l.a.createElement("th",{className:"portfolio-table__actions"})))})),Nn=n(871);var Sn=function(e){var t=e.meta,n=e.empty,o=e.format;return l.a.createElement("div",{className:L()({change:!0,up:t&&t.returnSinceSaved>0,down:t&&t.returnSinceSaved<0,"text-muted":t&&0===t.returnSinceSaved})},t?Xt()(t.returnSinceSaved).format(o)+"%":n)};Sn.defaultProps={meta:null,empty:"â€”",format:"0,0.[000]"};var wn=Object(u.connect)((function(e,t){var n=t.portfolio;return{meta:n&&Object(W.z)(e,n.portfolioProviderId)}}))(Sn),Cn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Pn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Cn(t,[{key:"render",value:function(){var e=this.props,t=e.shouldShowInvest,n=e.shouldShowPerformanceLink,o=e.shouldShowFinish,a=e.shouldShowEdit,i=e.shouldShowClose,s=e.onInvest,c=e.onFinish,u=e.onEdit,p=e.onDelete,f=e.onPerformance,m=this.props.portfolio,d=m.portfolioName,_=Object(r.k)(),h=_.start,v=_.end;return l.a.createElement(l.a.Fragment,null,l.a.createElement("tr",{className:"portfolio-table__row"},l.a.createElement("td",{className:"portfolio-table__name bold"},d),l.a.createElement("td",{className:"portfolio-table__date-created"},l.a.createElement(Vt.a,{portfolio:m})),l.a.createElement("td",{className:"portfolio-table__investment-funds portfolio--text-overflow"},l.a.createElement(qt.a,{amount:m&&m.requestedAmount})),l.a.createElement("td",{className:"portfolio-table__position-type"},l.a.createElement(Gt.a,null)),l.a.createElement("td",{className:"portfolio-table__change"},l.a.createElement(Nn.a,{portfolio:m})),l.a.createElement("td",{className:"portfolio-table__gain-rebalanced"},l.a.createElement(zt.a,{portfolio:m})),l.a.createElement("td",{className:"portfolio-table__gain-created"},l.a.createElement(wn,{portfolio:m})),l.a.createElement("td",{className:"portfolio-table__last-rebalance-date"},l.a.createElement(Mt.a,{portfolio:m})),l.a.createElement("td",{className:"portfolio-table__next-rebalance-date"},l.a.createElement(Wt.a,{portfolio:m})),l.a.createElement("td",{className:"portfolio-table__actions pane pane__row flex-valign-center"},h&&v&&l.a.createElement("i",{className:"pane icon icon-clock mh-5","data-tooltip-align":"bottom","aria-label":h+" - "+v+" ("+nn.user.GMTPostfix()+")"}),a&&l.a.createElement("i",{className:"pane icon icon-edit-oblique cursor--pointer",onClick:function(){return u(d)}}),i&&l.a.createElement("i",{className:"pane icon icon-close-round-square cursor--pointer",onClick:function(){return p(d)}}),l.a.createElement(l.a.Fragment,null,t&&l.a.createElement(Lt.a,{btnType:"primary",onClick:function(){return s(d)},className:"pane pane--center",size:"small"},__("actions.invest")),o&&l.a.createElement(Lt.a,{btnType:"primary",onClick:function(){return c(d)},className:"pane pane--center",size:"small"},__("actions.finish")),n&&l.a.createElement("a",{href:"#",className:"pane",onClick:function(e){e.preventDefault(),f(d)}},__("portfolio.performance.link"))))))}}]),t}(l.a.Component);Pn.defaultProps={onEdit:m.a.noop,onDelete:m.a.noop,onPerformance:m.a.noop,onInvest:m.a.noop,onFinish:m.a.noop,shouldShowPerformanceLink:!1,shouldShowInvest:!1,shouldShowFinish:!1,shouldShowPL:!1,shouldShowInvestFunds:!1,shouldShowEdit:!1,portfolio:null,metric:null,shouldShowClose:!0};var kn=Pn,jn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var xn=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return c()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),jn(t,[{key:"onPerformance",value:function(e){this.props.history.push("/portfolios/performance/"+e)}},{key:"onDelete",value:function(e){this.props.history.push("/portfolios/unfunded/delete/"+e)}},{key:"onInvest",value:function(e){Object(r.E)({portfolioName:e})}},{key:"onEdit",value:function(e){this.props.history.push("/portfolios/unfunded/edit/"+e)}},{key:"render",value:function(){var e=this,t=this.props.portfolios,n=m.a.isEmpty(t);return l.a.createElement("div",{className:"pane flex-column portfolios-content"},l.a.createElement("div",{className:"p-10 color__brand-primary bold portfolios__title"},!n&&__("portfolios.unfunded.title")),l.a.createElement("div",{className:"pane pane__fluid flex-column"},!n&&l.a.createElement("table",{className:"portfolio-table"},l.a.createElement(On,null),l.a.createElement("tbody",{className:"portfolio-table__body"},m.a.map(t,(function(t,n){return l.a.createElement(kn,{key:n,portfolio:t,onEdit:e.onEdit,onPerformance:e.onPerformance,onDelete:e.onDelete,onInvest:e.onInvest,onFinish:e.onEdit,shouldShowPerformanceLink:t.options&&t.options.filled,shouldShowInvest:t.options&&t.options.filled,shouldShowFinish:t.options&&!t.options.filled,shouldShowEdit:!0,shouldShowClose:!0,shouldShowStatus:!1})}))))))}}]),t}(i.PureComponent),Rn=Object(p.g)(Object(u.connect)((function(e){return{portfolios:Object(W.Q)(e)}}))(xn)),An=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Tn=[{value:"funded",title:"portfolios.funded.title"},{value:"unfunded",title:"portfolios.unfunded.title"}];var Dn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),An(t,[{key:"render",value:function(){var e=this.props,t=e.portfolioTypes,n=e.selectedPortfolioType,o=e.match.params.type,a=this.props,r=a.totalPortfoliosCount,i=a.fundedPortfoliosCount,s=a.unfundedPortfoliosCount,c=o&&m.a.findWhere(t,{value:o})||n;return o?l.a.createElement("div",{className:"pane pane__fluid flex-column fs-13"},l.a.createElement("div",{className:"pane pane__row p-10 portfolio__page"},l.a.createElement("div",{className:"pane pane__fluid pane__row"},l.a.createElement("div",{className:"pane pane__fluid flex-column"},l.a.createElement("b",null,__("portfolios.title")),l.a.createElement("div",null,"Â ")),l.a.createElement("div",{className:"pane flex-valign-end pane__row"},r?l.a.createElement("div",{className:"pane"},l.a.createElement(Ft.b,{to:"create"},l.a.createElement(Lt.a,{btnType:"primary",size:"small"},__("portfolios.create")))):null))),r>0&&l.a.createElement("div",{className:"pane pane__fluid pane__scroll"},l.a.createElement("div",{className:"pane pane__fluid pane__column pane__scroll-content"},i>0&&l.a.createElement(gn,null),s>0&&l.a.createElement(Rn,null),l.a.createElement(z.a,{className:"color--muted fs-13 padded"}))),0===r&&l.a.createElement("div",{className:"pane pane__fluid pane__column"},l.a.createElement(It.a,{className:"pane pane__fluid",shouldShowCreate:!0}),l.a.createElement(z.a,{className:"pane pane__xfluid color--muted fs-13 padded"})),0===r&&l.a.createElement(p.a,{to:"/portfolios/create"})):l.a.createElement(p.a,{to:"/portfolios/"+c.value})}}]),t}(i.PureComponent);Dn.defaultProps={selectedPortfolioType:m.a.first(Tn),portfolioTypes:Tn};var Ln=Object(p.g)(Object(u.connect)((function(e){return{totalPortfoliosCount:Object(W.S)(e),fundedPortfoliosCount:Object(W.r)(e),unfundedPortfoliosCount:Object(W.V)(e)}}))(Dn)),In=n(679),Fn=n(870),Bn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Un=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={shouldRunPerformanceLoader:!0,statusOfPerformanceLoader:o.EMPTY},c()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Bn(t,[{key:"onPerformanceLoaderSuccess",value:function(e){var t=e.loadedPerformance,n=e.loadedOverview;this.setState({loadedPerformance:t,loadedOverview:n,shouldRunPerformanceLoader:!1,statusOfPerformanceLoader:o.SUCCESS})}},{key:"onPerformanceLoaderError",value:function(){this.setState({shouldRunPerformanceLoader:!1,statusOfPerformanceLoader:o.ERROR})}},{key:"render",value:function(){var e=this.state,t=e.shouldRunPerformanceLoader,n=e.statusOfPerformanceLoader,r=e.loadedPerformance,i=e.loadedOverview,s=this.props,c=s.portfolio,u=s.onErrorCancel,p=s.onErrorClose,f=s.universeTypes,d=s.onClosePortfolio,_=r||{},v=_.backtestRequest,b=_.backtestPerformance,y=_.backtestInsights,E=(i||{}).lastPortfolioData,g=v&&m.a.findWhere(h.K,{value:v.timeHorizon}),O=v&&m.a.findWhere(f,{value:v.universeTypeID});return l.a.createElement("div",{className:"pane pane__scroll-content pane__fluid flex-column"},l.a.createElement("table",{className:"portfolio-table"},l.a.createElement(Ut,null),l.a.createElement("tbody",{className:"portfolio-table__body"},l.a.createElement(ln,{portfolio:c,shouldShowPerformanceLink:!1,onClose:d}))),l.a.createElement("div",{className:"pane pane__fluid page"},l.a.createElement("div",{className:"pane p-10"},t&&l.a.createElement(a.a,{position:"absolute",fit:!0}),t&&l.a.createElement(Fn.a,{portfolioProviderId:c.portfolioProviderId,onSuccess:this.onPerformanceLoaderSuccess,onErro:this.onPerformanceLoaderError,onErrorClose:p,onErrorCancel:u}),n===o.SUCCESS&&l.a.createElement("div",{className:"pane pane__fluid pane__column portfolio__performance"},l.a.createElement("div",{className:"pane pane__fluid pane__row portfolio__performance-row"},l.a.createElement("div",{className:"pane pane__fluid portfolio__performance-row-item"},l.a.createElement(In.a,{selectedUniverseTypeID:v&&v.universeTypeID,selectedSectors:v&&v.sectors,selectedTimeHorizon:v&&v.timeHorizon,selectedLongPositionFactor:v&&v.backtestPortfolioSetup.longPositionFactor,selectedSignals:v&&v.scoreCriteria})),l.a.createElement("div",{className:"pane pane__fluid portfolio__performance-row-item"},l.a.createElement(Ye.a,{compact:!0,universeName:O&&__(O.label),dailyReturnData:b&&b.dailyReturnData,yearlyPerformanceData:b&&b.yearlyPerformanceData})),l.a.createElement("div",{className:"pane pane__fluid portfolio__performance-row-item"},l.a.createElement(He.a,{timeHorizon:g&&g.value,yearlyInsightsData:y}))),l.a.createElement("div",{className:"pane"},l.a.createElement(Qe.a,{yearlyPerformanceData:b&&b.yearlyPerformanceData})),l.a.createElement("div",{className:"pane"},l.a.createElement(Ke.a,{lastPortfolioPositionData:E.positions}))))))}}]),t}(i.PureComponent);Un.defaultProps={portfolio:null,universeTypes:Ie.a,onClosePortfolio:m.a.noop,onErrorCancel:m.a.noop,onErrorClose:m.a.noop};var Vn=Un,Mn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var zn=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={shouldRunBacktest:!0,statusOfBacktestRunner:o.EMPTY},c()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Mn(t,[{key:"onBacktestRunnerSuccess",value:function(e){this.setState({createdBacktest:e,shouldRunBacktest:!1,statusOfBacktestRunner:o.SUCCESS})}},{key:"onBacktestRunnerError",value:function(){this.setState({shouldRunBacktest:!1,statusOfBacktestRunner:o.ERROR})}},{key:"render",value:function(){var e=this.state,t=e.shouldRunBacktest,n=e.statusOfBacktestRunner,i=e.createdBacktest,s=this.props,c=s.portfolio,u=s.onErrorCancel,p=(s.onErrorClose,s.onDeletePortfolio),f=c&&c.filters;return l.a.createElement("div",{className:"pane pane__fluid flex-column"},l.a.createElement("div",{className:"pane pane__column pane__xfluid header--lighter"},l.a.createElement(On,null),l.a.createElement("div",{className:"portfolio-table__body page"},l.a.createElement(kn,{portfolio:c,shouldShowPerformanceLink:!1,onDelete:p}))),l.a.createElement("div",{className:"pane pane__fluid p-10 portfolio__page"},t&&l.a.createElement(a.a,{position:"absolute",fit:!0}),t&&l.a.createElement(Je.a,{filters:f,onSuccess:this.onBacktestRunnerSuccess,onError:this.onBacktestRunnerError,onErrorOK:u}),n===o.SUCCESS&&l.a.createElement("div",{className:"pane pane__fluid pane__column portfolio__performance"},l.a.createElement("div",{className:"pane pane__fluid pane__row portfolio__performance-row"},l.a.createElement("div",{className:"pane pane__fluid portfolio__performance-row-item"},l.a.createElement(In.a,{selectedUniverseTypeID:f.universeType&&f.universeType.value,selectedSectors:m.a.pick(f.sectors,"value"),selectedMarketCap:f.marketCap,selectedDailyVolume:f.dailyVolume,selectedPeRatio:f.peRatio,selectedBeta:f.beta,selectedTimeHorizon:f.timeHorizon&&f.timeHorizon.value,selectedLongPositionFactor:f.longPositionFactor&&f.longPositionFactor.value,selectedSignals:Object(r.p)(f),shouldFindSignalNames:!0})),l.a.createElement("div",{className:"pane pane__fluid portfolio__performance-row-item"},l.a.createElement(Ye.a,{compact:!0,universeName:f.universeType&&f.universeType.label,dailyReturnData:i.backtest.dailyReturnData,yearlyPerformanceData:i.backtest.yearlyPerformanceData})),l.a.createElement("div",{className:"pane pane__fluid portfolio__performance-row-item"},l.a.createElement(He.a,{timeHorizon:f.timeHorizon&&f.timeHorizon.value,yearlyInsightsData:i.overview.yearlyInsightsData}))),l.a.createElement("div",{className:"pane"},l.a.createElement(Qe.a,{yearlyPerformanceData:i.backtest.yearlyPerformanceData})),l.a.createElement("div",{className:"pane"},l.a.createElement(Ke.a,{lastPortfolioPositionData:i.overview.lastPortfolioData.positions})))))}}]),t}(i.PureComponent);zn.defaultProps={portfolio:null,onErrorCancel:m.a.noop,onErrorClose:m.a.noop,onDeletePortfolio:m.a.noop};var Wn=zn,Gn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var qn=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={shouldClosePortfolio:!1,shouldDeletePortfolio:!1,portfolioName:null},c()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Gn(t,[{key:"back",value:function(e){e.preventDefault();var t=this.props.history;t.length>2?t.goBack():t.push("/portfolios")}},{key:"onDeletePortfolio",value:function(e){this.setState({shouldDeletePortfolio:!0,portfolioName:e})}},{key:"onDeleteFinish",value:function(){this.setState({shouldDeletePortfolio:!1})}},{key:"onClosePortfolio",value:function(e){this.setState({shouldClosePortfolio:!0,portfolioProviderId:e})}},{key:"onCloseFinish",value:function(){this.setState({shouldClosePortfolio:!1})}},{key:"render",value:function(){var e=this.props.portfolio,t=e||{},n=t.local,o=t.remote,a=!!o,r=!a&&!!n,i=this.state,s=i.shouldDeletePortfolio,c=i.shouldClosePortfolio,u=i.portfolioName,p=i.portfolioProviderId;return l.a.createElement("div",{className:"pane pane__fluid flex-column fs-13"},l.a.createElement("div",{className:"pane pane__row p-10 portfolio__page"},l.a.createElement("div",{className:"pane pane__fluid pane__row"},l.a.createElement("div",{className:"pane pane__fluid flex-column"},l.a.createElement("b",null,__("portfolios.details")),l.a.createElement("div",null,l.a.createElement("a",{href:"#",onClick:this.back},"<",__("portfolios.title")))))),l.a.createElement("div",{className:"pane pane__fluid pane__scroll"},l.a.createElement("div",{className:"pane pane__scroll-content pane__fluid flex-column"},s&&l.a.createElement(xt,{portfolioName:u,onCancel:this.onDeleteFinish,onClose:this.onDeleteFinish,onSuccess:this.onDeleteFinish,onErrorClose:this.onDeleteFinish,onErrorCancel:this.onDeleteFinish}),c&&l.a.createElement(Pt,{portfolioProviderId:p,onCancel:this.onCloseFinish,onClose:this.onCloseFinish,onSuccess:this.onCloseFinish,onErrorClose:this.onCloseFinish,onErrorCancel:this.onCloseFinish}),!e&&l.a.createElement("div",null,__("portfolios.not_found")),a&&l.a.createElement(Vn,{onErrorCancel:this.back,onErrorClose:this.back,onClosePortfolio:this.onClosePortfolio,portfolio:o}),r&&l.a.createElement(Wn,{onErrorCancel:this.back,onErrorClose:this.back,portfolio:n,onDeletePortfolio:this.onDeletePortfolio}))))}}]),t}(i.PureComponent),Kn=Object(p.g)(Object(u.connect)((function(e,t){var n=t.match.params.portfolioProviderId;return{portfolio:Object(W.w)(e,n)}}))(qn)),Hn=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Yn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Hn(t,[{key:"componentDidMount",value:function(){this.props.changeInstrumentInfoVisibility(o.HIDDEN),this.props.emitEvent(h.C.IMPRESSION)}},{key:"render",value:function(){var e=l.a.createElement("div",{className:"pane pane__fluid flex-align-center flex-valign-center"},l.a.createElement(a.a,{fit:!0})),t=l.a.createElement("div",{className:"pane pane__fluid flex-align-center flex-valign-center"},l.a.createElement("div",null,b()(__("server.request.generic.error.body",__("link.contact_us.funded.client")))));return l.a.createElement(g.a,{loaderComponent:e,errorComponent:t},l.a.createElement(gt.a,{loaderComponent:e,errorComponent:t,successComponent:l.a.createElement(l.a.Fragment,null,l.a.createElement(p.d,null,l.a.createElement(p.b,{path:"/portfolios/performance/:portfolioProviderId",component:Kn}),l.a.createElement(p.b,{path:"/portfolios/:type",component:Ln}),l.a.createElement(p.b,{exact:!0,path:"/portfolios",component:Ln})),l.a.createElement(p.d,null,l.a.createElement(p.b,{path:"/portfolios/create",component:_t}),l.a.createElement(p.b,{path:"/portfolios/edit/:portfolioName",component:Et}),l.a.createElement(p.b,{path:"/portfolios/funded/close/:portfolioProviderId",component:Pt}),l.a.createElement(p.b,{path:"/portfolios/funded/invest/:portfolioProviderId",component:Dt}),l.a.createElement(p.b,{path:"/portfolios/unfunded/delete/:portfolioName",component:xt}),l.a.createElement(p.b,{path:"/portfolios/unfunded/edit/:portfolioName",component:Et})))}))}}]),t}(l.a.PureComponent);t.default=Object(u.connect)((function(e){return{isPortfoliosEnabled:Object(Ot.isPortfolioEnabled)(e)}}),(function(e){return{changeInstrumentInfoVisibility:function(t){e(Object(Nt.changeInstrumentInfoVisibility)(t))},emitEvent:function(t,n){e(Object(Xe.f)(t,n))}}}))(Yn)},1955:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(4),i=n(645),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),l(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"pane pane__column flex-align-center"},a.a.createElement("div",{className:"fs-18"},__("invest.welcome.to")),a.a.createElement("div",{className:"invest__page-title fs-35 text-primary text-uppercase"},__("invest.title")),a.a.createElement("div",{className:"invest__page-description"},__("invest.description")))}}]),t}(o.PureComponent),c=n(2083),u=n(1989),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),p(t,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(s,null),a.a.createElement("div",{className:"pane pane__row invest__page-content"},a.a.createElement("div",{className:"section quant-architect pane pane__column"},a.a.createElement(c.a,{service:u.b})),a.a.createElement("div",{className:"separator"}),a.a.createElement("div",{className:"section dma-exchange pane pane__column"},a.a.createElement(c.a,{service:u.a}))),a.a.createElement("div",{className:"pane flex-align-end"},a.a.createElement(i.a,null)))}}]),t}(o.PureComponent),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),m(t,[{key:"render",value:function(){var e=this.props.service;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"pane pane__row invest__page-content-single"},a.a.createElement("div",{className:"pane pane__column left"},a.a.createElement("div",{className:"flex flex-align-center fs-18"},__("invest.welcome.to")),a.a.createElement("div",{className:"flex flex-align-center title fs-26 text-primary text-uppercase"},__("invest.title")),a.a.createElement("div",{className:"flex flex-align-center help-wrapper"},a.a.createElement(i.a,null))),a.a.createElement("div",{className:"separator"}),a.a.createElement("div",{className:"right"},a.a.createElement("div",{className:"description"},__("invest.description."+e)),a.a.createElement(c.a,{service:e}))))}}]),t}(o.PureComponent),_=(n(2124),n(261)),h=n.n(_),v=n(3),b=n(46),y=n(263),E=n(192),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),g(t,[{key:"componentDidMount",value:function(){this.props.changeInstrumentInfoVisibility(v.HIDDEN)}},{key:"render",value:function(){var e=this.props,t=e.isPortfolioEnabledFlag,n=e.isSaxoEnabledFlag;return t||n?a.a.createElement("div",{className:"pane pane__row pane__xfluid invest__wrapper"},a.a.createElement(h.a,null,a.a.createElement("div",{className:"pane pane__column pane__fluid invest__page"},t&&n&&a.a.createElement(f,null),t&&!n&&a.a.createElement(d,{service:u.b}),!t&&n&&a.a.createElement(d,{service:u.a})))):a.a.createElement(E.a,{to:"/"})}}]),t}(a.a.PureComponent);t.default=Object(r.connect)((function(e){return{isPortfolioEnabledFlag:Object(y.isPortfolioEnabled)(e),isSaxoEnabledFlag:Object(y.isSaxoEnabled)(e)}}),(function(e){return{changeInstrumentInfoVisibility:function(t){e(Object(b.changeInstrumentInfoVisibility)(t))}}}))(O)},1989:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var o="quant_architect",a="dma_exchange"},2021:function(e,t,n){},2083:function(e,t,n){"use strict";var o=n(0),a=n.n(o),r=n(1),i=n.n(r),l=n(4),s=n(41),c=n(87),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),u(t,[{key:"render",value:function(){var e=this.props.service;return a.a.createElement("div",{className:"pane pane__column title-container"},a.a.createElement(c.default,{name:e,width:65,height:62}),a.a.createElement("div",{className:"text-primary text-uppercase service-title"},__("invest."+e)))}}]),t}(o.PureComponent),f=n(1989),m=n(1913),d=n(91),_=n.n(d),h=n(2085),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),v(t,[{key:"render",value:function(){var e=this.props.service;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"pane pane__column pane__yfluid"},a.a.createElement("div",{className:"service-description"},a.a.createElement("div",{className:"text-block"},a.a.createElement("div",null,_()(__("invest."+e+".description")))))),a.a.createElement("div",{className:"service-action"},e===f.b&&a.a.createElement(m.default,null),e===f.a&&a.a.createElement(h.a,null)))}}]),t}(o.PureComponent),y=n(3),E=n(149),g=n(642),O=n(230),N=n(123),S=n(15),w=n.n(S),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var P=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={status:y.IN_PROCESS},w()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),C(t,[{key:"tryAgain",value:function(e){e.preventDefault(),this.setState({status:y.IN_PROCESS}),i.a.delay(i.a.callIf(this.load,this.mounted),300)}},{key:"componentDidMount",value:function(){this._mounted=!0,this.load()}},{key:"load",value:function(){this.setState({status:y.IN_PROCESS}),this.props.loadPerformance().then(i.a.callIf(this.onSuccess,this.mounted)).catch(i.a.callIf(this.onError,this.mounted))}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"onSuccess",value:function(e){e?(this.setState({status:y.SUCCESS,loadedPerformance:e}),this.props.onSuccess(e)):this.setState({status:y.ERROR})}},{key:"onError",value:function(){this.setState({status:y.ERROR})}},{key:"mounted",value:function(){return this._mounted}},{key:"render",value:function(){var e=this.props,t=e.onErrorCancel,n=e.onErrorOK,o=e.onErrorClose;return this.state.status===y.ERROR?a.a.createElement(O.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:n===i.a.noop?this.tryAgain:n,onCancel:t,onClose:o}):null}}]),t}(o.PureComponent);P.defaultProps={onSuccess:i.a.noop,onErrorCancel:i.a.noop,onErrorOK:i.a.noop,onErrorClose:i.a.noop};var k=Object(l.connect)(null,(function(e,t){var n=t.portfolioProviderId;return{loadPerformance:function(){return e(Object(N.k)(n))}}}))(P),j=n(414),x=(n(967),n(2021),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var R=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={shouldRunPerformanceLoader:!0,statusOfPerformanceLoader:y.EMPTY,portfolio:{}},w()(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),x(t,[{key:"onPerformanceLoaderSuccess",value:function(e){this.setState({loadedPerformance:e,shouldRunPerformanceLoader:!1,statusOfPerformanceLoader:y.SUCCESS})}},{key:"onPerformanceLoaderError",value:function(){this.setState({shouldRunPerformanceLoader:!1,statusOfPerformanceLoader:y.ERROR})}},{key:"componentWillMount",value:function(){i.a.size(this.props.portfolios)>=1&&this.setState({portfolio:this.props.portfolios[0]})}},{key:"onChangePortfolio",value:function(e){this.setState({portfolio:e,shouldRunPerformanceLoader:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.shouldRunPerformanceLoader,o=t.statusOfPerformanceLoader,r=t.loadedPerformance,l=t.portfolio,s=this.props,c=s.portfolios,u=s.onErrorCancel,p=s.onErrorClose,f=s.universeTypes,d=r||{},_=d.backtestRequest,h=d.backtestPerformance,v=_&&i.a.findWhere(f,{value:_.universeTypeID});return a.a.createElement("div",{className:"pane pane__column quant-architect-portfolio"},a.a.createElement(j.default,{getOptionLabel:function(e){return e.portfolioName},getOptionValue:function(e){return e.portfolioID},onChange:function(t){return e.onChangePortfolio(t)},options:c,defaultValue:l}),n&&a.a.createElement(E.a,{position:"absolute",fit:!0}),n&&a.a.createElement(k,{portfolioProviderId:l.portfolioProviderId,onSuccess:this.onPerformanceLoaderSuccess,onErro:this.onPerformanceLoaderError,onErrorClose:p,onErrorCancel:u}),a.a.createElement("div",{className:"portfolio__wrapper"},o===y.SUCCESS&&a.a.createElement("div",{className:"pane pane__fluid pane__column portfolio__performance"},a.a.createElement("div",{className:"pane pane__fluid pane__row portfolio__performance-row"},a.a.createElement("div",{className:"pane pane__fluid portfolio__performance-row-item"},a.a.createElement(g.a,{compact:!0,invest:!0,universeName:v&&__(v.label),dailyReturnData:h&&h.dailyReturnData,yearlyPerformanceData:h&&h.yearlyPerformanceData}))))),a.a.createElement(m.default,null))}}]),t}(o.PureComponent),A=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var T=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.portfolios,n=e.service,o=n===f.b&&i.a.size(t)>0;return a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{service:n}),o?a.a.createElement(R,{portfolios:t}):a.a.createElement(b,{service:n}))}}]),t}(o.PureComponent);t.a=Object(l.connect)((function(e){return{portfolios:Object(s.P)(e)}}))(T)},2085:function(e,t,n){"use strict";var o=n(0),a=n.n(o),r=n(15),i=n.n(r),l=n(5),s=n.n(l),c=n(4),u=n(314),p=n(1002),f=n(138),m=n(126),d=n(408),_=n(27),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),h(t,[{key:"openSaxoPlatform",value:function(){Object(m.default)(this.props.saxoWebLink)}},{key:"startSaxoFlow",value:function(){s.a.trigger("flow:saxo_investment",{callback:this.openSaxoPlatform})}},{key:"onButtonClick",value:function(){this.props.loadAllAccountsInfo().then(this.startSaxoFlow)}},{key:"render",value:function(){return a.a.createElement("div",{className:"saxo-btn"},a.a.createElement(f.a,{btnType:"primary",className:"btn-action",onClick:this.onButtonClick},this.props.isSaxoAccountExists?__("invest.open.account"):__("invest.create.account")))}}]),t}(a.a.Component);t.a=Object(c.connect)((function(e){var t=Object(u.getFirstSaxoId)(e);return{isSaxoAccountExists:Object(_.isSaxoAccountExists)(e),accountId:t,saxoWebLink:Object(u.getSaxoWebLink)(e,t)}}),(function(e){return{createAccount:function(){return e(Object(p.createShareDealingAccount)())},loadAllAccountsInfo:function(){return e(Object(d.loadAllAccounts)())}}}))(v)},2124:function(e,t,n){},2172:function(e,t,n){"use strict";var o=n(3),a=n(647),r=n(648),i=n(149),l=n(310),s=n(230),c=n(5),u=n.n(c),p=n(2173),f=n(123),m=n(13),d=n(0),_=n.n(d),h=n(15),v=n.n(h),b=n(515),y=n(875),E=n(877),g=n(876),O=n(1),N=n.n(O),S=n(6),w=n.n(S),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var P=function(e){var t=e.input,n=t.value,o=t.onChange,i=t.onBlur,l=t.onFocus,s=t.name,c=e.className,u=e.step,p=e.meta.error;return _.a.createElement("div",{className:c},_.a.createElement(r.a,{name:s,type:"text",className:"form-control input-field",value:n,onChange:o,onFocus:l,onBlur:i,error:!!p,errorMessage:p}),_.a.createElement(a.a,{onPlusClick:function(){return o(n&&Number(n)-u>-1?Number(n)+u:u)},onMinusClick:function(){return o(n&&Number(n)-u>-1?Number(n)-u:0)}}))},k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={minAmount:0,statusOfAmountLoader:o.LOADING,maxAmount:0,defaultAmount:0,statusOfBuilding:o.EMPTY,shouldLoadAmount:!0},n.amountLoaderRef=_.a.createRef(),v()(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),C(t,[{key:"componentDidMount",value:function(){var e=this.props.defaultAmount();this._mounted=!0,this.inputStep=this.props.getStepIncrement(e),this.props.change("amount",e)}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"componentWillUpdate",value:function(e){this.props.change("portfolioName",e.portfolioName),this.props.change("backtestID",e.backtest&&e.backtest.backtest.backtestID)}},{key:"mounted",value:function(){return this._mounted}},{key:"onLoadMinAmountSuccess",value:function(e){this.props.defaultAmount()<e&&this.props.change("amount",e),this.setState({minAmount:e,statusOfAmountLoader:o.SUCCESS,shouldLoadAmount:!1})}},{key:"tryLoadAmountAgain",value:function(){this.amountLoaderRef.current.load()}},{key:"getCommonData",value:function(){return{minAmount:this.state.minAmount,freeMargin:w.a.getUserAccountMetricsModel().getBuyingPower()}}},{key:"onBuildPortfolioSuccess",value:function(e){return this.props.onSuccess(e),e}},{key:"onBuildPortfolioError",value:function(){this.setState({statusOfBuilding:o.ERROR})}},{key:"onErrorBuildingCancel",value:function(){this.setState({statusOfBuilding:o.EMPTY})}},{key:"onErrorBuildingClose",value:function(){this.setState({statusOfBuilding:o.EMPTY})}},{key:"trySubmitAgain",value:function(){this.props.dispatch(Object(b.e)(this.props.form))}},{key:"validateAmount",value:function(e){var t=this.state.minAmount,n=this.getCommonData().freeMargin;return e<t?__("portfolio.amount.popup.error.amount_less_minimum",t):e>n||n<t?_.a.createElement("span",{key:"insufficient-funds"},__("portfolio.amount.popup.error.insufficient_funds"),_.a.createElement("a",{className:"cursor--pointer",onClick:function(){return u.a.trigger("ui:deposit")}},__("portfolio.amount.popup.error.add_funds"))):void 0}},{key:"validateTakeProfit",value:function(e,t,n){n.syncErrors}},{key:"validateStopLoss",value:function(e,t,n){var o=n.syncErrors,a=this.getCommonData(),r=a.freeMargin,i=(a.minAmount,Number(t.amount)),l=o&&o.amount?r:i;if(e=Number(e),!N.a.isNaN(e))return e>l-1?__("portfolio.errors.stopLoss.too_high",l-1):void 0}},{key:"submit",value:function(e,t,n){var o=e.amount,a=e.takeProfit,r=e.stopLoss,i=e.portfolioName,l=this.props.backtest&&this.props.backtest.backtest;return n.clearSubmitErrors(),n.startSubmit(),t(Object(f.a)(i,l,null,null,o,a,r,{autoDeleteLocalPortfolio:!1})).then((function(e){return n.setSubmitSucceeded(),e})).then(N.a.callIf(this.onBuildPortfolioSuccess,this.mounted)).then((function(e){return t(Object(f.e)(e.strategyName)),e})).catch((function(){return n.setSubmitFailed(),Promise.reject()})).catch(N.a.callIf(this.onBuildPortfolioError,this.mounted)),!1}},{key:"render",value:function(){var e=this.props,t=e.backtest,n=e.portfolioName,a=e.invalid,r=e.onClose,c=e.handleSubmit,u=e.submitting,f=e.submitFailed,m=e.onErrorCancel,d=e.onErrorClose,h=e.normalizeNumber,v=w.a.getUserCurrency(),b=this.state,g=b.shouldLoadAmount,O=b.statusOfAmountLoader;return f?_.a.createElement(s.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.trySubmitAgain,onCancel:r,onClose:r}):O===o.ERROR?_.a.createElement(s.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.tryLoadAmountAgain,onCancel:r,onClose:r}):_.a.createElement(l.b,{popupStyle:"quant",onClose:r,title:__("portfolio.amount.popup.title")+" - "+n},_.a.createElement(l.a,null,u&&_.a.createElement(i.a,{position:"absolute",fit:!0}),f&&_.a.createElement(s.a,{title:__("errors.title"),message:__("server.request.generic.error.body",__("funded.client.contact_us.link")),textOK:__("actions.try_again"),onOK:this.buildPortfolio,onCancel:this.onErrorBuildingCancel,onClose:this.onErrorBuildingClose}),_.a.createElement(y.a,{autoComplete:"off",onSubmit:c(this.submit),className:"form form__amount pane pane__fluid pane__column pane_padded-small pane--relative"},g&&_.a.createElement(p.a,{ref:this.amountLoaderRef,backtestOverviewPositions:t&&t.overview.lastPortfolioData.positions,portfolioName:n,onSuccess:this.onLoadMinAmountSuccess,onErrorCancel:m,onErrorClose:d}),_.a.createElement("div",{key:"invest-portfolio-form",className:"pane pane__fluid pane__column"},_.a.createElement(E.a,{name:"portfolioName",component:"input",type:"hidden"}),_.a.createElement("div",{className:"form-row"},_.a.createElement("div",{className:"pane pane__fluid fs-13 bold"},__("portfolio.amount.popup.amount")+" - "+v),_.a.createElement(E.a,{name:"amount",className:"pane",component:P,step:this.inputStep,validate:this.validateAmount,normalize:h})),_.a.createElement("div",{className:"form-row"},_.a.createElement("div",{className:"pane pane__fluid fs-13 pane__row flex-valign-center"},_.a.createElement("div",{className:"pane"},_.a.createElement("i",{className:"icon icon-information","aria-label":__("portfolio.amount.popup.tooltip.take_profit")})),_.a.createElement("div",{className:"pane pane__column pane__fluid"},_.a.createElement("div",null,__("portfolio.amount.popup.take_profit")),_.a.createElement("div",null,v))),_.a.createElement(E.a,{name:"takeProfit",className:"pane",component:P,step:this.inputStep,validate:this.validateTakeProfit,normalize:h})),_.a.createElement("div",{className:"form-row"},_.a.createElement("div",{className:"pane pane__fluid fs-13 pane__row flex-valign-center"},_.a.createElement("div",{className:"pane"},_.a.createElement("i",{className:"icon icon-information","aria-label":__("portfolio.amount.popup.tooltip.stop_loss")})),_.a.createElement("div",{className:"pane pane__column pane__fluid"},_.a.createElement("div",null,__("portfolio.amount.popup.stop_loss")),_.a.createElement("div",null,v))),_.a.createElement(E.a,{name:"stopLoss",className:"pane",component:P,step:this.inputStep,validate:this.validateStopLoss,normalize:h})),_.a.createElement(E.a,{name:"portfolioName",component:"input",type:"hidden",value:n})),_.a.createElement("div",{className:"pane pane__fluid pane__column"},_.a.createElement("div",{className:"pane pane__xfluid"},_.a.createElement("button",{className:"btn btn-primary pane pane__fluid flex-align-center",type:"submit",disabled:a||O!==o.SUCCESS},__("indigo.order.form.send_order")))))))}}]),t}(_.a.PureComponent);k.defaultProps={onSuccess:N.a.noop,onClose:N.a.noop},t.a=Object(g.a)({form:m.A,initialValues:{amount:0,portfolioName:""},defaultAmount:function(){return 100*parseInt(.3*w.a.getUserAccountMetricsModel().getBuyingPower()/100)},getStepIncrement:function(e){var t=parseInt(e/10/m.t)*m.t;return t>100?t:100},normalizeNumber:function(e,t){return N.a.isEmpty(e)?e:/^\d*\.?\d{0,2}$/gi.test(e)?e:t}})(k)},2418:function(e,t,n){}}]);